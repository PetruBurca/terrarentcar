import{L as e,g as t,B as a,x as r,a as s,Z as n,n as i,K as l,r as o,b as c,o as d,i as m,I as p,s as u,$ as h,A as x,c as f,d as g,N as v,f as b,h as j,l as y,V as w,j as N,G as k,q as C,k as D,m as S,C as M}from"./index-BmtXtGE8.js";function B({value:t,onChange:r,onClose:n}){const{t:i}=e(),[l,o]=a.useState(Number(t.split(":")[0])),[c,d]=a.useState(Number(t.split(":")[1])),m=Array.from({length:24},(e,t)=>t),p=Array.from({length:60},(e,t)=>t),u=a.useRef(null),h=a.useRef(null),[x,f]=a.useState(120),g=a.useRef(!1),v=a.useRef(!1),[b,j]=a.useState(0),[y,w]=a.useState(0);a.useEffect(()=>{if(u.current){const e=40,t=u.current.offsetHeight;f(t/2-e/2)}},[]),a.useEffect(()=>{if(!g.current&&u.current){const e=40*l;u.current.scrollTop=e,j(e),g.current=!0}if(!v.current&&h.current){const e=40*c;h.current.scrollTop=e,w(e),v.current=!0}},[]);const N=(e,t)=>{if(e.current){const a=40;e.current.scrollTo({top:t*a,behavior:"smooth"})}},k=e=>[...e,...e,...e],C=k(m),D=k(p),S=(e,t)=>{const a=Math.round(e/40),r=Math.abs(t-a);return 0===r?{color:"#ffffff",fontWeight:600,fontSize:"1.1em",transform:"scale(1.05)",opacity:1}:1===r?{color:"#d1d5db",fontWeight:500,fontSize:"1em",transform:"scale(1)",opacity:.8}:2===r?{color:"#9ca3af",fontWeight:400,fontSize:"0.95em",transform:"scale(0.95)",opacity:.4}:{color:"#6b7280",fontWeight:300,fontSize:"0.9em",transform:"scale(0.9)",opacity:.2}};return s.jsxs(s.Fragment,{children:[s.jsx("style",{children:"\n        .time-picker-scrollbar {\n          scrollbar-width: none;\n          -ms-overflow-style: none;\n          overflow-x: hidden;\n        }\n        .time-picker-scrollbar::-webkit-scrollbar {\n          display: none;\n        }\n        .time-picker-item {\n          transition: all 0.3s ease-out;\n          position: relative;\n          cursor: pointer;\n        }\n        .time-picker-item:hover {\n          color: #ffffff !important;\n          opacity: 1 !important;\n        }\n        .center-line {\n          position: absolute;\n          left: 0;\n          right: 0;\n          top: 50%;\n          transform: translateY(-50%);\n          height: 40px;\n          background: rgba(185, 0, 3, 0.15);\n          border: 1px solid rgba(185, 0, 3, 0.3);\n          border-radius: 8px;\n          pointer-events: none;\n          z-index: 5;\n        }\n      "}),s.jsx("div",{className:"relative w-full max-w-xs mx-auto flex flex-col items-center bg-[#232325] rounded-2xl p-4 shadow-xl z-10",children:s.jsxs("div",{className:"flex gap-4 relative h-48 w-full justify-center overflow-hidden",children:[s.jsx("div",{className:"center-line"}),s.jsxs("div",{ref:u,className:"flex-1 h-full overflow-y-auto overflow-x-hidden snap-y snap-mandatory time-picker-scrollbar relative",style:{minWidth:60,maxWidth:60},onScroll:()=>{if(u.current){const e=u.current.scrollTop;j(e);const t=Math.round(e/40)%24;if(t!==l){o(t);const e=`${t.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}`;r(e)}}},children:[s.jsx("div",{style:{height:x}}),C.map((e,t)=>{const a=S(b,t);return s.jsx("div",{className:"h-10 flex items-center justify-center text-lg snap-center time-picker-item",style:a,onClick:()=>{return a=t,o(e),void N(u,a);var a},children:e.toString().padStart(2,"0")},`hour-${t}`)}),s.jsx("div",{style:{height:x}})]}),s.jsxs("div",{ref:h,className:"flex-1 h-full overflow-y-auto overflow-x-hidden snap-y snap-mandatory time-picker-scrollbar relative",style:{minWidth:60,maxWidth:60},onScroll:()=>{if(h.current){const e=h.current.scrollTop;w(e);const t=Math.round(e/40)%60;if(t!==c){d(t);const e=`${l.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`;r(e)}}},children:[s.jsx("div",{style:{height:x}}),D.map((e,t)=>{const a=S(y,t);return s.jsx("div",{className:"h-10 flex items-center justify-center text-lg snap-center time-picker-item",style:a,onClick:()=>{return a=t,d(e),void N(h,a);var a},children:e.toString().padStart(2,"0")},`minute-${t}`)}),s.jsx("div",{style:{height:x}})]})]})})]})}const z=({items:e,title:t,colorCenter:r,colorSide:n,valueSuffix:i=""})=>{const[l,o]=a.useState(5);a.useEffect(()=>{const e=()=>{o(window.innerWidth<=640?3:5)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const[c,d]=a.useState(0),[m,p]=a.useState(0),[u,h]=a.useState(!1),[x,f]=a.useState({x:0,y:0}),[g,v]=a.useState({x:0,y:0}),[b,j]=a.useState(0),[y,w]=a.useState(null),[N,k]=a.useState(!1),C=a.useRef(null);a.useRef();const D=120;e.length;const S=a.useCallback(e=>e,[]),M=a.useCallback(()=>(Math.round(c/D)%e.length+e.length)%e.length,[c,D,e.length]),B=a.useCallback(e=>{const t=e.touches[0];h(!0),f({x:t.clientX,y:t.clientY}),v({x:t.clientX,y:t.clientY}),p(0),j(Date.now()),w(null),k(!1)},[]),z=a.useCallback(e=>{if(!u)return;const t=e.touches[0],a=t.clientX-x.x,r=t.clientY-x.y;null===y&&(Math.abs(a)>5||Math.abs(r)>5)&&(Math.abs(a)>Math.abs(r)?w("horizontal"):w("vertical")),"horizontal"===y&&(e.preventDefault(),e.stopPropagation(),v({x:t.clientX,y:t.clientY}),p(-a))},[u,x,y,5,D,c]),T=a.useCallback(e=>{if(u){if(e.preventDefault(),e.stopPropagation(),h(!1),p(0),"horizontal"===y){const e=c+m,t=Math.round(e/D)*D;k(!0),d(t),setTimeout(()=>k(!1),250)}else{const e=Math.round(c/D)*D;k(!0),d(e),setTimeout(()=>k(!1),250)}w(null)}},[u,y,g,x,10,S,c,D,e.length]),A=a.useCallback(e=>{e.preventDefault(),h(!0),f({x:e.clientX,y:e.clientY}),v({x:e.clientX,y:e.clientY}),p(0),j(Date.now()),w("horizontal"),k(!1)},[]),$=a.useCallback(e=>{if(!u||"horizontal"!==y)return;const t=e.clientX-x.x;v({x:e.clientX,y:e.clientY}),p(-t)},[u,y,x,D,c]),I=a.useCallback(()=>{if(u){if(h(!1),p(0),"horizontal"===y){const e=c+m,t=Math.round(e/D)*D;k(!0),d(t),setTimeout(()=>k(!1),250)}w(null)}},[u,y,g,x,10,S,c,D,e.length]),R=a.useCallback(()=>{u&&I()},[u,I]),L=a.useCallback(()=>{N||(k(!0),d(e=>e-D),setTimeout(()=>k(!1),250))},[D,N]),P=a.useCallback(()=>{N||(k(!0),d(e=>e+D),setTimeout(()=>k(!1),250))},[D,N]),F=a.useMemo(()=>{const t=[],a=Math.round(c/D),r=c+m,n=l+4;for(let l=-n;l<=n;l++){const o=a+l,m=(o%e.length+e.length)%e.length,p=e[m],h=o*D-r;if(Math.abs(h)>D*(n+1))continue;const x=Math.abs(h)/144,f=Math.max(0,Math.min(1,1-x)),g=.85+.3*f,v=.5+.5*f,b=15+6*f,j=f>.6,y=f>.3&&!j,w=j?.9*f:y?.8:.7,C=j?`rgba(185, 0, 3, ${w})`:`rgba(63, 63, 70, ${w})`,S=j?"#fff":y?"#838383":"#fff";t.push(s.jsxs("div",{className:`absolute flex flex-col items-center justify-center rounded-lg px-2 py-2 cursor-pointer select-none will-change-transform ${j?"hover:scale-105 active:scale-95":y?"hover:scale-110 active:scale-100 hover:shadow-[#B90003]/30 hover:ring-1 hover:ring-[#B90003]/50":"hover:scale-105 active:scale-95"} ${u?"":N?"transition-all duration-250 ease-out":"transition-all duration-150 ease-out hover:shadow-lg"}`,title:y?`Выбрать ${p.label}: ${p.value}${i}`:"",style:{left:`calc(50% + ${h}px)`,transform:`translateX(-50%) scale(${g})`,transformOrigin:"center center",opacity:v,backgroundColor:C,color:S,width:"110px",height:"80px",zIndex:Math.round(10*f)+10,boxShadow:j?"0 4px 12px rgba(185, 0, 3, 0.25)":"none",border:"none",position:"absolute",top:"50%",marginTop:"-40px",pointerEvents:"auto",backfaceVisibility:"hidden",perspective:"1000px",cursor:j?"default":"pointer"},onClick:e=>{if(e.preventDefault(),e.stopPropagation(),N)return;k(!0);const t=Math.round(c/D);o!==t&&d(o*D),setTimeout(()=>k(!1),250)},children:[s.jsx("div",{className:"text-xs mb-1 opacity-70",children:p.label}),s.jsxs("div",{className:"font-bold text-center",style:{fontSize:`${b}px`,fontWeight:j?700:500},children:[p.value,i?` ${i}`:""]})]},`${m}-${o}`))}return t},[c,m,D,e,l,u,N,i]);return s.jsxs("div",{className:"w-full max-w-full md:max-w-lg mx-auto relative",children:[s.jsx("h3",{className:"text-xl font-bold text-center mb-4 text-white",children:t}),s.jsx("button",{onClick:L,disabled:N,className:"absolute left-0 z-20 p-2 bg-black/40 rounded-full text-[#B90003] hover:bg-[#A00002] hover:scale-110 active:scale-95 transition-all duration-200 disabled:opacity-50 shadow-lg hover:shadow-[#B90003]/30",style:{top:"50%",transform:"translateY(-50%)",marginTop:"12px"},children:"←"}),s.jsx("button",{onClick:P,disabled:N,className:"absolute right-0 z-20 p-2 bg-black/40 rounded-full text-[#B90003] hover:bg-[#A00002] hover:scale-110 active:scale-95 transition-all duration-200 disabled:opacity-50 shadow-lg hover:shadow-[#B90003]/30",style:{top:"50%",transform:"translateY(-50%)",marginTop:"12px"},children:"→"}),s.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-28 h-16 pointer-events-none z-5",style:{background:"radial-gradient(ellipse, rgba(250, 204, 21, 0.02) 40%, transparent 70%)"}}),s.jsx("div",{ref:C,className:"relative h-24 overflow-hidden cursor-grab active:cursor-grabbing",onTouchStart:B,onTouchMove:z,onTouchEnd:T,onMouseDown:A,onMouseMove:$,onMouseUp:I,onMouseLeave:R,style:{userSelect:"none",WebkitUserSelect:"none",touchAction:"pan-x",WebkitTouchCallout:"none",overscrollBehavior:"contain",overscrollBehaviorX:"none",overscrollBehaviorY:"auto",pointerEvents:"auto"},children:F}),s.jsx("div",{className:"flex justify-center gap-1 mt-3",children:e.map((t,a)=>s.jsx("button",{onClick:()=>{if(N)return;k(!0);const t=Math.round(c/D),r=(t%e.length+e.length)%e.length;let s=t;const n=(a-r+e.length)%e.length,i=(r-a+e.length)%e.length;s=n<=i?t+n:t-i,d(s*D),setTimeout(()=>k(!1),250)},disabled:N,className:"h-2 w-2 rounded-full transition-all duration-300 cursor-pointer hover:scale-125 active:scale-110 disabled:cursor-default "+(M()===a?"bg-[#B90003] scale-125 shadow-md shadow-[#B90003]/50 ring-2 ring-[#B90003]/30":"bg-gray-600 scale-100 opacity-70 hover:opacity-100 hover:bg-gray-500")},a))})]})},T=({car:t,formData:a,setFormData:r,wizardData:n,setWizardData:i,currentStep:l,stepIndicator:o,disabledDays:c,goNext:d,goBack:m,i18n:u})=>{const{t:w}=e(),[N,k]=h.useState(0),[C,D]=h.useState(!1),S=Array.isArray(t.images)?t.images:[],M=u.language;"en"===M?t.description_en||t.description_ru||t.description_ro:"ro"===M?t.description_ro||t.description_ru||t.description_en:t.description_ru||t.description_ro||t.description_en;const T=e=>e?`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}`:"",A=n.pickupDate||a.pickupDate,$=n.returnDate||a.returnDate,I=(()=>{const e=A&&""!==A.trim(),t=$&&""!==$.trim();if(!e&&!t)return;const a=e&&c.some(e=>e.getFullYear()===new Date(A).getFullYear()&&e.getMonth()===new Date(A).getMonth()&&e.getDate()===new Date(A).getDate()),r=t&&c.some(e=>e.getFullYear()===new Date($).getFullYear()&&e.getMonth()===new Date($).getMonth()&&e.getDate()===new Date($).getDate());return a||r?void 0:{from:e?new Date(A):void 0,to:t?new Date($):void 0}})(),R=A?new Date(A):$?new Date($):new Date;return s.jsxs("div",{className:"flex flex-col items-center gap-1 pb-4",children:[s.jsxs("div",{className:"w-full flex flex-col items-center",children:[s.jsx("h2",{className:"text-2xl font-bold text-center mb-2 text-white",children:t.name}),s.jsxs("div",{className:"relative w-full max-w-md mx-auto",children:[s.jsx("img",{src:t.images[N]||x,alt:t.name,className:"w-full h-80 object-cover rounded-lg border border-gray-800",style:{objectPosition:"center 60%"}}),t.images&&t.images.length>1&&s.jsxs(s.Fragment,{children:[s.jsx("button",{type:"button",onClick:()=>k(e=>e>0?e-1:S.length-1),className:"absolute left-3 top-1/2 -translate-y-1/2 bg-black/80 backdrop-blur-sm text-white rounded-full p-3 hover:bg-[#B90003] hover:text-white transition-all duration-300 hover:scale-110 shadow-lg border border-white/20","aria-label":"Prev",children:s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})})}),s.jsx("button",{type:"button",onClick:()=>k(e=>e<S.length-1?e+1:0),className:"absolute right-3 top-1/2 -translate-y-1/2 bg-black/80 backdrop-blur-sm text-white rounded-full p-3 hover:bg-[#B90003] hover:text-white transition-all duration-300 hover:scale-110 shadow-lg border border-white/20","aria-label":"Next",children:s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})})})]})]}),t.images&&t.images.length>1&&s.jsx("div",{className:"flex justify-center gap-2 mt-2",children:t.images.map((e,t)=>s.jsx("img",{src:e,alt:`thumb-${t}`,className:"w-14 h-14 object-cover rounded cursor-pointer border-2 "+(N===t?"border-[#B90003]":"border-gray-700"),onClick:()=>k(t)},t))})]}),s.jsx(z,{items:[{label:w("reservation.pricePerDay"),value:t.pricePerDay},{label:w("reservation.price2to10"),value:t.price2to10},{label:w("reservation.price11to20"),value:t.price11to20},{label:w("reservation.price21to29"),value:t.price21to29},{label:w("reservation.price30plus"),value:t.price30plus}],title:w("reservation.priceTitle"),colorCenter:"bg-[#B90003] text-white",colorSide:"bg-gray-800 text-white opacity-60",valueSuffix:"€"}),s.jsx(z,{items:[{label:w("reservation.drive"),value:f("drive",t.drive,w)},{label:w("reservation.fuel"),value:f("fuel",t.fuel,w)},{label:w("reservation.rating"),value:t.rating},{label:w("reservation.passengers"),value:t.passengers},{label:w("reservation.transmission"),value:f("transmission",t.transmission,w)},{label:w("reservation.year"),value:t.year},{label:w("reservation.engine"),value:t.engine}],title:w("reservation.featuresTitle"),colorCenter:"bg-[#B90003] text-white",colorSide:"bg-gray-800 text-white opacity-60"}),s.jsxs("div",{className:"w-full max-w-md mx-auto",children:[s.jsx("h3",{className:"text-xl font-bold text-center mb-2",children:w("reservation.calendarTitle")}),s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx(g,{mode:"range",selected:I,defaultMonth:R,onSelect:e=>{const t=e=>!!e&&c.some(t=>t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate());if(t(null==e?void 0:e.from)||t(null==e?void 0:e.to))return p({title:w("reservation.disabledRangeTitle","Нельзя выбрать эти даты"),description:w("reservation.disabledRangeDesc","В выбранном диапазоне есть занятые дни. Пожалуйста, выберите другой период."),variant:"destructive"}),r(e=>({...e,pickupDate:"",returnDate:""})),void i(e=>({...e,pickupDate:"",returnDate:""}));if((null==e?void 0:e.from)&&(null==e?void 0:e.to))if(e.to<e.from){const t=T(e.to),a=T(e.from);r(e=>({...e,pickupDate:t,returnDate:a})),i(e=>({...e,pickupDate:t,returnDate:a}))}else{const t=T(e.from),a=T(e.to);r(e=>({...e,pickupDate:t,returnDate:a})),i(e=>({...e,pickupDate:t,returnDate:a}))}else if(null==e?void 0:e.from){const t=T(e.from);r(e=>({...e,pickupDate:t,returnDate:""})),i(e=>({...e,pickupDate:t,returnDate:""}))}else r(e=>({...e,pickupDate:"",returnDate:""})),i(e=>({...e,pickupDate:"",returnDate:""}))},disabled:c,fromDate:new Date,className:"rounded-xl bg-zinc-900/80 border border-zinc-700 shadow-lg p-2 text-white",classNames:{day_selected:"bg-[#B90003] text-white hover:bg-[#A00002]",day_range_middle:"bg-[#B90003]/30 text-white",day_range_end:"bg-[#A00002] text-white",day_today:"border-[#B90003] border-2",nav_button:"hover:bg-[#B90003]/20"},modifiersClassNames:{disabled:"calendar-day-disabled-strike"}},`${A}-${$}`),s.jsxs("div",{className:"mt-4 w-full",children:[s.jsx("h3",{className:"text-xl font-bold text-center mb-2",children:w("reservation.pickupTime")}),s.jsx(B,{value:a.pickupTime,onChange:e=>{r(t=>({...t,pickupTime:e})),i(t=>({...t,pickupTime:e}))},onClose:()=>{}})]})]})]}),s.jsxs("div",{className:"w-full max-w-md sm:max-w-full mx-auto mb-2",children:[s.jsx("h3",{className:"text-xl font-bold text-center mb-2",children:w("reservation.extraServices")}),s.jsxs("div",{className:"flex items-center justify-between bg-gray-700 rounded-lg px-4 py-3 mb-2",children:[s.jsx("span",{children:w("reservation.unlimitedMileage")}),s.jsx(v,{checked:!!n.unlimitedMileage,onCheckedChange:e=>i(t=>({...t,unlimitedMileage:!!e}))})]}),n.unlimitedMileage&&s.jsx("div",{className:"bg-[#B90003]/10 border border-[#B90003]/20 rounded-lg px-4 py-2 mb-2",children:s.jsx("p",{className:"text-[#B90003] text-sm text-center",children:w("reservation.unlimitedMileageDesc")})})]}),s.jsxs("div",{className:"w-full max-w-md sm:max-w-full mx-auto mb-2",children:[s.jsx("h3",{className:"text-xl font-bold text-center mb-2",children:w("reservation.pickupType")}),s.jsxs(b,{value:n.pickupType||"office",onValueChange:e=>i(t=>({...t,pickupType:e})),className:"flex flex-col gap-2 bg-gray-700 rounded-lg px-4 py-3 mb-2",children:[s.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[s.jsx("span",{children:w("reservation.pickupOffice")}),s.jsx(v,{checked:"office"===n.pickupType,onCheckedChange:e=>i(t=>({...t,pickupType:e?"office":"airport"}))})]}),s.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[s.jsx("span",{children:w("reservation.pickupAirport")}),s.jsx(v,{checked:"airport"===n.pickupType,onCheckedChange:e=>i(t=>({...t,pickupType:e?"airport":"office"}))})]}),s.jsx("div",{className:"border-t border-[#B90003] my-2"}),s.jsxs("label",{className:"flex flex-col gap-1 cursor-pointer",children:[s.jsx("span",{className:"text-center",children:w("reservation.pickupAddress")}),s.jsx(j,{type:"text",className:"bg-gray-800 rounded px-2 py-1 text-white",placeholder:w("reservation.enterAddress"),value:"address"===n.pickupType&&n.pickupAddress||"",onFocus:()=>i(e=>({...e,pickupType:"address"})),onChange:e=>i(t=>({...t,pickupType:"address",pickupAddress:e.target.value}))})]})]})]}),s.jsx("div",{className:"w-full flex justify-center mb-1",children:s.jsxs("span",{className:"text-sm font-semibold text-[#B90003] bg-black/30 rounded px-3 py-1",children:[w("reservation.step")," ",o]})}),s.jsx(y,{className:"w-full bg-[#B90003] hover:bg-[#A00002] text-white text-lg font-bold py-3 rounded-xl",onClick:d,disabled:!a.pickupDate||!a.returnDate,children:w("reservation.next")}),s.jsx(y,{className:"w-full mt-2 bg-black text-[#B90003] border-[#B90003] border-2 text-lg font-bold py-3 rounded-xl",variant:"outline",onClick:m,children:w("reservation.back")})]})};function A(e,t,a){const r="string"==typeof e?new Date(e):e,s=function(e){switch(e){case"en":return"en-US";case"ro":return"ro-RO";default:return"ru-RU"}}(t);return r.toLocaleDateString(s,{day:"2-digit",month:"long",...a})}const $=({car:t,formData:a,wizardData:r,setWizardData:n,currentStep:i,stepIndicator:l,calculateDays:o,totalPrice:c,discount:d,finalRentalCost:m,goNext:p,goBack:u,i18n:h})=>{const{t:x}=e();return s.jsxs("div",{className:"w-full max-w-md sm:max-w-full mx-auto pb-4",children:[s.jsx("div",{className:"text-2xl font-bold mb-4 text-white text-center",children:x("reservation.confirmTitle")}),s.jsxs("div",{className:"mb-3",children:[s.jsx("div",{className:"text-lg font-bold text-[#B90003] mb-1",children:x("reservation.periodTitle")}),s.jsx("div",{className:"bg-zinc-900 rounded-xl px-4 py-3 flex flex-col gap-1 border border-[#B90003]",children:a.pickupDate&&a.returnDate?s.jsx("div",{className:"text-white text-base font-semibold text-center",children:(()=>{const e=(t=a.pickupDate,r=a.returnDate,{start:A(t,n=h.language,i),end:A(r,n,i)});var t,r,n,i;return s.jsxs(s.Fragment,{children:[e.start,s.jsx("span",{className:"mx-2 text-[#B90003] font-bold",children:"—"}),e.end,s.jsx("span",{className:"ml-2 text-[#fffffff2] font-bold",children:a.pickupTime})]})})()}):s.jsx("span",{className:"text-zinc-400",children:x("reservation.periodNotSelected")})})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("div",{className:"text-lg font-bold text-[#B90003] mb-1",children:x("reservation.geoTitle")}),s.jsx("div",{className:"bg-zinc-900 rounded-xl px-4 py-3 text-base text-white border border-[#B90003]",children:"office"!==r.pickupType&&r.pickupType?"airport"===r.pickupType?x("reservation.airportAddress"):r.pickupAddress||x("reservation.enterAddress"):x("reservation.officeAddress")})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("div",{className:"text-lg font-bold mb-2 text-[#B90003]",children:x("reservation.rulesTitle")}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 bg-zinc-900 rounded-xl p-4 border border-[#B90003]",children:[s.jsxs("div",{className:"flex items-center gap-3 text-white",children:[s.jsx("img",{src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20width='800'%20height='800'%20fill='%23fff'%20viewBox='0%200%20313.725%20313.725'%3e%3cpath%20d='M235.469%2068.574c-4.679%205.328-6.204%2013.161-2.186%2019.269%203.079%204.679%208.408%207.246%2010.905%2012.398%203.438%207.099-.361%2016.396-8.444%2017.923-1.551.294-.145-1.525.14-2.021%201-1.741%201.881-3.605%202.271-5.587.76-3.855-1.115-8.062-3.232-11.215-.819-1.221-1.753-2.328-2.674-3.473-2.601-3.256-4.655-7.004-5.12-11.202-.447-4.053.669-8.114%202.933-11.486a21.3%2021.3%200%200%201%203.327-3.866c.47-.43.955-.848%201.47-1.223.355-.258%201.005.055.61.483M208.689%20113.292c1.737%203.672%203.355%207.585%203.49%2011.699.139%204.244-1.389%208.376-3.278%2012.109-.835%201.649-1.764%203.244-2.729%204.82-.538.879-.402%201.746.84%201.564%203.266-.475%206.501-2.09%209.134-4.025a23.54%2023.54%200%200%200%209.557-20.242c-.447-8.277-5.15-14.85-10.929-20.399-2.333-2.241-4.917-4.198-7.19-6.507-5.913-6.001-9.999-13.627-9.448-22.244.462-7.244%203.879-14.682%208.623-20.135.418-.467.045-1.237-.589-1.186-.277.022-.522.248-.731.405a36%2036%200%200%200-2.602%202.174%2040.2%2040.2%200%200%200-5.223%205.805c-3.303%204.471-5.636%209.686-6.455%2015.205-1.655%2011.151%203.277%2021.555%2010.257%2029.941%202.854%203.431%205.348%206.95%207.273%2011.016'/%3e%3cpath%20d='M156.862%200C70.368%200%200%2070.368%200%20156.862s70.368%20156.862%20156.862%20156.862%20156.862-70.368%20156.862-156.862S243.356%200%20156.862%200M290%20156.862c0%2032.443-11.671%2062.209-31.027%2085.333l-51.03-51.028h10.869a7.087%207.087%200%200%200%207.086-7.086v-23.615a7.087%207.087%200%200%200-7.086-7.086H196.19v26.034l-10.271-10.27V153.38h-15.764L71.526%2054.755c23.124-19.358%2052.891-31.03%2085.336-31.03C230.274%2023.725%20290%2083.45%20290%20156.862m-266.275%200c0-32.443%2011.671-62.209%2031.026-85.332l81.851%2081.85h-64.74a7.087%207.087%200%200%200-7.086%207.086v23.615a7.087%207.087%200%200%200%207.086%207.086h102.529l67.806%2067.804C219.073%20278.328%20189.308%20290%20156.862%20290%2083.45%20290%2023.725%20230.274%2023.725%20156.862'/%3e%3c/svg%3e",alt:"Не курить",className:"w-7 h-7"}),s.jsx("span",{children:x("reservation.ruleNoSmoke")})]}),s.jsxs("div",{className:"flex items-center gap-3 text-white",children:[s.jsx("img",{src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20width='800'%20height='800'%20fill='%23fff'%20stroke='%23fff'%20stroke-width='14.229'%20viewBox='-14.72%20-14.72%20520.11%20520.11'%3e%3cpath%20d='M245.333%200C110.059%200%200%20110.059%200%20245.333s110.059%20245.333%20245.333%20245.333%20245.333-110.059%20245.333-245.333S380.608%200%20245.333%200zm0%20469.333c-123.52%200-224-100.48-224-224%200-57.92%2022.293-110.613%2058.496-150.421L176.917%20192h-59.584c-5.888%200-10.667%204.779-10.667%2010.667s4.779%2010.667%2010.667%2010.667h32V352c0%205.888%204.779%2010.667%2010.667%2010.667s10.667-4.779%2010.667-10.667v-61.12c14.763%203.264%2039.488%207.787%2064%207.787%2021.184%200%2034.219-2.859%2042.091-6.827l21.909%2021.909V352c0%205.888%204.779%2010.667%2010.667%2010.667S320%20357.888%20320%20352v-16.917l75.755%2075.755c-39.808%2036.202-92.502%2058.495-150.422%2058.495zm165.504-73.578-93.952-93.952L94.933%2079.851c39.808-36.203%2092.501-58.496%20150.421-58.496%20123.499-.021%20223.979%20100.459%20223.979%20223.979%200%2057.919-22.293%20110.613-58.496%20150.421z'/%3e%3cpath%20d='m389.483%20172.181-48.149-28.885v-25.963c0-4.949-3.413-9.259-8.213-10.389-4.779-1.152-9.771%201.173-11.989%205.611l-30.869%2061.76c-5.227%2010.453-15.851%2017.173-27.733%2017.515a10.7%2010.7%200%200%200-9.6%206.72%2010.66%2010.66%200%200%200%202.368%2011.477l47.979%2048a10.67%2010.67%200%200%200%207.552%203.115c1.003%200%202.005-.128%202.987-.427a10.66%2010.66%200%200%200%207.424-7.957c1.173-5.333%202.816-9.28%205.163-12.416l18.859-25.131%2024.704%208.235c5.632%201.899%2011.627-1.152%2013.483-6.741l10.667-32a10.68%2010.68%200%200%200-4.633-12.524z'/%3e%3c/svg%3e",alt:"No pets",className:"w-7 h-7"}),s.jsx("span",{children:x("reservation.ruleNoPets")})]}),s.jsxs("div",{className:"flex items-center gap-3 text-white",children:[s.jsx("img",{src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20width='800'%20height='800'%20fill='%23fff'%20viewBox='0%200%20179.006%20179.006'%3e%3cpath%20d='M69.246%2097.982a5.9%205.9%200%200%201-5.901-5.907c0-3.27%205.901-13.61%205.901-13.61s5.901%2010.347%205.901%2013.61a5.9%205.9%200%200%201-5.901%205.907M64.8%2073.894h-6.766v36.076H46.297v5.549h6.826v5.102H0v-5.102h6.832V58.392h39.471v46.47h6.623V71.346l.03-2.56H67.3l3.962%205.09-4.028%203.139zm-27.25-6.659H15.574v16.403H37.55zm72.783%2011.617c.668.871%201.283%201.82%201.784%202.846a16.2%2016.2%200%200%201%201.122%203.168l36.464-21.32zm-17.089.114c-5.812%203.031-8.073%2010.209-5.036%2016.027s10.215%208.079%2016.021%205.048c5.824-3.037%208.085-10.203%205.054-16.033-3.031-5.818-10.209-8.074-16.039-5.042m11.618-63.028h-9.314v24.464h9.314zm-9.309%20147.131h9.314v-24.47h-9.314zm58.989-78.226v9.32h24.464v-9.32zm-23.611-37.436%203.294%203.294%2017.298-17.298-3.3-3.294zm0%2084.192%2017.298%2017.298%203.294-3.294-17.292-17.298zm-56.888%2020.747H86v-4.212H74.043v-5.197h12.894v-4.332H68.929v24.464h18.575v-4.35H74.043zm.567-111.944V30.055h10.716v-4.206H74.61v-5.567h12.304v-4.344H69.508v24.464h5.102'%20style='fill:%23fff'/%3e%3c/svg%3e",alt:"Fuel return",className:"w-7 h-7"}),s.jsx("span",{children:x("reservation.ruleFuel")})]}),s.jsxs("div",{className:"flex items-center gap-3 text-white",children:[s.jsx("img",{src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='800'%20height='800'%20fill='%23fff'%20stroke='%23fff'%20stroke-width='.001'%20viewBox='0%200%2050%2050'%3e%3cpath%20d='M37%2025.955a11.022%2011.022%200%201%200%2011%2011.023%2011.024%2011.024%200%200%200-11-11.023Zm4.707%2014.322a1%201%200%200%201-1.414%201.417L37%2038.394l-3.293%203.3a1.016%201.016%200%200%201-1.414%200%201.003%201.003%200%200%201%200-1.417l3.293-3.3-3.293-3.299a1%201%200%200%201%201.414-1.417l3.293%203.3%203.293-3.3a1%201%200%200%201%201.414%201.417l-3.293%203.3ZM42%2015.935a4%204%200%200%201%20.05-.49%2020%2020%200%200%200%203.27-.904%201.98%201.98%200%200%201%201.822.233A2%202%200%200%201%2048%2016.42v2.967a3.95%203.95%200%200%201-2%20.557%204.01%204.01%200%200%201-4-4.008Zm-38.012-2.49c.54-.2%201.08-.37%201.62-.523A3.993%203.993%200%200%201%203%2019.943a4%204%200%200%201-1-.142v-3.52a3.04%203.04%200%200%201%201.988-2.836ZM8%2043.992a4%204%200%200%201-.05.498%2020%2020%200%200%200-3.268.896%201.99%201.99%200%200%201-1.826-.235A2%202%200%200%201%202%2043.508v-2.967a3.95%203.95%200%200%201%202-.557%204.01%204.01%200%200%201%204%204.008Zm17-22.045a8.014%208.014%200%200%200-.947%2015.971c-.023-.312-.053-.622-.053-.94a13.03%2013.03%200%200%201%207.445-11.76A8.03%208.03%200%200%200%2025%2021.948Zm0%204.008a4.01%204.01%200%200%200-4%204.008%201%201%200%201%201-2%200%206.013%206.013%200%200%201%206-6.012%201.002%201.002%200%200%201%200%202.004ZM8%205.345v-1.23A2.02%202.02%200%200%201%209.806%202.11c5.19-.482%2010.388.691%2015.413%201.824C30.028%205.02%2035%206.14%2039.815%205.736A2.016%202.016%200%200%201%2042%207.726v.67c-9.82%201.915-19.636-3.517-29.698-3.383A27.5%2027.5%200%200%200%208%205.345Zm-3%205.528V9.624a2%202%200%200%201%201.526-1.955c6.309-1.515%2012.604-.097%2018.693%201.276%205.995%201.352%2011.658%202.629%2017.38%201.377%201.322-.323%203.662%201.815%202.401%202.237a20.7%2020.7%200%200%201-3.904%201.061C30.004%2015.032%2018.82%208.268%207.498%2010.43Zm41%2011.074a6.013%206.013%200%200%201-6-6.012c0-.067.008-.133.01-.2-4.84.457-9.712-.634-14.79-1.78-5.674-1.278-11.505-2.59-17.374-1.55A5.98%205.98%200%200%201%209%2015.934a6.013%206.013%200%200%201-6%206.012%206%206%200%200%201-1-.09V38.33a6%206%200%200%201%202-.35%206.013%206.013%200%200%201%206%206.012c0%20.072-.008.141-.01.212%204.82-.44%209.673.667%2014.73%201.828%201.276.292%202.566.586%203.865.856a13.06%2013.06%200%200%201-4.238-6.937%2010.014%2010.014%200%201%201%209.016-15.471A12.914%2012.914%200%200%201%2048%2030.067v-8.47a6%206%200%200%201-2%20.35Zm-35%209.019H9a1.002%201.002%200%200%201%200-2.005h2a1.002%201.002%200%200%201%200%202.005Z'/%3e%3c/svg%3e",alt:"No deposit",className:"w-7 h-7"}),s.jsx("span",{children:x("reservation.ruleNoDeposit")})]}),s.jsxs("div",{className:"flex items-center gap-3 text-white",children:[s.jsx("img",{src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20width='800'%20height='800'%20fill='%23fff'%20viewBox='0%200%20100%20100'%3e%3cpath%20d='M50%2019C25.1%2019%204.9%2038.5%204%2063.4%204%2064.8%205.2%2066%206.6%2066c1.2%200%202.2-.8%202.6-2%204-14.2%2017-24%2031.8-24%206.9%200%2013.5%202.1%2019.1%206.1l-17.6%2017c-.5%200-1-.1-1.5-.1-5%200-9%204-9%209s4%209%209%209%209-4%209-9c0-.5-.1-1-.1-1.5l14-21.3c4.2%204.1%207.3%209.2%208.9%2014.8.3%201.2%201.4%202%202.6%202h18c.7%200%201.4-.3%201.9-.8s.8-1.2.7-1.9C95%2038.5%2074.8%2019%2050%2019m17.9%205.8L55.4%2041.1c-4.2-1.9-8.7-3-13.4-3.1V21.7c2.6-.5%205.2-.7%208-.7%206.4%200%2012.4%201.4%2017.9%203.8m-40%2015.8-4.8-10.5c4.9-3.8%2010.6-6.5%2016.9-7.9V38c-4.2.1-8.3%201-12.1%202.6M7.3%2063.5c-.1.3-.4.5-.7.5s-.6-.3-.6-.6c.2-6.1%201.7-11.9%204.1-17.1l4.9%203.3c-3.5%203.9-6.2%208.6-7.7%2013.9m9.1-15.4L11%2044.5c2.6-5%206.2-9.5%2010.5-13.1l4.5%2010c-3.5%201.6-6.8%203.9-9.6%206.7M41%2079c-3.9%200-7-3.1-7-7s3.1-7%207-7%207%203.1%207%207-3.1%207-7%207m3.7-15.2%2019.6-18.9-1.4%202.1c-.1.1-.1.2-.1.2L49.1%2068.1c-.9-1.9-2.5-3.5-4.4-4.3m20.2-16.3%205.9-9c.3-.4.2-1-.2-1.3s-1-.3-1.3%200l-7.7%207.4c-1.4-1-2.8-1.9-4.3-2.7l12.5-16.3c7.1%203.6%2013.1%209%2017.4%2015.6L67.7%2050l-.1.1c-.9-.9-1.8-1.7-2.7-2.6m28.9%2016.3c-.1.1-.3.2-.5.2h-18c-.3%200-.5-.2-.6-.5-1.2-4.3-3.2-8.2-5.9-11.7L88.2%2043c3.4%206%205.5%2012.9%205.8%2020.3-.1.3-.2.4-.2.5'/%3e%3c/svg%3e",alt:"Speed limit",className:"w-7 h-7"}),s.jsx("span",{children:x("reservation.ruleSpeed")})]}),s.jsxs("div",{className:"flex items-center gap-3 text-white",children:[s.jsx("img",{src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='800'%20height='800'%20fill='%23fff'%20viewBox='0%200%2024%2024'%3e%3cpath%20fill='%23fff'%20fill-rule='nonzero'%20d='M13.5%204a8.5%208.5%200%201%201-4.822%2015.5H1.752a.75.75%200%200%201-.102-1.493L1.752%2018l5.268.001a8.5%208.5%200%200%201-1.022-1.5l-2.25-.001a.75.75%200%200%201-.103-1.493L3.747%2015l1.627.001A8.5%208.5%200%200%201%205%2012.5c0-2.098.76-4.018%202.02-5.5H2.75a.75.75%200%200%201-.102-1.493L2.75%205.5h5.927A8.46%208.46%200%200%201%2013.5%204m0%201.5a7%207%200%201%200%200%2014%207%207%200%200%200%200-14m.003%201.502a5.501%205.501%200%201%201%200%2011.003%205.501%205.501%200%200%201%200-11.003m1.151%207.714c-.345.18-.738.282-1.154.282-.412%200-.8-.1-1.143-.276l-1.096%201.096c.64.433%201.411.687%202.242.687.834%200%201.608-.255%202.249-.691zm-5.152-2.213c0%20.836.256%201.613.695%202.255l1.093-1.092A2.5%202.5%200%200%201%2011%2012.5c0-.417.103-.81.283-1.155l-1.09-1.09a4%204%200%200%200-.691%202.25m7.316-2.242-1.095%201.095c.176.342.276.731.276%201.143%200%20.417-.102.81-.282%201.156l1.097%201.097c.436-.641.69-1.415.69-2.249%200-.83-.253-1.603-.686-2.242M13.5%2011.5a1%201%200%201%200%200%201.998%201%201%200%200%200%200-1.998m.003-2.998c-.834%200-1.608.255-2.25.691l1.09%201.09c.346-.18.74-.283%201.157-.283.421%200%20.818.104%201.166.288l1.092-1.091a4%204%200%200%200-2.255-.695'/%3e%3c/svg%3e",alt:"No aggressive driving",className:"w-7 h-7"}),s.jsx("span",{children:x("reservation.ruleNoAggressive")})]})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("div",{className:"text-xl font-bold text-center mb-2 text-[#B90003]",children:x("reservation.clientCardTitle")}),s.jsxs("div",{className:"flex flex-col gap-2 bg-zinc-900 rounded-xl p-4 border border-[#B90003]",children:[s.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[s.jsx("span",{children:x("reservation.goldCard")}),s.jsx(v,{checked:r.goldCard,onCheckedChange:e=>n(t=>({...t,goldCard:e,clubCard:!e&&t.clubCard}))})]}),s.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[s.jsx("span",{children:x("reservation.clubCard")}),s.jsx(v,{checked:r.clubCard,onCheckedChange:e=>n(t=>({...t,clubCard:e,goldCard:!e&&t.goldCard}))})]})]})]}),s.jsxs("div",{className:"mb-0",children:[s.jsx("div",{className:"text-lg font-bold text-[#B90003] mb-2",children:x("reservation.costTitle")}),s.jsxs("div",{className:"bg-zinc-900 rounded-xl p-4 flex flex-col gap-2 text-white border border-[#B90003]",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:x("reservation.duration")})," ",s.jsxs("span",{children:[o()," ",x("reservation.days")]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:x("reservation.wash")})," ",s.jsx("span",{children:"20 €"})]}),r.unlimitedMileage&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:x("reservation.unlimitedMileageCost")})," ",s.jsxs("span",{children:[20*o()," €"]})]}),("address"===r.pickupType||"airport"===r.pickupType)&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:x("reservation.delivery")})," ",s.jsx("span",{children:"20 €"})]}),s.jsxs("div",{className:"flex justify-between font-bold text-lg",children:[s.jsx("span",{children:x("reservation.rentCost")})," ",s.jsxs("span",{children:[c-d," €"]})]}),s.jsx("div",{className:"border-t border-[#B90003]/30 my-2"}),s.jsxs("div",{className:"flex justify-between font-bold text-xl text-[#B90003]",children:[s.jsx("span",{children:x("reservation.totalAmount")})," ",s.jsxs("span",{children:[m," €"]})]})]})]}),s.jsx("div",{className:"w-full flex justify-center mb-2 mt-2",children:s.jsxs("span",{className:"text-sm font-semibold text-[#B90003] bg-black/30 rounded px-3 py-1",children:[x("reservation.step")," ",l]})}),s.jsx(y,{className:"w-full bg-[#B90003] hover:bg-[#A00002] text-white text-lg font-bold py-3 rounded-xl",onClick:p,children:x("reservation.next")}),s.jsx(y,{className:"w-full mt-2 bg-black text-[#B90003] border-[#B90003] border-2 text-lg font-bold py-3 rounded-xl",variant:"outline",onClick:u,children:x("reservation.back")})]})},I=({name:e,accept:t="image/*",required:a=!1,onChange:r,className:n,children:i})=>s.jsxs("div",{className:M("relative",n),children:[s.jsx("input",{type:"file",name:e,accept:t,required:a,onChange:r,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10"}),s.jsx("div",{className:"pointer-events-none",children:i})]}),R=""+new URL(""+new URL(""+new URL("front-uO_TmE2q-uO_TmE2q-uO_TmE2q.png",import.meta.url).href,import.meta.url).href,import.meta.url).href,L=""+new URL(""+new URL(""+new URL("back-CVoMtcNb-CVoMtcNb-CVoMtcNb.png",import.meta.url).href,import.meta.url).href,import.meta.url).href,P=e=>{if(!e)return"";const t=e.replace(/\D/g,"");return 0===t.length?"":1===t.length?t:t.length<=3?`0(${t.slice(1)}`:t.length<=9?`0(${t.slice(1,3)})${t.slice(3)}`:`0(${t.slice(1,3)})${t.slice(3,9)}`},F=({car:t,formData:a,setFormData:r,uploadedPhotos:n,setUploadedPhotos:i,privacyAccepted:l,setPrivacyAccepted:o,selectedCountryCode:c,setSelectedCountryCode:d,currentStep:m,stepIndicator:p,finalRentalCost:u,isSubmitting:h,handleSubmit:x,goBack:f})=>{var g;const{t:M}=e(),B=e=>{try{r(t=>({...t,[e.target.name]:e.target.value}))}catch(a){try{const e=t.id;localStorage.removeItem(`reservation-form-${e}`),localStorage.removeItem(`reservation-step-${e}`)}catch(s){}}},z=[{code:"+373",name:"Moldova",flag:"🇲🇩"},{code:"+1",name:"USA/Canada",flag:"🇺🇸"},{code:"+7",name:"Russia",flag:"🇷🇺"},{code:"+40",name:"Romania",flag:"🇷🇴"},{code:"+380",name:"Ukraine",flag:"🇺🇦"},{code:"+49",name:"Germany",flag:"🇩🇪"},{code:"+33",name:"France",flag:"🇫🇷"},{code:"+39",name:"Italy",flag:"🇮🇹"},{code:"+34",name:"Spain",flag:"🇪🇸"},{code:"+44",name:"UK",flag:"🇬🇧"},{code:"+48",name:"Poland",flag:"🇵🇱"},{code:"+31",name:"Netherlands",flag:"🇳🇱"},{code:"+41",name:"Switzerland",flag:"🇨🇭"},{code:"+43",name:"Austria",flag:"🇦🇹"},{code:"+32",name:"Belgium",flag:"🇧🇪"},{code:"+420",name:"Czech Republic",flag:"🇨🇿"},{code:"+36",name:"Hungary",flag:"🇭🇺"},{code:"+90",name:"Turkey",flag:"🇹🇷"},{code:"+972",name:"Israel",flag:"🇮🇱"},{code:"+86",name:"China",flag:"🇨🇳"},{code:"+81",name:"Japan",flag:"🇯🇵"},{code:"+82",name:"South Korea",flag:"🇰🇷"},{code:"+91",name:"India",flag:"🇮🇳"},{code:"+61",name:"Australia",flag:"🇦🇺"},{code:"+64",name:"New Zealand",flag:"🇳🇿"}];return s.jsxs("form",{className:"w-full max-w-md sm:max-w-full mx-auto flex flex-col gap-1 pb-4",onSubmit:x,encType:"multipart/form-data",children:[s.jsx("div",{className:"text-2xl font-bold mb-4 text-white text-center",children:M("reservation.step3Title")}),s.jsxs("div",{className:"flex justify-between items-center border-b border-[#B90003] pb-2 mb-2",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-lg font-bold text-[#B90003]",children:M("reservation.total")}),s.jsx("div",{className:"text-sm text-gray-300",children:M("reservation.totalCost")})]}),s.jsxs("div",{className:"text-2xl font-bold text-white",children:[u," €"]})]}),s.jsxs("div",{className:"w-full max-w-md sm:max-w-full mx-auto mb-2",children:[s.jsx("h3",{className:"text-xl font-bold text-center mb-2",children:M("reservation.paymentMethod")}),s.jsxs(b,{value:a.paymentMethod||"cash",onValueChange:e=>{try{r(t=>({...t,paymentMethod:e}))}catch(a){try{const e=t.id;localStorage.removeItem(`reservation-form-${e}`),localStorage.removeItem(`reservation-step-${e}`)}catch(s){}}},className:"flex flex-col gap-2 bg-gray-700 rounded-lg px-4 py-3 mb-2",children:[s.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[s.jsx("span",{children:M("reservation.cash")}),s.jsx(v,{checked:"cash"===a.paymentMethod,onCheckedChange:e=>r(t=>({...t,paymentMethod:e?"cash":"card"}))})]}),s.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[s.jsx("span",{children:M("reservation.card")}),s.jsx(v,{checked:"card"===a.paymentMethod,onCheckedChange:e=>r(t=>({...t,paymentMethod:e?"card":"cash"}))})]}),s.jsx("div",{className:"border-t border-[#B90003] my-2"}),s.jsxs("label",{className:"flex flex-col gap-1 cursor-pointer",children:[s.jsx("span",{className:"text-center",children:M("reservation.other")}),s.jsx(j,{type:"text",className:"bg-gray-800 rounded px-2 py-1 text-white",placeholder:M("reservation.other"),value:"other"===a.paymentMethod&&a.paymentOther||"",onFocus:()=>r(e=>({...e,paymentMethod:"other"})),onChange:e=>r(t=>({...t,paymentMethod:"other",paymentOther:e.target.value}))})]})]})]}),s.jsxs("div",{children:[s.jsx(w,{htmlFor:"firstName",className:"text-[#B90003] font-bold",children:M("reservation.firstName")}),s.jsx(j,{id:"firstName",name:"firstName",placeholder:M("reservation.firstName"),className:"bg-zinc-800 text-white border-none mt-1",value:a.firstName,onChange:B,required:!0})]}),s.jsxs("div",{children:[s.jsx(w,{htmlFor:"lastName",className:"text-[#B90003] font-bold",children:M("reservation.lastName")}),s.jsx(j,{id:"lastName",name:"lastName",placeholder:M("reservation.lastName"),className:"bg-zinc-800 text-white border-none mt-1",value:a.lastName,onChange:B,required:!0})]}),s.jsxs("div",{children:[s.jsx(w,{htmlFor:"email",className:"text-[#B90003] font-bold",children:M("reservation.email")}),s.jsx(j,{id:"email",name:"email",type:"email",placeholder:M("reservation.email"),className:"bg-zinc-800 text-white border-none mt-1",value:a.email,onChange:B,required:!0})]}),s.jsxs("div",{children:[s.jsx(w,{htmlFor:"idnp",className:"text-[#B90003] font-bold",children:M("reservation.idnp")}),s.jsx(j,{id:"idnp",name:"idnp",placeholder:"1234567890123",className:"bg-zinc-800 text-white border-none mt-1",value:a.idnp||"",onChange:e=>{const t=e.target.value.replace(/\D/g,"").slice(0,13);r(e=>({...e,idnp:t}))},maxLength:13,pattern:"[0-9]{13}",required:!0})]}),s.jsxs("div",{children:[s.jsx(w,{className:"text-[#B90003] font-bold",children:M("reservation.idPhotos")}),s.jsxs("div",{className:"flex gap-4 mt-2",children:[s.jsxs("div",{className:"flex flex-col items-center gap-1",children:[s.jsxs(I,{name:"idPhotoFront",accept:"image/*",required:!0,onChange:e=>{e.target.files&&e.target.files[0]&&i(e=>({...e,front:!0}))},className:"flex flex-col items-center justify-center w-28 h-28 bg-zinc-900 border-2 border-dashed rounded-lg cursor-pointer hover:bg-zinc-800 transition group "+(n.front?"border-green-400":"border-[#ffffff]"),children:[n.front?s.jsxs("span",{className:"flex flex-col items-center justify-center z-0",children:[s.jsx("svg",{width:"36",height:"36",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",className:"text-green-400 mb-1",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),s.jsx("span",{className:"text-xs text-green-400",children:M("reservation.uploaded")})]}):s.jsxs("span",{className:"flex flex-col items-center justify-center z-0",children:[s.jsx("svg",{width:"36",height:"36",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",className:"text-gray-400 mb-1",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),s.jsx("span",{className:"text-xs text-gray-400",children:M("reservation.upload")})]}),s.jsx("img",{src:R,alt:M("reservation.frontExample"),className:"absolute bottom-1 left-1 w-16 h-12 object-cover rounded shadow border border-gray-700 bg-black"})]}),s.jsx("span",{className:"text-xs text-gray-400 mt-1",children:M("reservation.frontExample")})]}),s.jsxs("div",{className:"flex flex-col items-center gap-1",children:[s.jsxs(I,{name:"idPhotoBack",accept:"image/*",required:!0,onChange:e=>{e.target.files&&e.target.files[0]&&i(e=>({...e,back:!0}))},className:"flex flex-col items-center justify-center w-28 h-28 bg-zinc-900 border-2 border-dashed rounded-lg cursor-pointer hover:bg-zinc-800 transition group "+(n.back?"border-green-400":"border-[#ffffff]"),children:[n.back?s.jsxs("span",{className:"flex flex-col items-center justify-center z-0",children:[s.jsx("svg",{width:"36",height:"36",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",className:"text-green-400 mb-1",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),s.jsx("span",{className:"text-xs text-green-400",children:M("reservation.uploaded")})]}):s.jsxs("span",{className:"flex flex-col items-center justify-center z-0",children:[s.jsx("svg",{width:"36",height:"36",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",className:"text-gray-400 mb-1",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),s.jsx("span",{className:"text-xs text-gray-400",children:M("reservation.upload")})]}),s.jsx("img",{src:L,alt:M("reservation.backExample"),className:"absolute bottom-1 left-1 w-16 h-12 object-cover rounded shadow border border-gray-700 bg-black"})]}),s.jsx("span",{className:"text-xs text-gray-400 mt-1",children:M("reservation.backExample")})]})]})]}),s.jsxs("div",{children:[s.jsx(w,{htmlFor:"phone",className:"text-[#B90003] font-bold",children:M("reservation.phone")}),s.jsxs("div",{className:"flex flex-col gap-2 mt-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(N,{value:c,onValueChange:d,children:[s.jsx(k,{className:"w-40 bg-zinc-800 text-white border-none hover:bg-zinc-700",children:s.jsx(C,{children:s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx("span",{children:null==(g=z.find(e=>e.code===c))?void 0:g.flag}),s.jsx("span",{children:c})]})})}),s.jsx(D,{className:"bg-zinc-800 border-zinc-700 z-[3001] max-h-60",children:z.map(e=>s.jsx(S,{value:e.code,className:"text-white hover:bg-zinc-700 focus:bg-zinc-700 cursor-pointer",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{children:e.flag}),s.jsx("span",{children:e.code}),s.jsx("span",{className:"text-gray-400 text-sm",children:e.name})]})},e.code))})]}),s.jsx(j,{id:"phone",name:"phone",type:"tel",placeholder:"0(XX)XXXXXX",className:"bg-zinc-800 text-white border-none flex-1 "+(9===a.phone.replace(/\D/g,"").length?"border-green-500 border-2":a.phone.replace(/\D/g,"").length>0?"border-yellow-500 border-2":""),value:P(a.phone.replace(new RegExp(`^\\${c}`),"")),onChange:e=>{const t=e.target.value.replace(/\D/g,"").slice(0,9);r(e=>({...e,phone:c+t}))},maxLength:13,required:!0})]}),s.jsx("div",{className:"text-xs text-gray-400",children:(()=>{const e=a.phone.replace(/\D/g,"").replace(c.replace(/\D/g,""),"").length;return 9===e?s.jsx("span",{className:"text-green-400",children:M("reservation.phoneValid")}):e>0?s.jsx("span",{className:"text-yellow-400",children:M("reservation.phoneIncomplete",{count:9-e})}):s.jsx("span",{className:"text-gray-400",children:M("reservation.phoneFormat")})})()})]})]}),s.jsxs("div",{className:"flex items-start gap-2 mt-2",children:[s.jsx(v,{id:"privacy",checked:l,onCheckedChange:e=>o(!!e),required:!0,className:"mt-1"}),s.jsxs("label",{htmlFor:"privacy",className:"text-white text-sm select-none",children:[M("reservation.privacyPolicy")," ",s.jsx("a",{href:"/privacy-policy.pdf",target:"_blank",rel:"noopener noreferrer",className:"text-[#B90003] underline ml-1",children:M("reservation.privacyPolicyLink")}),"."]}),!l&&s.jsx("div",{className:"text-red-400 text-xs mt-1",children:M("reservation.privacyRequired","Необходимо согласие для отправки заявки")})]}),s.jsx("div",{className:"w-full flex justify-center mb-2 mt-2",children:s.jsxs("span",{className:"text-sm font-semibold text-[#B90003] bg-black/30 rounded px-3 py-1",children:[M("reservation.step")," ",p]})}),s.jsx(y,{className:"w-full bg-[#B90003] hover:bg-[#A00002] disabled:bg-gray-400 disabled:cursor-not-allowed text-white text-lg font-bold py-3 rounded-xl",type:"submit",disabled:h,children:h?s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("div",{className:"w-5 h-5 border-2 border-black border-t-transparent rounded-full animate-spin"}),s.jsx("span",{children:M("reservation.submitting")})]}):M("reservation.book")}),s.jsx(y,{className:"w-full mt-2 bg-black text-[#B90003] border-[#B90003] border-2 text-lg font-bold py-3 rounded-xl disabled:opacity-50 disabled:cursor-not-allowed",variant:"outline",onClick:f,disabled:h,children:M("reservation.back")})]})},O=({isOpen:t,onClose:a,car:r})=>{const{t:l}=e();return s.jsx(n,{open:t,onOpenChange:()=>{},children:s.jsxs(i,{className:"max-w-md mx-auto bg-gradient-to-br from-zinc-900 to-black border-2 border-[#B90003] shadow-2xl shadow-[#B90003]/20",style:{zIndex:4e3},children:[s.jsx(c,{className:"sr-only",children:l("reservation.successTitle","Заявка отправлена!")}),s.jsx(d,{className:"sr-only",children:l("reservation.successDescription","Ваша заявка на аренду автомобиля была успешно отправлена. Мы свяжемся с вами в ближайшее время.")}),s.jsxs("div",{className:"text-center p-6",children:[s.jsx("div",{className:"mx-auto mb-6 w-20 h-20 bg-gradient-to-br from-[#B90003] to-[#A00002] rounded-full flex items-center justify-center shadow-lg shadow-[#B90003]/30 animate-pulse",children:s.jsx("svg",{className:"w-10 h-10 text-black",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M5 13l4 4L19 7"})})}),s.jsxs("h2",{className:"text-3xl font-bold text-white mb-4",children:["🚗 ",l("reservation.successTitle","Заявка отправлена!")]}),s.jsxs("div",{className:"bg-zinc-800/50 rounded-xl p-4 mb-4 border border-[#B90003]/30",children:[s.jsx("p",{className:"text-white mb-2 text-base leading-relaxed",children:l("reservation.successMessage","Ваша заявка на аренду")}),s.jsx("div",{className:"text-2xl font-bold text-[#B90003] mb-2",children:r.name}),s.jsx("p",{className:"text-white text-base",children:l("reservation.successMessageEnd","успешно отправлена!")})]}),s.jsx("div",{className:"bg-[#B90003]/10 rounded-lg p-3 mb-6 border border-[#B90003]/20",children:s.jsxs("p",{className:"text-[#B90003] text-sm leading-relaxed",children:["📞"," ",l("reservation.contactSoon","Мы свяжемся с вами в ближайшее время для подтверждения бронирования.")]})}),s.jsxs(y,{onClick:()=>{Object.keys(localStorage).filter(e=>e.includes("reservation-form-")||e.includes("reservation-step-")||e.includes("uploaded-photos-")||e.includes("privacy-accepted-")||e.includes("wizard-data-")||e.includes("selected-country-code-")||e.includes("active-image-index-")).forEach(e=>{localStorage.removeItem(e)}),"serviceWorker"in navigator&&"caches"in window&&caches.keys().then(e=>{e.forEach(e=>{e.includes("dynamic")&&caches.delete(e)})}),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{var t;null==(t=e.active)||t.postMessage({type:"CLEAR_CACHE"})}),a()},className:"w-full bg-[#B90003] hover:bg-[#A00002] text-white font-bold text-lg py-4 rounded-xl shadow-lg shadow-[#B90003]/30 transform transition hover:scale-105 glow-effect",children:["✓ ",l("reservation.okButton","Понятно, спасибо!")]}),s.jsx("div",{className:"absolute top-4 left-4 w-3 h-3 bg-[#B90003]/30 rounded-full animate-ping"}),s.jsx("div",{className:"absolute top-6 right-6 w-2 h-2 bg-[#B90003]/50 rounded-full animate-pulse"}),s.jsx("div",{className:"absolute bottom-8 left-6 w-2 h-2 bg-[#B90003]/40 rounded-full animate-bounce"})]})]})})},q=["main","summary","personal"],E=({isOpen:h,onClose:x,car:f})=>{const{t:g,i18n:v}=e(),b=t("(max-width: 767px)"),{formData:j,setFormData:y,currentStep:w,setCurrentStep:N,uploadedPhotos:k,setUploadedPhotos:C,privacyAccepted:D,setPrivacyAccepted:S,wizardData:M,setWizardData:B,selectedCountryCode:z,setSelectedCountryCode:A,clearCarCache:I}=function(e){const[t,r]=a.useState({firstName:"",lastName:"",email:"",phone:"",pickupDate:"",returnDate:"",pickupTime:"10:00",returnTime:"",message:"",pickupType:"office",idnp:"",pickupAddress:"",unlimitedMileage:!1,goldCard:!1,clubCard:!1,paymentMethod:"cash",paymentOther:""}),[s,n]=a.useState(0),[i,l]=a.useState({front:!1,back:!1}),[o,c]=a.useState(!1),[d,m]=a.useState("+373"),[p,u]=a.useState(0),[h,x]=a.useState({pickupDate:"",returnDate:"",pickupTime:"10:00",pickupType:"office",pickupAddress:"",unlimitedMileage:!1,goldCard:!1,clubCard:!1});return a.useEffect(()=>{if(e)try{const t=localStorage.getItem(`reservation-form-${e}`),a=localStorage.getItem(`reservation-step-${e}`),s=localStorage.getItem(`uploaded-photos-${e}`),i=localStorage.getItem(`privacy-accepted-${e}`),o=localStorage.getItem(`wizard-data-${e}`),d=localStorage.getItem(`selected-country-code-${e}`),p=localStorage.getItem(`active-image-index-${e}`);t&&r(JSON.parse(t)),a&&n(JSON.parse(a)),s&&l(JSON.parse(s)),i&&c(JSON.parse(i)),o&&x(JSON.parse(o)),d&&m(JSON.parse(d)),p&&u(JSON.parse(p))}catch(t){}},[e]),{formData:t,setFormData:a=>{const s="function"==typeof a?a(t):a;r(s),((t,a)=>{if(e)try{localStorage.setItem(`reservation-form-${e}`,JSON.stringify(a))}catch(r){}})(0,s)},currentStep:s,setCurrentStep:t=>{const a="function"==typeof t?t(s):t;n(a),(t=>{if(e)try{localStorage.setItem(`reservation-step-${e}`,JSON.stringify(t))}catch(a){}})(a)},uploadedPhotos:i,setUploadedPhotos:t=>{const a="function"==typeof t?t(i):t;l(a),(t=>{if(e)try{localStorage.setItem(`uploaded-photos-${e}`,JSON.stringify(t))}catch(a){}})(a)},privacyAccepted:o,setPrivacyAccepted:t=>{const a="function"==typeof t?t(o):t;c(a),(t=>{if(e)try{localStorage.setItem(`privacy-accepted-${e}`,JSON.stringify(t))}catch(a){}})(a)},wizardData:h,setWizardData:t=>{const a="function"==typeof t?t(h):t;x(a),(t=>{if(e)try{localStorage.setItem(`wizard-data-${e}`,JSON.stringify(t))}catch(a){}})(a)},selectedCountryCode:d,setSelectedCountryCode:t=>{const a="function"==typeof t?t(d):t;m(a),(t=>{if(e)try{localStorage.setItem(`selected-country-code-${e}`,JSON.stringify(t))}catch(a){}})(a)},activeImageIndex:p,setActiveImageIndex:t=>{const a="function"==typeof t?t(p):t;u(a),(t=>{if(e)try{localStorage.setItem(`active-image-index-${e}`,JSON.stringify(t))}catch(a){}})(a)},clearCarCache:()=>{e&&([`reservation-form-${e}`,`reservation-step-${e}`,`uploaded-photos-${e}`,`privacy-accepted-${e}`,`wizard-data-${e}`,`selected-country-code-${e}`,`active-image-index-${e}`].forEach(e=>{localStorage.removeItem(e)}),r({firstName:"",lastName:"",email:"",phone:"",pickupDate:"",returnDate:"",pickupTime:"10:00",returnTime:"",message:"",pickupType:"office",idnp:"",pickupAddress:"",unlimitedMileage:!1,goldCard:!1,clubCard:!1,paymentMethod:"cash",paymentOther:""}),n(0),l({front:!1,back:!1}),c(!1),m("+373"),u(0),x({pickupDate:"",returnDate:"",pickupTime:"10:00",pickupType:"office",pickupAddress:"",unlimitedMileage:!1,goldCard:!1,clubCard:!1}))},clearAllCarCaches:()=>{Object.keys(localStorage).filter(e=>e.includes("reservation-form-")||e.includes("reservation-step-")||e.includes("uploaded-photos-")||e.includes("privacy-accepted-")||e.includes("wizard-data-")||e.includes("selected-country-code-")||e.includes("active-image-index-")).forEach(e=>{localStorage.removeItem(e)})}}}(f.id),[R,L]=a.useState(!1),[P,E]=a.useState(!1),W=`${w+1}/${q.length}`,_=()=>{if(j.pickupDate&&j.returnDate){const e=new Date(j.pickupDate),t=new Date(j.returnDate);if(isNaN(e.getTime())||isNaN(t.getTime()))return 1;if(t<=e)return 1;const a=Math.abs(t.getTime()-e.getTime());return Math.ceil(a/864e5)}return 1},H=_();var Y;const V=((Y=H)>=30?f.price30plus:Y>=21?f.price21to29:Y>=11?f.price11to20:Y>=2?f.price2to10:f.pricePerDay)*H,X=(U=V,M.goldCard?.25*U:M.clubCard?.1*U:0);var U;const J=V-X+((M.unlimitedMileage?20*_():0)+("address"===M.pickupType||"airport"===M.pickupType?20:0))+20,Z=()=>{(e=>{var t;switch(e){case 0:{if(!j.pickupDate)return p({title:g("validation.error","Ошибка валидации"),description:g("validation.pickupDateRequired","Выберите дату выдачи"),variant:"destructive"}),!1;if(!j.returnDate)return p({title:g("validation.error","Ошибка валидации"),description:g("validation.returnDateRequired","Выберите дату возврата"),variant:"destructive"}),!1;if(!j.pickupTime)return p({title:g("validation.error","Ошибка валидации"),description:g("validation.pickupTimeRequired","Выберите время выдачи"),variant:"destructive"}),!1;const e=new Date(j.pickupDate);return new Date(j.returnDate)<=e?(p({title:g("validation.error","Ошибка валидации"),description:g("validation.invalidDateRange","Дата возврата должна быть позже даты выдачи"),variant:"destructive"}),!1):!("address"===M.pickupType&&!(null==(t=M.pickupAddress)?void 0:t.trim())&&(p({title:g("validation.error","Ошибка валидации"),description:g("validation.addressRequired","Введите адрес доставки"),variant:"destructive"}),1))}case 1:default:return!0;case 2:return j.firstName.trim()?j.lastName.trim()?j.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(j.email)?j.phone.trim()?9!==j.phone.replace(/\D/g,"").replace(z.replace(/\D/g,""),"").length?(p({title:g("validation.error","Ошибка валидации"),description:g("validation.phoneInvalid","Номер телефона должен содержать ровно 9 цифр (0 + код оператора + номер)"),variant:"destructive"}),!1):j.idnp.trim()?13!==j.idnp.replace(/\D/g,"").length?(p({title:g("validation.error","Ошибка валидации"),description:g("validation.idnpInvalid","IDNP должен содержать ровно 13 цифр"),variant:"destructive"}),!1):k.front?k.back?!!D||(p({title:g("validation.error","Ошибка валидации"),description:g("validation.privacyRequired","Необходимо согласие на обработку персональных данных"),variant:"destructive"}),!1):(p({title:g("validation.error","Ошибка валидации"),description:g("validation.backPhotoRequired","Загрузите фото обратной стороны документа"),variant:"destructive"}),!1):(p({title:g("validation.error","Ошибка валидации"),description:g("validation.frontPhotoRequired","Загрузите фото лицевой стороны документа"),variant:"destructive"}),!1):(p({title:g("validation.error","Ошибка валидации"),description:g("validation.idnpRequired","Введите IDNP"),variant:"destructive"}),!1):(p({title:g("validation.error","Ошибка валидации"),description:g("validation.phoneRequired","Введите номер телефона"),variant:"destructive"}),!1):(p({title:g("validation.error","Ошибка валидации"),description:g("validation.emailInvalid","Введите корректный email"),variant:"destructive"}),!1):(p({title:g("validation.error","Ошибка валидации"),description:g("validation.emailRequired","Введите email"),variant:"destructive"}),!1):(p({title:g("validation.error","Ошибка валидации"),description:g("validation.lastNameRequired","Введите фамилию"),variant:"destructive"}),!1):(p({title:g("validation.error","Ошибка валидации"),description:g("validation.firstNameRequired","Введите имя"),variant:"destructive"}),!1)}})(w)&&(y(e=>({...e,pickupDate:M.pickupDate||"",returnDate:M.returnDate||"",pickupTime:M.pickupTime||"10:00",pickupType:M.pickupType||"office",pickupAddress:M.pickupAddress||"",unlimitedMileage:M.unlimitedMileage||!1,goldCard:M.goldCard||!1,clubCard:M.clubCard||!1})),N(e=>{const t=Math.min(e+1,q.length-1);return 1===t&&setTimeout(()=>{const e=document.querySelector('.DialogContent, .dialog-content, [role="dialog"]');e?e.scrollTo({top:0,behavior:"smooth"}):window.scrollTo({top:0,behavior:"smooth"})},50),2===t&&setTimeout(()=>{const e=document.querySelector('.DialogContent, .dialog-content, [role="dialog"]');e?e.scrollTo({top:0,behavior:"smooth"}):window.scrollTo({top:0,behavior:"smooth"})},50),t}))},K=()=>N(e=>Math.max(e-1,0));a.useEffect(()=>{h||(N(0),L(!1),S(!1),C({front:!1,back:!1}),E(!1))},[h]);const{data:G=[]}=r({queryKey:["orders"],queryFn:u,staleTime:6e5}),Q=G.filter(e=>{const t=e.carIds&&e.carIds.includes(f.id),a="подтверждена"===e.status||"подтвержден"===e.status,r=e.startDate&&e.endDate;return t&&a&&r});function ee(e){if(!e)return null;if(e.includes("-")){const[t,a,r]=e.split("-");return new Date(+t,+a-1,+r)}if(e.includes(".")){const[t,a,r]=e.split(".");return new Date(+r,+a-1,+t)}return null}const te=[];return Q.forEach(e=>{const t=ee(e.startDate),a=ee(e.endDate);if(t&&a)for(let r=new Date(t.getFullYear(),t.getMonth(),t.getDate());r<=a;r.setDate(r.getDate()+1))te.push(new Date(r.getFullYear(),r.getMonth(),r.getDate()))}),s.jsxs(s.Fragment,{children:[s.jsx(n,{open:h,onOpenChange:R?void 0:x,children:s.jsxs(i,{className:b?"fixed inset-0 w-full max-w-[400px] sm:max-w-[98vw] min-w-0 min-h-[100dvh] h-[100dvh] top-0 left-0 z-[3000] bg-background overflow-y-auto rounded-none p-0 pt-4 pb-[env(safe-area-inset-bottom,12px)] px-4 sm:px-2 box-border":"max-w-4xl max-h-[90vh] overflow-y-auto z-[3000] !top-1/2 !left-1/2 !translate-x-[-50%] !translate-y-[-50%] sm:max-w-lg md:max-w-2xl p-6 md:px-8 box-border",style:b?{zIndex:3e3,maxWidth:"100vw",minWidth:0}:{zIndex:3e3},children:[s.jsx("button",{onClick:R?void 0:x,className:"absolute top-3 right-3 z-[3001] text-3xl text-[#ffffff] hover:text-[#686868] transition md:top-4 md:right-4 bg-black/20 rounded-full p-1 "+(R?"opacity-50 cursor-not-allowed":""),"aria-label":g("reservation.cancel"),disabled:R,children:s.jsx(l,{size:24})}),s.jsxs(o,{children:[s.jsx(c,{className:"text-2xl font-bold",children:g("reservation.title")}),s.jsx(d,{className:"sr-only",children:g("reservation.dialogDescription","Форма бронирования автомобиля. Заполните все поля и отправьте заявку.")})]}),s.jsxs("div",{className:"w-full pb-4",children:[0===w&&s.jsx(T,{car:f,formData:j,setFormData:y,wizardData:M,setWizardData:B,currentStep:w,stepIndicator:W,disabledDays:te,goNext:Z,goBack:K,i18n:v}),1===w&&s.jsx($,{car:f,formData:j,wizardData:M,setWizardData:B,currentStep:w,stepIndicator:W,calculateDays:_,totalPrice:V,discount:X,finalRentalCost:J,goNext:Z,goBack:K,i18n:v}),2===w&&s.jsx(F,{car:f,formData:j,setFormData:y,uploadedPhotos:k,setUploadedPhotos:C,privacyAccepted:D,setPrivacyAccepted:S,selectedCountryCode:z,setSelectedCountryCode:A,currentStep:w,stepIndicator:W,finalRentalCost:J,isSubmitting:R,handleSubmit:async e=>{if(e.preventDefault(),R)return;L(!0);const t=e.target,a=new globalThis.FormData(t);try{await m({name:j.firstName+" "+j.lastName,phone:j.phone,email:j.email,car:[f.id],startDate:j.pickupDate,endDate:j.returnDate,comment:j.message,pickupTime:j.pickupTime,idnp:j.idnp,pickupType:j.pickupType,pickupAddress:j.pickupAddress,unlimitedMileage:j.unlimitedMileage,goldCard:j.goldCard,clubCard:j.clubCard,paymentMethod:j.paymentMethod,paymentOther:j.paymentOther,idPhotoFront:a.get("idPhotoFront"),idPhotoBack:a.get("idPhotoBack"),totalCost:J,discountAmount:X,unlimitedMileageCost:M.unlimitedMileage?20*_():0,deliveryCost:"address"===M.pickupType||"airport"===M.pickupType?20:0}),E(!0),L(!1)}catch(r){p({title:g("reservation.errorTitle"),description:g("reservation.errorDesc"),variant:"destructive"}),L(!1)}},goBack:K})]})]})}),s.jsx(O,{isOpen:P,onClose:()=>{E(!1),I(),x()},car:f})]})};if("undefined"!=typeof document&&!document.getElementById("calendar-styles")){const e=document.createElement("style");e.id="calendar-styles",e.textContent='\n  .calendar-day-disabled-strike::after {\n    content: "";\n    position: absolute;\n    left: 15%;\n    top: 50%;\n    width: 70%;\n    height: 2px;\n    background: linear-gradient(90deg, #ff3333 60%, transparent 100%);\n    transform: rotate(-20deg);\n    pointer-events: none;\n    z-index: 2;\n  }\n  .calendar-day-disabled-strike::before {\n    content: "-";\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    transform: translate(-50%, -50%) scale(1.5);\n    color: #ff3333;\n    font-size: 1.2em;\n    font-weight: bold;\n    pointer-events: none;\n    z-index: 3;\n  }\n',document.head.appendChild(e)}export{E as CarReservationModal,E as default};
