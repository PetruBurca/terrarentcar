import{j as e}from"./ui-KGOU9Zub.js";import{r as t,R as a}from"./vendor-C1mj56OW.js";import{l as r,t as s,C as n,e as i,S as l,R as o,I as c,B as d,f as m,L as p,g as u,h,i as x,j as f,k as g,D as v,m as b,n as j,o as y,u as w,p as N,q as k,r as C}from"./index-CMeCQ1Ax.js";import{u as D}from"./query-CjOa7rB9.js";import{u as S}from"./i18n-DsIgav-U.js";import{X as M}from"./utils-CeiXZxcG.js";function B({value:a,onChange:r,onClose:s}){const{t:n}=S(),[i,l]=t.useState(Number(a.split(":")[0])),[o,c]=t.useState(Number(a.split(":")[1])),d=Array.from({length:24},(e,t)=>t),m=Array.from({length:60},(e,t)=>t),p=t.useRef(null),u=t.useRef(null),[h,x]=t.useState(120),f=t.useRef(!1),g=t.useRef(!1),[v,b]=t.useState(0),[j,y]=t.useState(0);t.useEffect(()=>{if(p.current){const e=40,t=p.current.offsetHeight;x(t/2-e/2)}},[]),t.useEffect(()=>{if(!f.current&&p.current){const e=40*i;p.current.scrollTop=e,b(e),f.current=!0}if(!g.current&&u.current){const e=40*o;u.current.scrollTop=e,y(e),g.current=!0}},[]);const w=(e,t)=>{if(e.current){const a=40;e.current.scrollTo({top:t*a,behavior:"smooth"})}},N=e=>[...e,...e,...e],k=N(d),C=N(m),D=(e,t)=>{const a=Math.round(e/40),r=Math.abs(t-a);return 0===r?{color:"#ffffff",fontWeight:600,fontSize:"1.1em",transform:"scale(1.05)",opacity:1}:1===r?{color:"#d1d5db",fontWeight:500,fontSize:"1em",transform:"scale(1)",opacity:.8}:2===r?{color:"#9ca3af",fontWeight:400,fontSize:"0.95em",transform:"scale(0.95)",opacity:.4}:{color:"#6b7280",fontWeight:300,fontSize:"0.9em",transform:"scale(0.9)",opacity:.2}};return e.jsxs(e.Fragment,{children:[e.jsx("style",{children:"\n        .time-picker-scrollbar {\n          scrollbar-width: none;\n          -ms-overflow-style: none;\n          overflow-x: hidden;\n        }\n        .time-picker-scrollbar::-webkit-scrollbar {\n          display: none;\n        }\n        .time-picker-item {\n          transition: all 0.3s ease-out;\n          position: relative;\n          cursor: pointer;\n        }\n        .time-picker-item:hover {\n          color: #ffffff !important;\n          opacity: 1 !important;\n        }\n        .center-line {\n          position: absolute;\n          left: 0;\n          right: 0;\n          top: 50%;\n          transform: translateY(-50%);\n          height: 40px;\n          background: rgba(185, 0, 3, 0.15);\n          border: 1px solid rgba(185, 0, 3, 0.3);\n          border-radius: 8px;\n          pointer-events: none;\n          z-index: 5;\n        }\n      "}),e.jsx("div",{className:"relative w-full max-w-xs mx-auto flex flex-col items-center bg-[#232325] rounded-2xl p-4 shadow-xl z-10",children:e.jsxs("div",{className:"flex gap-4 relative h-48 w-full justify-center overflow-hidden",children:[e.jsx("div",{className:"center-line"}),e.jsxs("div",{ref:p,className:"flex-1 h-full overflow-y-auto overflow-x-hidden snap-y snap-mandatory time-picker-scrollbar relative",style:{minWidth:60,maxWidth:60},onScroll:()=>{if(p.current){const e=p.current.scrollTop;b(e);const t=Math.round(e/40)%24;if(t!==i){l(t);const e=`${t.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`;r(e)}}},children:[e.jsx("div",{style:{height:h}}),k.map((t,a)=>{const r=D(v,a);return e.jsx("div",{className:"h-10 flex items-center justify-center text-lg snap-center time-picker-item",style:r,onClick:()=>((e,t)=>{l(e),w(p,t)})(t,a),children:t.toString().padStart(2,"0")},`hour-${a}`)}),e.jsx("div",{style:{height:h}})]}),e.jsxs("div",{ref:u,className:"flex-1 h-full overflow-y-auto overflow-x-hidden snap-y snap-mandatory time-picker-scrollbar relative",style:{minWidth:60,maxWidth:60},onScroll:()=>{if(u.current){const e=u.current.scrollTop;y(e);const t=Math.round(e/40)%60;if(t!==o){c(t);const e=`${i.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`;r(e)}}},children:[e.jsx("div",{style:{height:h}}),C.map((t,a)=>{const r=D(j,a);return e.jsx("div",{className:"h-10 flex items-center justify-center text-lg snap-center time-picker-item",style:r,onClick:()=>((e,t)=>{c(e),w(u,t)})(t,a),children:t.toString().padStart(2,"0")},`minute-${a}`)}),e.jsx("div",{style:{height:h}})]})]})})]})}const z=({items:a,title:r,colorCenter:s,colorSide:n,valueSuffix:i=""})=>{const[l,o]=t.useState(5);t.useEffect(()=>{const e=()=>{o(window.innerWidth<=640?3:5)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const[c,d]=t.useState(0),[m,p]=t.useState(0),[u,h]=t.useState(!1),[x,f]=t.useState({x:0,y:0}),[g,v]=t.useState({x:0,y:0}),[b,j]=t.useState(0),[y,w]=t.useState(null),[N,k]=t.useState(!1),C=t.useRef(null);t.useRef();const D=120;a.length;const S=t.useCallback(e=>e,[]),M=t.useCallback(()=>(Math.round(c/D)%a.length+a.length)%a.length,[c,D,a.length]),B=t.useCallback(e=>{const t=e.touches[0];h(!0),f({x:t.clientX,y:t.clientY}),v({x:t.clientX,y:t.clientY}),p(0),j(Date.now()),w(null),k(!1)},[]),z=t.useCallback(e=>{if(!u)return;const t=e.touches[0],a=t.clientX-x.x,r=t.clientY-x.y;null===y&&(Math.abs(a)>5||Math.abs(r)>5)&&(Math.abs(a)>Math.abs(r)?w("horizontal"):w("vertical")),"horizontal"===y&&(e.preventDefault(),e.stopPropagation(),v({x:t.clientX,y:t.clientY}),p(-a))},[u,x,y,5,D,c]),T=t.useCallback(e=>{if(u){if(e.preventDefault(),e.stopPropagation(),h(!1),p(0),"horizontal"===y){const e=c+m,t=Math.round(e/D)*D;k(!0),d(t),setTimeout(()=>k(!1),250)}else{const e=Math.round(c/D)*D;k(!0),d(e),setTimeout(()=>k(!1),250)}w(null)}},[u,y,g,x,10,S,c,D,a.length]),A=t.useCallback(e=>{e.preventDefault(),h(!0),f({x:e.clientX,y:e.clientY}),v({x:e.clientX,y:e.clientY}),p(0),j(Date.now()),w("horizontal"),k(!1)},[]),$=t.useCallback(e=>{if(!u||"horizontal"!==y)return;const t=e.clientX-x.x;v({x:e.clientX,y:e.clientY}),p(-t)},[u,y,x,D,c]),I=t.useCallback(()=>{if(u){if(h(!1),p(0),"horizontal"===y){const e=c+m,t=Math.round(e/D)*D;k(!0),d(t),setTimeout(()=>k(!1),250)}w(null)}},[u,y,g,x,10,S,c,D,a.length]),R=t.useCallback(()=>{u&&I()},[u,I]),L=t.useCallback(()=>{N||(k(!0),d(e=>e-D),setTimeout(()=>k(!1),250))},[D,N]),P=t.useCallback(()=>{N||(k(!0),d(e=>e+D),setTimeout(()=>k(!1),250))},[D,N]),F=t.useMemo(()=>{const t=[],r=Math.round(c/D),s=c+m,n=l+4;for(let l=-n;l<=n;l++){const o=r+l,m=(o%a.length+a.length)%a.length,p=a[m],h=o*D-s;if(Math.abs(h)>D*(n+1))continue;const x=Math.abs(h)/144,f=Math.max(0,Math.min(1,1-x)),g=.85+.3*f,v=.5+.5*f,b=15+6*f,j=f>.6,y=f>.3&&!j,w=j?.9*f:y?.8:.7,C=j?`rgba(185, 0, 3, ${w})`:`rgba(63, 63, 70, ${w})`,S=j?"#fff":y?"#838383":"#fff";t.push(e.jsxs("div",{className:`absolute flex flex-col items-center justify-center rounded-lg px-2 py-2 cursor-pointer select-none will-change-transform ${j?"hover:scale-105 active:scale-95":y?"hover:scale-110 active:scale-100 hover:shadow-[#B90003]/30 hover:ring-1 hover:ring-[#B90003]/50":"hover:scale-105 active:scale-95"} ${u?"":N?"transition-all duration-250 ease-out":"transition-all duration-150 ease-out hover:shadow-lg"}`,title:y?`Выбрать ${p.label}: ${p.value}${i}`:"",style:{left:`calc(50% + ${h}px)`,transform:`translateX(-50%) scale(${g})`,transformOrigin:"center center",opacity:v,backgroundColor:C,color:S,width:"110px",height:"80px",zIndex:Math.round(10*f)+10,boxShadow:j?"0 4px 12px rgba(185, 0, 3, 0.25)":"none",border:"none",position:"absolute",top:"50%",marginTop:"-40px",pointerEvents:"auto",backfaceVisibility:"hidden",perspective:"1000px",cursor:j?"default":"pointer"},onClick:e=>{if(e.preventDefault(),e.stopPropagation(),N)return;k(!0);const t=Math.round(c/D);if(o!==t){d(o*D)}setTimeout(()=>k(!1),250)},children:[e.jsx("div",{className:"text-xs mb-1 opacity-70",children:p.label}),e.jsxs("div",{className:"font-bold text-center",style:{fontSize:`${b}px`,fontWeight:j?700:500},children:[p.value,i?` ${i}`:""]})]},`${m}-${o}`))}return t},[c,m,D,a,l,u,N,i]);return e.jsxs("div",{className:"w-full max-w-full md:max-w-lg mx-auto relative",children:[e.jsx("h3",{className:"text-xl font-bold text-center mb-4 text-white",children:r}),e.jsx("button",{onClick:L,disabled:N,className:"absolute left-0 z-20 p-2 bg-black/40 rounded-full text-[#B90003] hover:bg-[#A00002] hover:scale-110 active:scale-95 transition-all duration-200 disabled:opacity-50 shadow-lg hover:shadow-[#B90003]/30",style:{top:"50%",transform:"translateY(-50%)",marginTop:"12px"},children:"←"}),e.jsx("button",{onClick:P,disabled:N,className:"absolute right-0 z-20 p-2 bg-black/40 rounded-full text-[#B90003] hover:bg-[#A00002] hover:scale-110 active:scale-95 transition-all duration-200 disabled:opacity-50 shadow-lg hover:shadow-[#B90003]/30",style:{top:"50%",transform:"translateY(-50%)",marginTop:"12px"},children:"→"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-28 h-16 pointer-events-none z-5",style:{background:"radial-gradient(ellipse, rgba(250, 204, 21, 0.02) 40%, transparent 70%)"}}),e.jsx("div",{ref:C,className:"relative h-24 overflow-hidden cursor-grab active:cursor-grabbing",onTouchStart:B,onTouchMove:z,onTouchEnd:T,onMouseDown:A,onMouseMove:$,onMouseUp:I,onMouseLeave:R,style:{userSelect:"none",WebkitUserSelect:"none",touchAction:"pan-x",WebkitTouchCallout:"none",overscrollBehavior:"contain",overscrollBehaviorX:"none",overscrollBehaviorY:"auto",pointerEvents:"auto"},children:F}),e.jsx("div",{className:"flex justify-center gap-1 mt-3",children:a.map((t,r)=>e.jsx("button",{onClick:()=>{if(N)return;k(!0);const e=Math.round(c/D),t=(e%a.length+a.length)%a.length;let s=e;const n=(r-t+a.length)%a.length,i=(t-r+a.length)%a.length;s=n<=i?e+n:e-i,d(s*D),setTimeout(()=>k(!1),250)},disabled:N,className:"h-2 w-2 rounded-full transition-all duration-300 cursor-pointer hover:scale-125 active:scale-110 disabled:cursor-default "+(M()===r?"bg-[#B90003] scale-125 shadow-md shadow-[#B90003]/50 ring-2 ring-[#B90003]/30":"bg-gray-600 scale-100 opacity-70 hover:opacity-100 hover:bg-gray-500")},r))})]})},T=({car:t,formData:m,setFormData:p,wizardData:u,setWizardData:h,currentStep:x,stepIndicator:f,disabledDays:g,goNext:v,goBack:b,i18n:j})=>{const{t:y}=S(),[w,N]=a.useState(0),[k,C]=a.useState(!1),D=Array.isArray(t.images)?t.images:[],M=j.language;"en"===M?t.description_en||t.description_ru||t.description_ro:"ro"===M?t.description_ro||t.description_ru||t.description_en:t.description_ru||t.description_ro||t.description_en;const T=e=>e?`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}`:"",A=u.pickupDate||m.pickupDate,$=u.returnDate||m.returnDate,I=(()=>{const e=A&&""!==A.trim(),t=$&&""!==$.trim();if(!e&&!t)return;const a=e&&g.some(e=>e.getFullYear()===new Date(A).getFullYear()&&e.getMonth()===new Date(A).getMonth()&&e.getDate()===new Date(A).getDate()),r=t&&g.some(e=>e.getFullYear()===new Date($).getFullYear()&&e.getMonth()===new Date($).getMonth()&&e.getDate()===new Date($).getDate());return a||r?void 0:{from:e?new Date(A):void 0,to:t?new Date($):void 0}})(),R=A?new Date(A):$?new Date($):new Date;return e.jsxs("div",{className:"flex flex-col items-center gap-1 pb-4",children:[e.jsxs("div",{className:"w-full flex flex-col items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-center mb-2 text-white",children:t.name}),e.jsxs("div",{className:"relative w-full max-w-md mx-auto",children:[e.jsx("img",{src:t.images[w]||r,alt:t.name,className:"w-full h-80 object-cover rounded-lg border border-gray-800",style:{objectPosition:"center 60%"}}),t.images&&t.images.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:()=>N(e=>e>0?e-1:D.length-1),className:"absolute left-3 top-1/2 -translate-y-1/2 bg-black/80 backdrop-blur-sm text-white rounded-full p-3 hover:bg-[#B90003] hover:text-white transition-all duration-300 hover:scale-110 shadow-lg border border-white/20","aria-label":"Prev",children:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})})}),e.jsx("button",{type:"button",onClick:()=>N(e=>e<D.length-1?e+1:0),className:"absolute right-3 top-1/2 -translate-y-1/2 bg-black/80 backdrop-blur-sm text-white rounded-full p-3 hover:bg-[#B90003] hover:text-white transition-all duration-300 hover:scale-110 shadow-lg border border-white/20","aria-label":"Next",children:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})})})]})]}),t.images&&t.images.length>1&&e.jsx("div",{className:"flex justify-center gap-2 mt-2",children:t.images.map((t,a)=>e.jsx("img",{src:t,alt:`thumb-${a}`,className:"w-14 h-14 object-cover rounded cursor-pointer border-2 "+(w===a?"border-[#B90003]":"border-gray-700"),onClick:()=>N(a)},a))})]}),e.jsx(z,{items:[{label:y("reservation.pricePerDay"),value:t.pricePerDay},{label:y("reservation.price2to10"),value:t.price2to10},{label:y("reservation.price11to20"),value:t.price11to20},{label:y("reservation.price21to29"),value:t.price21to29},{label:y("reservation.price30plus"),value:t.price30plus}],title:y("reservation.priceTitle"),colorCenter:"bg-[#B90003] text-white",colorSide:"bg-gray-800 text-white opacity-60",valueSuffix:"€"}),e.jsx(z,{items:[{label:y("reservation.drive"),value:s("drive",t.drive,y)},{label:y("reservation.fuel"),value:s("fuel",t.fuel,y)},{label:y("reservation.rating"),value:t.rating},{label:y("reservation.passengers"),value:t.passengers},{label:y("reservation.transmission"),value:s("transmission",t.transmission,y)},{label:y("reservation.year"),value:t.year},{label:y("reservation.engine"),value:t.engine}],title:y("reservation.featuresTitle"),colorCenter:"bg-[#B90003] text-white",colorSide:"bg-gray-800 text-white opacity-60"}),e.jsxs("div",{className:"w-full max-w-md mx-auto",children:[e.jsx("h3",{className:"text-xl font-bold text-center mb-2",children:y("reservation.calendarTitle")}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(n,{mode:"range",selected:I,defaultMonth:R,onSelect:e=>{const t=e=>!!e&&g.some(t=>t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate());if(t(null==e?void 0:e.from)||t(null==e?void 0:e.to))return i({title:y("reservation.disabledRangeTitle","Нельзя выбрать эти даты"),description:y("reservation.disabledRangeDesc","В выбранном диапазоне есть занятые дни. Пожалуйста, выберите другой период."),variant:"destructive"}),p(e=>({...e,pickupDate:"",returnDate:""})),void h(e=>({...e,pickupDate:"",returnDate:""}));if((null==e?void 0:e.from)&&(null==e?void 0:e.to))if(e.to<e.from){const t=T(e.to),a=T(e.from);p(e=>({...e,pickupDate:t,returnDate:a})),h(e=>({...e,pickupDate:t,returnDate:a}))}else{const t=T(e.from),a=T(e.to);p(e=>({...e,pickupDate:t,returnDate:a})),h(e=>({...e,pickupDate:t,returnDate:a}))}else if(null==e?void 0:e.from){const t=T(e.from);p(e=>({...e,pickupDate:t,returnDate:""})),h(e=>({...e,pickupDate:t,returnDate:""}))}else p(e=>({...e,pickupDate:"",returnDate:""})),h(e=>({...e,pickupDate:"",returnDate:""}))},disabled:g,fromDate:new Date,className:"rounded-xl bg-zinc-900/80 border border-zinc-700 shadow-lg p-2 text-white",classNames:{day_selected:"bg-[#B90003] text-white hover:bg-[#A00002]",day_range_middle:"bg-[#B90003]/30 text-white",day_range_end:"bg-[#A00002] text-white",day_today:"border-[#B90003] border-2",nav_button:"hover:bg-[#B90003]/20"},modifiersClassNames:{disabled:"calendar-day-disabled-strike"}},`${A}-${$}`),e.jsxs("div",{className:"mt-4 w-full",children:[e.jsx("h3",{className:"text-xl font-bold text-center mb-2",children:y("reservation.pickupTime")}),e.jsx(B,{value:m.pickupTime,onChange:e=>{p(t=>({...t,pickupTime:e})),h(t=>({...t,pickupTime:e}))},onClose:()=>{}})]})]})]}),e.jsxs("div",{className:"w-full max-w-md sm:max-w-full mx-auto mb-2",children:[e.jsx("h3",{className:"text-xl font-bold text-center mb-2",children:y("reservation.extraServices")}),e.jsxs("div",{className:"flex items-center justify-between bg-gray-700 rounded-lg px-4 py-3 mb-2",children:[e.jsx("span",{children:y("reservation.unlimitedMileage")}),e.jsx(l,{checked:!!u.unlimitedMileage,onCheckedChange:e=>h(t=>({...t,unlimitedMileage:!!e}))})]}),u.unlimitedMileage&&e.jsx("div",{className:"bg-[#B90003]/10 border border-[#B90003]/20 rounded-lg px-4 py-2 mb-2",children:e.jsx("p",{className:"text-[#B90003] text-sm text-center",children:y("reservation.unlimitedMileageDesc")})})]}),e.jsxs("div",{className:"w-full max-w-md sm:max-w-full mx-auto mb-2",children:[e.jsx("h3",{className:"text-xl font-bold text-center mb-2",children:y("reservation.pickupType")}),e.jsxs(o,{value:u.pickupType||"office",onValueChange:e=>h(t=>({...t,pickupType:e})),className:"flex flex-col gap-2 bg-gray-700 rounded-lg px-4 py-3 mb-2",children:[e.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[e.jsx("span",{children:y("reservation.pickupOffice")}),e.jsx(l,{checked:"office"===u.pickupType,onCheckedChange:e=>h(t=>({...t,pickupType:e?"office":"airport"}))})]}),e.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[e.jsx("span",{children:y("reservation.pickupAirport")}),e.jsx(l,{checked:"airport"===u.pickupType,onCheckedChange:e=>h(t=>({...t,pickupType:e?"airport":"office"}))})]}),e.jsx("div",{className:"border-t border-[#B90003] my-2"}),e.jsxs("label",{className:"flex flex-col gap-1 cursor-pointer",children:[e.jsx("span",{className:"text-center",children:y("reservation.pickupAddress")}),e.jsx(c,{type:"text",className:"bg-gray-800 rounded px-2 py-1 text-white",placeholder:y("reservation.enterAddress"),value:"address"===u.pickupType&&u.pickupAddress||"",onFocus:()=>h(e=>({...e,pickupType:"address"})),onChange:e=>h(t=>({...t,pickupType:"address",pickupAddress:e.target.value}))})]})]})]}),e.jsx("div",{className:"w-full flex justify-center mb-1",children:e.jsxs("span",{className:"text-sm font-semibold text-[#B90003] bg-black/30 rounded px-3 py-1",children:[y("reservation.step")," ",f]})}),e.jsx(d,{className:"w-full bg-[#B90003] hover:bg-[#A00002] text-white text-lg font-bold py-3 rounded-xl",onClick:v,disabled:!m.pickupDate||!m.returnDate,children:y("reservation.next")}),e.jsx(d,{className:"w-full mt-2 bg-black text-[#B90003] border-[#B90003] border-2 text-lg font-bold py-3 rounded-xl",variant:"outline",onClick:b,children:y("reservation.back")})]})};function A(e,t,a){const r="string"==typeof e?new Date(e):e,s=function(e){switch(e){case"en":return"en-US";case"ro":return"ro-RO";default:return"ru-RU"}}(t);return r.toLocaleDateString(s,{day:"2-digit",month:"long",...a})}const $=({car:t,formData:a,wizardData:r,setWizardData:s,currentStep:n,stepIndicator:i,calculateDays:o,totalPrice:c,discount:m,finalRentalCost:p,goNext:u,goBack:h,i18n:x})=>{const{t:f}=S();return e.jsxs("div",{className:"w-full max-w-md sm:max-w-full mx-auto pb-4",children:[e.jsx("div",{className:"text-2xl font-bold mb-4 text-white text-center",children:f("reservation.confirmTitle")}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-lg font-bold text-[#B90003] mb-1",children:f("reservation.periodTitle")}),e.jsx("div",{className:"bg-zinc-900 rounded-xl px-4 py-3 flex flex-col gap-1 border border-[#B90003]",children:a.pickupDate&&a.returnDate?e.jsx("div",{className:"text-white text-base font-semibold text-center",children:(()=>{const t=(r=a.pickupDate,s=a.returnDate,n=x.language,{start:A(r,n,i),end:A(s,n,i)});var r,s,n,i;return e.jsxs(e.Fragment,{children:[t.start,e.jsx("span",{className:"mx-2 text-[#B90003] font-bold",children:"—"}),t.end,e.jsx("span",{className:"ml-2 text-[#fffffff2] font-bold",children:a.pickupTime})]})})()}):e.jsx("span",{className:"text-zinc-400",children:f("reservation.periodNotSelected")})})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-lg font-bold text-[#B90003] mb-1",children:f("reservation.geoTitle")}),e.jsx("div",{className:"bg-zinc-900 rounded-xl px-4 py-3 text-base text-white border border-[#B90003]",children:"office"!==r.pickupType&&r.pickupType?"airport"===r.pickupType?f("reservation.airportAddress"):r.pickupAddress||f("reservation.enterAddress"):f("reservation.officeAddress")})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-lg font-bold mb-2 text-[#B90003]",children:f("reservation.rulesTitle")}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 bg-zinc-900 rounded-xl p-4 border border-[#B90003]",children:[e.jsxs("div",{className:"flex items-center gap-3 text-white",children:[e.jsx("img",{src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20width='800'%20height='800'%20fill='%23fff'%20viewBox='0%200%20313.725%20313.725'%3e%3cpath%20d='M235.469%2068.574c-4.679%205.328-6.204%2013.161-2.186%2019.269%203.079%204.679%208.408%207.246%2010.905%2012.398%203.438%207.099-.361%2016.396-8.444%2017.923-1.551.294-.145-1.525.14-2.021%201-1.741%201.881-3.605%202.271-5.587.76-3.855-1.115-8.062-3.232-11.215-.819-1.221-1.753-2.328-2.674-3.473-2.601-3.256-4.655-7.004-5.12-11.202-.447-4.053.669-8.114%202.933-11.486a21.3%2021.3%200%200%201%203.327-3.866c.47-.43.955-.848%201.47-1.223.355-.258%201.005.055.61.483M208.689%20113.292c1.737%203.672%203.355%207.585%203.49%2011.699.139%204.244-1.389%208.376-3.278%2012.109-.835%201.649-1.764%203.244-2.729%204.82-.538.879-.402%201.746.84%201.564%203.266-.475%206.501-2.09%209.134-4.025a23.54%2023.54%200%200%200%209.557-20.242c-.447-8.277-5.15-14.85-10.929-20.399-2.333-2.241-4.917-4.198-7.19-6.507-5.913-6.001-9.999-13.627-9.448-22.244.462-7.244%203.879-14.682%208.623-20.135.418-.467.045-1.237-.589-1.186-.277.022-.522.248-.731.405a36%2036%200%200%200-2.602%202.174%2040.2%2040.2%200%200%200-5.223%205.805c-3.303%204.471-5.636%209.686-6.455%2015.205-1.655%2011.151%203.277%2021.555%2010.257%2029.941%202.854%203.431%205.348%206.95%207.273%2011.016'/%3e%3cpath%20d='M156.862%200C70.368%200%200%2070.368%200%20156.862s70.368%20156.862%20156.862%20156.862%20156.862-70.368%20156.862-156.862S243.356%200%20156.862%200M290%20156.862c0%2032.443-11.671%2062.209-31.027%2085.333l-51.03-51.028h10.869a7.087%207.087%200%200%200%207.086-7.086v-23.615a7.087%207.087%200%200%200-7.086-7.086H196.19v26.034l-10.271-10.27V153.38h-15.764L71.526%2054.755c23.124-19.358%2052.891-31.03%2085.336-31.03C230.274%2023.725%20290%2083.45%20290%20156.862m-266.275%200c0-32.443%2011.671-62.209%2031.026-85.332l81.851%2081.85h-64.74a7.087%207.087%200%200%200-7.086%207.086v23.615a7.087%207.087%200%200%200%207.086%207.086h102.529l67.806%2067.804C219.073%20278.328%20189.308%20290%20156.862%20290%2083.45%20290%2023.725%20230.274%2023.725%20156.862'/%3e%3c/svg%3e",alt:"Не курить",className:"w-7 h-7"}),e.jsx("span",{children:f("reservation.ruleNoSmoke")})]}),e.jsxs("div",{className:"flex items-center gap-3 text-white",children:[e.jsx("img",{src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20width='800'%20height='800'%20fill='%23fff'%20stroke='%23fff'%20stroke-width='14.229'%20viewBox='-14.72%20-14.72%20520.11%20520.11'%3e%3cpath%20d='M245.333%200C110.059%200%200%20110.059%200%20245.333s110.059%20245.333%20245.333%20245.333%20245.333-110.059%20245.333-245.333S380.608%200%20245.333%200zm0%20469.333c-123.52%200-224-100.48-224-224%200-57.92%2022.293-110.613%2058.496-150.421L176.917%20192h-59.584c-5.888%200-10.667%204.779-10.667%2010.667s4.779%2010.667%2010.667%2010.667h32V352c0%205.888%204.779%2010.667%2010.667%2010.667s10.667-4.779%2010.667-10.667v-61.12c14.763%203.264%2039.488%207.787%2064%207.787%2021.184%200%2034.219-2.859%2042.091-6.827l21.909%2021.909V352c0%205.888%204.779%2010.667%2010.667%2010.667S320%20357.888%20320%20352v-16.917l75.755%2075.755c-39.808%2036.202-92.502%2058.495-150.422%2058.495zm165.504-73.578-93.952-93.952L94.933%2079.851c39.808-36.203%2092.501-58.496%20150.421-58.496%20123.499-.021%20223.979%20100.459%20223.979%20223.979%200%2057.919-22.293%20110.613-58.496%20150.421z'/%3e%3cpath%20d='m389.483%20172.181-48.149-28.885v-25.963c0-4.949-3.413-9.259-8.213-10.389-4.779-1.152-9.771%201.173-11.989%205.611l-30.869%2061.76c-5.227%2010.453-15.851%2017.173-27.733%2017.515a10.7%2010.7%200%200%200-9.6%206.72%2010.66%2010.66%200%200%200%202.368%2011.477l47.979%2048a10.67%2010.67%200%200%200%207.552%203.115c1.003%200%202.005-.128%202.987-.427a10.66%2010.66%200%200%200%207.424-7.957c1.173-5.333%202.816-9.28%205.163-12.416l18.859-25.131%2024.704%208.235c5.632%201.899%2011.627-1.152%2013.483-6.741l10.667-32a10.68%2010.68%200%200%200-4.633-12.524z'/%3e%3c/svg%3e",alt:"No pets",className:"w-7 h-7"}),e.jsx("span",{children:f("reservation.ruleNoPets")})]}),e.jsxs("div",{className:"flex items-center gap-3 text-white",children:[e.jsx("img",{src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20width='800'%20height='800'%20fill='%23fff'%20viewBox='0%200%20179.006%20179.006'%3e%3cpath%20d='M69.246%2097.982a5.9%205.9%200%200%201-5.901-5.907c0-3.27%205.901-13.61%205.901-13.61s5.901%2010.347%205.901%2013.61a5.9%205.9%200%200%201-5.901%205.907M64.8%2073.894h-6.766v36.076H46.297v5.549h6.826v5.102H0v-5.102h6.832V58.392h39.471v46.47h6.623V71.346l.03-2.56H67.3l3.962%205.09-4.028%203.139zm-27.25-6.659H15.574v16.403H37.55zm72.783%2011.617c.668.871%201.283%201.82%201.784%202.846a16.2%2016.2%200%200%201%201.122%203.168l36.464-21.32zm-17.089.114c-5.812%203.031-8.073%2010.209-5.036%2016.027s10.215%208.079%2016.021%205.048c5.824-3.037%208.085-10.203%205.054-16.033-3.031-5.818-10.209-8.074-16.039-5.042m11.618-63.028h-9.314v24.464h9.314zm-9.309%20147.131h9.314v-24.47h-9.314zm58.989-78.226v9.32h24.464v-9.32zm-23.611-37.436%203.294%203.294%2017.298-17.298-3.3-3.294zm0%2084.192%2017.298%2017.298%203.294-3.294-17.292-17.298zm-56.888%2020.747H86v-4.212H74.043v-5.197h12.894v-4.332H68.929v24.464h18.575v-4.35H74.043zm.567-111.944V30.055h10.716v-4.206H74.61v-5.567h12.304v-4.344H69.508v24.464h5.102'%20style='fill:%23fff'/%3e%3c/svg%3e",alt:"Fuel return",className:"w-7 h-7"}),e.jsx("span",{children:f("reservation.ruleFuel")})]}),e.jsxs("div",{className:"flex items-center gap-3 text-white",children:[e.jsx("img",{src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='800'%20height='800'%20fill='%23fff'%20stroke='%23fff'%20stroke-width='.001'%20viewBox='0%200%2050%2050'%3e%3cpath%20d='M37%2025.955a11.022%2011.022%200%201%200%2011%2011.023%2011.024%2011.024%200%200%200-11-11.023Zm4.707%2014.322a1%201%200%200%201-1.414%201.417L37%2038.394l-3.293%203.3a1.016%201.016%200%200%201-1.414%200%201.003%201.003%200%200%201%200-1.417l3.293-3.3-3.293-3.299a1%201%200%200%201%201.414-1.417l3.293%203.3%203.293-3.3a1%201%200%200%201%201.414%201.417l-3.293%203.3ZM42%2015.935a4%204%200%200%201%20.05-.49%2020%2020%200%200%200%203.27-.904%201.98%201.98%200%200%201%201.822.233A2%202%200%200%201%2048%2016.42v2.967a3.95%203.95%200%200%201-2%20.557%204.01%204.01%200%200%201-4-4.008Zm-38.012-2.49c.54-.2%201.08-.37%201.62-.523A3.993%203.993%200%200%201%203%2019.943a4%204%200%200%201-1-.142v-3.52a3.04%203.04%200%200%201%201.988-2.836ZM8%2043.992a4%204%200%200%201-.05.498%2020%2020%200%200%200-3.268.896%201.99%201.99%200%200%201-1.826-.235A2%202%200%200%201%202%2043.508v-2.967a3.95%203.95%200%200%201%202-.557%204.01%204.01%200%200%201%204%204.008Zm17-22.045a8.014%208.014%200%200%200-.947%2015.971c-.023-.312-.053-.622-.053-.94a13.03%2013.03%200%200%201%207.445-11.76A8.03%208.03%200%200%200%2025%2021.948Zm0%204.008a4.01%204.01%200%200%200-4%204.008%201%201%200%201%201-2%200%206.013%206.013%200%200%201%206-6.012%201.002%201.002%200%200%201%200%202.004ZM8%205.345v-1.23A2.02%202.02%200%200%201%209.806%202.11c5.19-.482%2010.388.691%2015.413%201.824C30.028%205.02%2035%206.14%2039.815%205.736A2.016%202.016%200%200%201%2042%207.726v.67c-9.82%201.915-19.636-3.517-29.698-3.383A27.5%2027.5%200%200%200%208%205.345Zm-3%205.528V9.624a2%202%200%200%201%201.526-1.955c6.309-1.515%2012.604-.097%2018.693%201.276%205.995%201.352%2011.658%202.629%2017.38%201.377%201.322-.323%203.662%201.815%202.401%202.237a20.7%2020.7%200%200%201-3.904%201.061C30.004%2015.032%2018.82%208.268%207.498%2010.43Zm41%2011.074a6.013%206.013%200%200%201-6-6.012c0-.067.008-.133.01-.2-4.84.457-9.712-.634-14.79-1.78-5.674-1.278-11.505-2.59-17.374-1.55A5.98%205.98%200%200%201%209%2015.934a6.013%206.013%200%200%201-6%206.012%206%206%200%200%201-1-.09V38.33a6%206%200%200%201%202-.35%206.013%206.013%200%200%201%206%206.012c0%20.072-.008.141-.01.212%204.82-.44%209.673.667%2014.73%201.828%201.276.292%202.566.586%203.865.856a13.06%2013.06%200%200%201-4.238-6.937%2010.014%2010.014%200%201%201%209.016-15.471A12.914%2012.914%200%200%201%2048%2030.067v-8.47a6%206%200%200%201-2%20.35Zm-35%209.019H9a1.002%201.002%200%200%201%200-2.005h2a1.002%201.002%200%200%201%200%202.005Z'/%3e%3c/svg%3e",alt:"No deposit",className:"w-7 h-7"}),e.jsx("span",{children:f("reservation.ruleNoDeposit")})]}),e.jsxs("div",{className:"flex items-center gap-3 text-white",children:[e.jsx("img",{src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20width='800'%20height='800'%20fill='%23fff'%20viewBox='0%200%20100%20100'%3e%3cpath%20d='M50%2019C25.1%2019%204.9%2038.5%204%2063.4%204%2064.8%205.2%2066%206.6%2066c1.2%200%202.2-.8%202.6-2%204-14.2%2017-24%2031.8-24%206.9%200%2013.5%202.1%2019.1%206.1l-17.6%2017c-.5%200-1-.1-1.5-.1-5%200-9%204-9%209s4%209%209%209%209-4%209-9c0-.5-.1-1-.1-1.5l14-21.3c4.2%204.1%207.3%209.2%208.9%2014.8.3%201.2%201.4%202%202.6%202h18c.7%200%201.4-.3%201.9-.8s.8-1.2.7-1.9C95%2038.5%2074.8%2019%2050%2019m17.9%205.8L55.4%2041.1c-4.2-1.9-8.7-3-13.4-3.1V21.7c2.6-.5%205.2-.7%208-.7%206.4%200%2012.4%201.4%2017.9%203.8m-40%2015.8-4.8-10.5c4.9-3.8%2010.6-6.5%2016.9-7.9V38c-4.2.1-8.3%201-12.1%202.6M7.3%2063.5c-.1.3-.4.5-.7.5s-.6-.3-.6-.6c.2-6.1%201.7-11.9%204.1-17.1l4.9%203.3c-3.5%203.9-6.2%208.6-7.7%2013.9m9.1-15.4L11%2044.5c2.6-5%206.2-9.5%2010.5-13.1l4.5%2010c-3.5%201.6-6.8%203.9-9.6%206.7M41%2079c-3.9%200-7-3.1-7-7s3.1-7%207-7%207%203.1%207%207-3.1%207-7%207m3.7-15.2%2019.6-18.9-1.4%202.1c-.1.1-.1.2-.1.2L49.1%2068.1c-.9-1.9-2.5-3.5-4.4-4.3m20.2-16.3%205.9-9c.3-.4.2-1-.2-1.3s-1-.3-1.3%200l-7.7%207.4c-1.4-1-2.8-1.9-4.3-2.7l12.5-16.3c7.1%203.6%2013.1%209%2017.4%2015.6L67.7%2050l-.1.1c-.9-.9-1.8-1.7-2.7-2.6m28.9%2016.3c-.1.1-.3.2-.5.2h-18c-.3%200-.5-.2-.6-.5-1.2-4.3-3.2-8.2-5.9-11.7L88.2%2043c3.4%206%205.5%2012.9%205.8%2020.3-.1.3-.2.4-.2.5'/%3e%3c/svg%3e",alt:"Speed limit",className:"w-7 h-7"}),e.jsx("span",{children:f("reservation.ruleSpeed")})]}),e.jsxs("div",{className:"flex items-center gap-3 text-white",children:[e.jsx("img",{src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='800'%20height='800'%20fill='%23fff'%20viewBox='0%200%2024%2024'%3e%3cpath%20fill='%23fff'%20fill-rule='nonzero'%20d='M13.5%204a8.5%208.5%200%201%201-4.822%2015.5H1.752a.75.75%200%200%201-.102-1.493L1.752%2018l5.268.001a8.5%208.5%200%200%201-1.022-1.5l-2.25-.001a.75.75%200%200%201-.103-1.493L3.747%2015l1.627.001A8.5%208.5%200%200%201%205%2012.5c0-2.098.76-4.018%202.02-5.5H2.75a.75.75%200%200%201-.102-1.493L2.75%205.5h5.927A8.46%208.46%200%200%201%2013.5%204m0%201.5a7%207%200%201%200%200%2014%207%207%200%200%200%200-14m.003%201.502a5.501%205.501%200%201%201%200%2011.003%205.501%205.501%200%200%201%200-11.003m1.151%207.714c-.345.18-.738.282-1.154.282-.412%200-.8-.1-1.143-.276l-1.096%201.096c.64.433%201.411.687%202.242.687.834%200%201.608-.255%202.249-.691zm-5.152-2.213c0%20.836.256%201.613.695%202.255l1.093-1.092A2.5%202.5%200%200%201%2011%2012.5c0-.417.103-.81.283-1.155l-1.09-1.09a4%204%200%200%200-.691%202.25m7.316-2.242-1.095%201.095c.176.342.276.731.276%201.143%200%20.417-.102.81-.282%201.156l1.097%201.097c.436-.641.69-1.415.69-2.249%200-.83-.253-1.603-.686-2.242M13.5%2011.5a1%201%200%201%200%200%201.998%201%201%200%200%200%200-1.998m.003-2.998c-.834%200-1.608.255-2.25.691l1.09%201.09c.346-.18.74-.283%201.157-.283.421%200%20.818.104%201.166.288l1.092-1.091a4%204%200%200%200-2.255-.695'/%3e%3c/svg%3e",alt:"No aggressive driving",className:"w-7 h-7"}),e.jsx("span",{children:f("reservation.ruleNoAggressive")})]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-xl font-bold text-center mb-2 text-[#B90003]",children:f("reservation.clientCardTitle")}),e.jsxs("div",{className:"flex flex-col gap-2 bg-zinc-900 rounded-xl p-4 border border-[#B90003]",children:[e.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[e.jsx("span",{children:f("reservation.goldCard")}),e.jsx(l,{checked:r.goldCard,onCheckedChange:e=>s(t=>({...t,goldCard:e,clubCard:!e&&t.clubCard}))})]}),e.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[e.jsx("span",{children:f("reservation.clubCard")}),e.jsx(l,{checked:r.clubCard,onCheckedChange:e=>s(t=>({...t,clubCard:e,goldCard:!e&&t.goldCard}))})]})]})]}),e.jsxs("div",{className:"mb-0",children:[e.jsx("div",{className:"text-lg font-bold text-[#B90003] mb-2",children:f("reservation.costTitle")}),e.jsxs("div",{className:"bg-zinc-900 rounded-xl p-4 flex flex-col gap-2 text-white border border-[#B90003]",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:f("reservation.duration")})," ",e.jsxs("span",{children:[o()," ",f("reservation.days")]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:f("reservation.wash")})," ",e.jsx("span",{children:"20 €"})]}),r.unlimitedMileage&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:f("reservation.unlimitedMileageCost")})," ",e.jsxs("span",{children:[20*o()," €"]})]}),("address"===r.pickupType||"airport"===r.pickupType)&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:f("reservation.delivery")})," ",e.jsx("span",{children:"20 €"})]}),e.jsxs("div",{className:"flex justify-between font-bold text-lg",children:[e.jsx("span",{children:f("reservation.rentCost")})," ",e.jsxs("span",{children:[c-m," €"]})]}),e.jsx("div",{className:"border-t border-[#B90003]/30 my-2"}),e.jsxs("div",{className:"flex justify-between font-bold text-xl text-[#B90003]",children:[e.jsx("span",{children:f("reservation.totalAmount")})," ",e.jsxs("span",{children:[p," €"]})]})]})]}),e.jsx("div",{className:"w-full flex justify-center mb-2 mt-2",children:e.jsxs("span",{className:"text-sm font-semibold text-[#B90003] bg-black/30 rounded px-3 py-1",children:[f("reservation.step")," ",i]})}),e.jsx(d,{className:"w-full bg-[#B90003] hover:bg-[#A00002] text-white text-lg font-bold py-3 rounded-xl",onClick:u,children:f("reservation.next")}),e.jsx(d,{className:"w-full mt-2 bg-black text-[#B90003] border-[#B90003] border-2 text-lg font-bold py-3 rounded-xl",variant:"outline",onClick:h,children:f("reservation.back")})]})},I=({name:t,accept:a="image/*",required:r=!1,onChange:s,className:n,children:i})=>e.jsxs("div",{className:m("relative",n),children:[e.jsx("input",{type:"file",name:t,accept:a,required:r,onChange:s,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10"}),e.jsx("div",{className:"pointer-events-none",children:i})]}),R=""+new URL("front-uO_TmE2q.png",import.meta.url).href,L=""+new URL("back-CVoMtcNb.png",import.meta.url).href,P=e=>{if(!e)return"";const t=e.replace(/\D/g,"");return 0===t.length?"":1===t.length?t:t.length<=3?`0(${t.slice(1)}`:t.length<=9?`0(${t.slice(1,3)})${t.slice(3)}`:`0(${t.slice(1,3)})${t.slice(3,9)}`},F=({car:t,formData:a,setFormData:r,uploadedPhotos:s,setUploadedPhotos:n,privacyAccepted:i,setPrivacyAccepted:m,selectedCountryCode:v,setSelectedCountryCode:b,currentStep:j,stepIndicator:y,finalRentalCost:w,isSubmitting:N,handleSubmit:k,goBack:C})=>{var D;const{t:M}=S(),B=e=>{try{r(t=>({...t,[e.target.name]:e.target.value}))}catch(a){try{const e=t.id;localStorage.removeItem(`reservation-form-${e}`),localStorage.removeItem(`reservation-step-${e}`)}catch(s){}}},z=[{code:"+373",name:"Moldova",flag:"🇲🇩"},{code:"+1",name:"USA/Canada",flag:"🇺🇸"},{code:"+7",name:"Russia",flag:"🇷🇺"},{code:"+40",name:"Romania",flag:"🇷🇴"},{code:"+380",name:"Ukraine",flag:"🇺🇦"},{code:"+49",name:"Germany",flag:"🇩🇪"},{code:"+33",name:"France",flag:"🇫🇷"},{code:"+39",name:"Italy",flag:"🇮🇹"},{code:"+34",name:"Spain",flag:"🇪🇸"},{code:"+44",name:"UK",flag:"🇬🇧"},{code:"+48",name:"Poland",flag:"🇵🇱"},{code:"+31",name:"Netherlands",flag:"🇳🇱"},{code:"+41",name:"Switzerland",flag:"🇨🇭"},{code:"+43",name:"Austria",flag:"🇦🇹"},{code:"+32",name:"Belgium",flag:"🇧🇪"},{code:"+420",name:"Czech Republic",flag:"🇨🇿"},{code:"+36",name:"Hungary",flag:"🇭🇺"},{code:"+90",name:"Turkey",flag:"🇹🇷"},{code:"+972",name:"Israel",flag:"🇮🇱"},{code:"+86",name:"China",flag:"🇨🇳"},{code:"+81",name:"Japan",flag:"🇯🇵"},{code:"+82",name:"South Korea",flag:"🇰🇷"},{code:"+91",name:"India",flag:"🇮🇳"},{code:"+61",name:"Australia",flag:"🇦🇺"},{code:"+64",name:"New Zealand",flag:"🇳🇿"}];return e.jsxs("form",{className:"w-full max-w-md sm:max-w-full mx-auto flex flex-col gap-1 pb-4",onSubmit:k,encType:"multipart/form-data",children:[e.jsx("div",{className:"text-2xl font-bold mb-4 text-white text-center",children:M("reservation.step3Title")}),e.jsxs("div",{className:"flex justify-between items-center border-b border-[#B90003] pb-2 mb-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-[#B90003]",children:M("reservation.total")}),e.jsx("div",{className:"text-sm text-gray-300",children:M("reservation.totalCost")})]}),e.jsxs("div",{className:"text-2xl font-bold text-white",children:[w," €"]})]}),e.jsxs("div",{className:"w-full max-w-md sm:max-w-full mx-auto mb-2",children:[e.jsx("h3",{className:"text-xl font-bold text-center mb-2",children:M("reservation.paymentMethod")}),e.jsxs(o,{value:a.paymentMethod||"cash",onValueChange:e=>{try{r(t=>({...t,paymentMethod:e}))}catch(a){try{const e=t.id;localStorage.removeItem(`reservation-form-${e}`),localStorage.removeItem(`reservation-step-${e}`)}catch(s){}}},className:"flex flex-col gap-2 bg-gray-700 rounded-lg px-4 py-3 mb-2",children:[e.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[e.jsx("span",{children:M("reservation.cash")}),e.jsx(l,{checked:"cash"===a.paymentMethod,onCheckedChange:e=>r(t=>({...t,paymentMethod:e?"cash":"card"}))})]}),e.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[e.jsx("span",{children:M("reservation.card")}),e.jsx(l,{checked:"card"===a.paymentMethod,onCheckedChange:e=>r(t=>({...t,paymentMethod:e?"card":"cash"}))})]}),e.jsx("div",{className:"border-t border-[#B90003] my-2"}),e.jsxs("label",{className:"flex flex-col gap-1 cursor-pointer",children:[e.jsx("span",{className:"text-center",children:M("reservation.other")}),e.jsx(c,{type:"text",className:"bg-gray-800 rounded px-2 py-1 text-white",placeholder:M("reservation.other"),value:"other"===a.paymentMethod&&a.paymentOther||"",onFocus:()=>r(e=>({...e,paymentMethod:"other"})),onChange:e=>r(t=>({...t,paymentMethod:"other",paymentOther:e.target.value}))})]})]})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"firstName",className:"text-[#B90003] font-bold",children:M("reservation.firstName")}),e.jsx(c,{id:"firstName",name:"firstName",placeholder:M("reservation.firstName"),className:"bg-zinc-800 text-white border-none mt-1",value:a.firstName,onChange:B,required:!0})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"lastName",className:"text-[#B90003] font-bold",children:M("reservation.lastName")}),e.jsx(c,{id:"lastName",name:"lastName",placeholder:M("reservation.lastName"),className:"bg-zinc-800 text-white border-none mt-1",value:a.lastName,onChange:B,required:!0})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"email",className:"text-[#B90003] font-bold",children:M("reservation.email")}),e.jsx(c,{id:"email",name:"email",type:"email",placeholder:M("reservation.email"),className:"bg-zinc-800 text-white border-none mt-1",value:a.email,onChange:B,required:!0})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"idnp",className:"text-[#B90003] font-bold",children:M("reservation.idnp")}),e.jsx(c,{id:"idnp",name:"idnp",placeholder:"1234567890123",className:"bg-zinc-800 text-white border-none mt-1",value:a.idnp||"",onChange:e=>{const t=e.target.value.replace(/\D/g,"").slice(0,13);r(e=>({...e,idnp:t}))},maxLength:13,pattern:"[0-9]{13}",required:!0})]}),e.jsxs("div",{children:[e.jsx(p,{className:"text-[#B90003] font-bold",children:M("reservation.idPhotos")}),e.jsxs("div",{className:"flex gap-4 mt-2",children:[e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsxs(I,{name:"idPhotoFront",accept:"image/*",required:!0,onChange:e=>{e.target.files&&e.target.files[0]&&n(e=>({...e,front:!0}))},className:"flex flex-col items-center justify-center w-28 h-28 bg-zinc-900 border-2 border-dashed rounded-lg cursor-pointer hover:bg-zinc-800 transition group "+(s.front?"border-green-400":"border-[#ffffff]"),children:[s.front?e.jsxs("span",{className:"flex flex-col items-center justify-center z-0",children:[e.jsx("svg",{width:"36",height:"36",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",className:"text-green-400 mb-1",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),e.jsx("span",{className:"text-xs text-green-400",children:M("reservation.uploaded")})]}):e.jsxs("span",{className:"flex flex-col items-center justify-center z-0",children:[e.jsx("svg",{width:"36",height:"36",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",className:"text-gray-400 mb-1",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),e.jsx("span",{className:"text-xs text-gray-400",children:M("reservation.upload")})]}),e.jsx("img",{src:R,alt:M("reservation.frontExample"),className:"absolute bottom-1 left-1 w-16 h-12 object-cover rounded shadow border border-gray-700 bg-black"})]}),e.jsx("span",{className:"text-xs text-gray-400 mt-1",children:M("reservation.frontExample")})]}),e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsxs(I,{name:"idPhotoBack",accept:"image/*",required:!0,onChange:e=>{e.target.files&&e.target.files[0]&&n(e=>({...e,back:!0}))},className:"flex flex-col items-center justify-center w-28 h-28 bg-zinc-900 border-2 border-dashed rounded-lg cursor-pointer hover:bg-zinc-800 transition group "+(s.back?"border-green-400":"border-[#ffffff]"),children:[s.back?e.jsxs("span",{className:"flex flex-col items-center justify-center z-0",children:[e.jsx("svg",{width:"36",height:"36",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",className:"text-green-400 mb-1",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),e.jsx("span",{className:"text-xs text-green-400",children:M("reservation.uploaded")})]}):e.jsxs("span",{className:"flex flex-col items-center justify-center z-0",children:[e.jsx("svg",{width:"36",height:"36",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",className:"text-gray-400 mb-1",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),e.jsx("span",{className:"text-xs text-gray-400",children:M("reservation.upload")})]}),e.jsx("img",{src:L,alt:M("reservation.backExample"),className:"absolute bottom-1 left-1 w-16 h-12 object-cover rounded shadow border border-gray-700 bg-black"})]}),e.jsx("span",{className:"text-xs text-gray-400 mt-1",children:M("reservation.backExample")})]})]})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"phone",className:"text-[#B90003] font-bold",children:M("reservation.phone")}),e.jsxs("div",{className:"flex flex-col gap-2 mt-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(u,{value:v,onValueChange:b,children:[e.jsx(h,{className:"w-40 bg-zinc-800 text-white border-none hover:bg-zinc-700",children:e.jsx(x,{children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:null==(D=z.find(e=>e.code===v))?void 0:D.flag}),e.jsx("span",{children:v})]})})}),e.jsx(f,{className:"bg-zinc-800 border-zinc-700 z-[3001] max-h-60",children:z.map(t=>e.jsx(g,{value:t.code,className:"text-white hover:bg-zinc-700 focus:bg-zinc-700 cursor-pointer",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:t.flag}),e.jsx("span",{children:t.code}),e.jsx("span",{className:"text-gray-400 text-sm",children:t.name})]})},t.code))})]}),e.jsx(c,{id:"phone",name:"phone",type:"tel",placeholder:"0(XX)XXXXXX",className:"bg-zinc-800 text-white border-none flex-1 "+(9===a.phone.replace(/\D/g,"").length?"border-green-500 border-2":a.phone.replace(/\D/g,"").length>0?"border-yellow-500 border-2":""),value:P(a.phone.replace(new RegExp(`^\\${v}`),"")),onChange:e=>{const t=e.target.value.replace(/\D/g,"").slice(0,9);r(e=>({...e,phone:v+t}))},maxLength:13,required:!0})]}),e.jsx("div",{className:"text-xs text-gray-400",children:(()=>{const t=a.phone.replace(/\D/g,"").replace(v.replace(/\D/g,""),"").length;return 9===t?e.jsx("span",{className:"text-green-400",children:M("reservation.phoneValid")}):t>0?e.jsx("span",{className:"text-yellow-400",children:M("reservation.phoneIncomplete",{count:9-t})}):e.jsx("span",{className:"text-gray-400",children:M("reservation.phoneFormat")})})()})]})]}),e.jsxs("div",{className:"flex items-start gap-2 mt-2",children:[e.jsx(l,{id:"privacy",checked:i,onCheckedChange:e=>m(!!e),required:!0,className:"mt-1"}),e.jsxs("label",{htmlFor:"privacy",className:"text-white text-sm select-none",children:[M("reservation.privacyPolicy")," ",e.jsx("a",{href:"/privacy-policy.pdf",target:"_blank",rel:"noopener noreferrer",className:"text-[#B90003] underline ml-1",children:M("reservation.privacyPolicyLink")}),"."]}),!i&&e.jsx("div",{className:"text-red-400 text-xs mt-1",children:M("reservation.privacyRequired","Необходимо согласие для отправки заявки")})]}),e.jsx("div",{className:"w-full flex justify-center mb-2 mt-2",children:e.jsxs("span",{className:"text-sm font-semibold text-[#B90003] bg-black/30 rounded px-3 py-1",children:[M("reservation.step")," ",y]})}),e.jsx(d,{className:"w-full bg-[#B90003] hover:bg-[#A00002] disabled:bg-gray-400 disabled:cursor-not-allowed text-white text-lg font-bold py-3 rounded-xl",type:"submit",disabled:N,children:N?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-black border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:M("reservation.submitting")})]}):M("reservation.book")}),e.jsx(d,{className:"w-full mt-2 bg-black text-[#B90003] border-[#B90003] border-2 text-lg font-bold py-3 rounded-xl disabled:opacity-50 disabled:cursor-not-allowed",variant:"outline",onClick:C,disabled:N,children:M("reservation.back")})]})},O=({isOpen:t,onClose:a,car:r})=>{const{t:s}=S();return e.jsx(v,{open:t,onOpenChange:()=>{},children:e.jsxs(b,{className:"max-w-md mx-auto bg-gradient-to-br from-zinc-900 to-black border-2 border-[#B90003] shadow-2xl shadow-[#B90003]/20",style:{zIndex:4e3},children:[e.jsx(j,{className:"sr-only",children:s("reservation.successTitle","Заявка отправлена!")}),e.jsx(y,{className:"sr-only",children:s("reservation.successDescription","Ваша заявка на аренду автомобиля была успешно отправлена. Мы свяжемся с вами в ближайшее время.")}),e.jsxs("div",{className:"text-center p-6",children:[e.jsx("div",{className:"mx-auto mb-6 w-20 h-20 bg-gradient-to-br from-[#B90003] to-[#A00002] rounded-full flex items-center justify-center shadow-lg shadow-[#B90003]/30 animate-pulse",children:e.jsx("svg",{className:"w-10 h-10 text-black",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M5 13l4 4L19 7"})})}),e.jsxs("h2",{className:"text-3xl font-bold text-white mb-4",children:["🚗 ",s("reservation.successTitle","Заявка отправлена!")]}),e.jsxs("div",{className:"bg-zinc-800/50 rounded-xl p-4 mb-4 border border-[#B90003]/30",children:[e.jsx("p",{className:"text-white mb-2 text-base leading-relaxed",children:s("reservation.successMessage","Ваша заявка на аренду")}),e.jsx("div",{className:"text-2xl font-bold text-[#B90003] mb-2",children:r.name}),e.jsx("p",{className:"text-white text-base",children:s("reservation.successMessageEnd","успешно отправлена!")})]}),e.jsx("div",{className:"bg-[#B90003]/10 rounded-lg p-3 mb-6 border border-[#B90003]/20",children:e.jsxs("p",{className:"text-[#B90003] text-sm leading-relaxed",children:["📞"," ",s("reservation.contactSoon","Мы свяжемся с вами в ближайшее время для подтверждения бронирования.")]})}),e.jsxs(d,{onClick:()=>{Object.keys(localStorage).filter(e=>e.includes("reservation-form-")||e.includes("reservation-step-")||e.includes("uploaded-photos-")||e.includes("privacy-accepted-")||e.includes("wizard-data-")||e.includes("selected-country-code-")||e.includes("active-image-index-")).forEach(e=>{localStorage.removeItem(e)}),"serviceWorker"in navigator&&"caches"in window&&caches.keys().then(e=>{e.forEach(e=>{e.includes("dynamic")&&caches.delete(e)})}),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{var t;null==(t=e.active)||t.postMessage({type:"CLEAR_CACHE"})}),a()},className:"w-full bg-[#B90003] hover:bg-[#A00002] text-white font-bold text-lg py-4 rounded-xl shadow-lg shadow-[#B90003]/30 transform transition hover:scale-105 glow-effect",children:["✓ ",s("reservation.okButton","Понятно, спасибо!")]}),e.jsx("div",{className:"absolute top-4 left-4 w-3 h-3 bg-[#B90003]/30 rounded-full animate-ping"}),e.jsx("div",{className:"absolute top-6 right-6 w-2 h-2 bg-[#B90003]/50 rounded-full animate-pulse"}),e.jsx("div",{className:"absolute bottom-8 left-6 w-2 h-2 bg-[#B90003]/40 rounded-full animate-bounce"})]})]})})};function q(e){const[a,r]=t.useState({firstName:"",lastName:"",email:"",phone:"",pickupDate:"",returnDate:"",pickupTime:"10:00",returnTime:"",message:"",pickupType:"office",idnp:"",pickupAddress:"",unlimitedMileage:!1,goldCard:!1,clubCard:!1,paymentMethod:"cash",paymentOther:""}),[s,n]=t.useState(0),[i,l]=t.useState({front:!1,back:!1}),[o,c]=t.useState(!1),[d,m]=t.useState("+373"),[p,u]=t.useState(0),[h,x]=t.useState({pickupDate:"",returnDate:"",pickupTime:"10:00",pickupType:"office",pickupAddress:"",unlimitedMileage:!1,goldCard:!1,clubCard:!1});t.useEffect(()=>{if(e)try{const t=localStorage.getItem(`reservation-form-${e}`),a=localStorage.getItem(`reservation-step-${e}`),s=localStorage.getItem(`uploaded-photos-${e}`),i=localStorage.getItem(`privacy-accepted-${e}`),o=localStorage.getItem(`wizard-data-${e}`),d=localStorage.getItem(`selected-country-code-${e}`),p=localStorage.getItem(`active-image-index-${e}`);t&&r(JSON.parse(t)),a&&n(JSON.parse(a)),s&&l(JSON.parse(s)),i&&c(JSON.parse(i)),o&&x(JSON.parse(o)),d&&m(JSON.parse(d)),p&&u(JSON.parse(p))}catch(t){}},[e]);return{formData:a,setFormData:t=>{const s="function"==typeof t?t(a):t;r(s),((t,a)=>{if(e)try{localStorage.setItem(`reservation-form-${e}`,JSON.stringify(a))}catch(r){}})(0,s)},currentStep:s,setCurrentStep:t=>{const a="function"==typeof t?t(s):t;n(a),(t=>{if(e)try{localStorage.setItem(`reservation-step-${e}`,JSON.stringify(t))}catch(a){}})(a)},uploadedPhotos:i,setUploadedPhotos:t=>{const a="function"==typeof t?t(i):t;l(a),(t=>{if(e)try{localStorage.setItem(`uploaded-photos-${e}`,JSON.stringify(t))}catch(a){}})(a)},privacyAccepted:o,setPrivacyAccepted:t=>{const a="function"==typeof t?t(o):t;c(a),(t=>{if(e)try{localStorage.setItem(`privacy-accepted-${e}`,JSON.stringify(t))}catch(a){}})(a)},wizardData:h,setWizardData:t=>{const a="function"==typeof t?t(h):t;x(a),(t=>{if(e)try{localStorage.setItem(`wizard-data-${e}`,JSON.stringify(t))}catch(a){}})(a)},selectedCountryCode:d,setSelectedCountryCode:t=>{const a="function"==typeof t?t(d):t;m(a),(t=>{if(e)try{localStorage.setItem(`selected-country-code-${e}`,JSON.stringify(t))}catch(a){}})(a)},activeImageIndex:p,setActiveImageIndex:t=>{const a="function"==typeof t?t(p):t;u(a),(t=>{if(e)try{localStorage.setItem(`active-image-index-${e}`,JSON.stringify(t))}catch(a){}})(a)},clearCarCache:()=>{if(!e)return;[`reservation-form-${e}`,`reservation-step-${e}`,`uploaded-photos-${e}`,`privacy-accepted-${e}`,`wizard-data-${e}`,`selected-country-code-${e}`,`active-image-index-${e}`].forEach(e=>{localStorage.removeItem(e)}),r({firstName:"",lastName:"",email:"",phone:"",pickupDate:"",returnDate:"",pickupTime:"10:00",returnTime:"",message:"",pickupType:"office",idnp:"",pickupAddress:"",unlimitedMileage:!1,goldCard:!1,clubCard:!1,paymentMethod:"cash",paymentOther:""}),n(0),l({front:!1,back:!1}),c(!1),m("+373"),u(0),x({pickupDate:"",returnDate:"",pickupTime:"10:00",pickupType:"office",pickupAddress:"",unlimitedMileage:!1,goldCard:!1,clubCard:!1})},clearAllCarCaches:()=>{Object.keys(localStorage).filter(e=>e.includes("reservation-form-")||e.includes("reservation-step-")||e.includes("uploaded-photos-")||e.includes("privacy-accepted-")||e.includes("wizard-data-")||e.includes("selected-country-code-")||e.includes("active-image-index-")).forEach(e=>{localStorage.removeItem(e)})}}}const W=["main","summary","personal"],E=({isOpen:a,onClose:r,car:s})=>{const{t:n,i18n:l}=S(),o=w("(max-width: 767px)"),{formData:c,setFormData:d,currentStep:m,setCurrentStep:p,uploadedPhotos:u,setUploadedPhotos:h,privacyAccepted:x,setPrivacyAccepted:f,wizardData:g,setWizardData:B,selectedCountryCode:z,setSelectedCountryCode:A,clearCarCache:I}=q(s.id),[R,L]=t.useState(!1),[P,E]=t.useState(!1),H=`${m+1}/${W.length}`,Y=()=>{if(c.pickupDate&&c.returnDate){const e=new Date(c.pickupDate),t=new Date(c.returnDate);if(isNaN(e.getTime())||isNaN(t.getTime()))return 1;if(t<=e)return 1;const a=Math.abs(t.getTime()-e.getTime());return Math.ceil(a/864e5)}return 1},_=Y();var X;const V=((X=_)>=30?s.price30plus:X>=21?s.price21to29:X>=11?s.price11to20:X>=2?s.price2to10:s.pricePerDay)*_,J=(U=V,g.goldCard?.25*U:g.clubCard?.1*U:0);var U;const Z=V-J+((g.unlimitedMileage?20*Y():0)+("address"===g.pickupType||"airport"===g.pickupType?20:0))+20,K=()=>{(e=>{var t;switch(e){case 0:{if(!c.pickupDate)return i({title:n("validation.error","Ошибка валидации"),description:n("validation.pickupDateRequired","Выберите дату выдачи"),variant:"destructive"}),!1;if(!c.returnDate)return i({title:n("validation.error","Ошибка валидации"),description:n("validation.returnDateRequired","Выберите дату возврата"),variant:"destructive"}),!1;if(!c.pickupTime)return i({title:n("validation.error","Ошибка валидации"),description:n("validation.pickupTimeRequired","Выберите время выдачи"),variant:"destructive"}),!1;const e=new Date(c.pickupDate);return new Date(c.returnDate)<=e?(i({title:n("validation.error","Ошибка валидации"),description:n("validation.invalidDateRange","Дата возврата должна быть позже даты выдачи"),variant:"destructive"}),!1):!("address"===g.pickupType&&!(null==(t=g.pickupAddress)?void 0:t.trim())&&(i({title:n("validation.error","Ошибка валидации"),description:n("validation.addressRequired","Введите адрес доставки"),variant:"destructive"}),1))}case 1:default:return!0;case 2:return c.firstName.trim()?c.lastName.trim()?c.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(c.email)?c.phone.trim()?9!==c.phone.replace(/\D/g,"").replace(z.replace(/\D/g,""),"").length?(i({title:n("validation.error","Ошибка валидации"),description:n("validation.phoneInvalid","Номер телефона должен содержать ровно 9 цифр (0 + код оператора + номер)"),variant:"destructive"}),!1):c.idnp.trim()?13!==c.idnp.replace(/\D/g,"").length?(i({title:n("validation.error","Ошибка валидации"),description:n("validation.idnpInvalid","IDNP должен содержать ровно 13 цифр"),variant:"destructive"}),!1):u.front?u.back?!!x||(i({title:n("validation.error","Ошибка валидации"),description:n("validation.privacyRequired","Необходимо согласие на обработку персональных данных"),variant:"destructive"}),!1):(i({title:n("validation.error","Ошибка валидации"),description:n("validation.backPhotoRequired","Загрузите фото обратной стороны документа"),variant:"destructive"}),!1):(i({title:n("validation.error","Ошибка валидации"),description:n("validation.frontPhotoRequired","Загрузите фото лицевой стороны документа"),variant:"destructive"}),!1):(i({title:n("validation.error","Ошибка валидации"),description:n("validation.idnpRequired","Введите IDNP"),variant:"destructive"}),!1):(i({title:n("validation.error","Ошибка валидации"),description:n("validation.phoneRequired","Введите номер телефона"),variant:"destructive"}),!1):(i({title:n("validation.error","Ошибка валидации"),description:n("validation.emailInvalid","Введите корректный email"),variant:"destructive"}),!1):(i({title:n("validation.error","Ошибка валидации"),description:n("validation.emailRequired","Введите email"),variant:"destructive"}),!1):(i({title:n("validation.error","Ошибка валидации"),description:n("validation.lastNameRequired","Введите фамилию"),variant:"destructive"}),!1):(i({title:n("validation.error","Ошибка валидации"),description:n("validation.firstNameRequired","Введите имя"),variant:"destructive"}),!1)}})(m)&&(d(e=>({...e,pickupDate:g.pickupDate||"",returnDate:g.returnDate||"",pickupTime:g.pickupTime||"10:00",pickupType:g.pickupType||"office",pickupAddress:g.pickupAddress||"",unlimitedMileage:g.unlimitedMileage||!1,goldCard:g.goldCard||!1,clubCard:g.clubCard||!1})),p(e=>{const t=Math.min(e+1,W.length-1);return 1===t&&setTimeout(()=>{const e=document.querySelector('.DialogContent, .dialog-content, [role="dialog"]');e?e.scrollTo({top:0,behavior:"smooth"}):window.scrollTo({top:0,behavior:"smooth"})},50),2===t&&setTimeout(()=>{const e=document.querySelector('.DialogContent, .dialog-content, [role="dialog"]');e?e.scrollTo({top:0,behavior:"smooth"}):window.scrollTo({top:0,behavior:"smooth"})},50),t}))},G=()=>p(e=>Math.max(e-1,0));t.useEffect(()=>{a||(p(0),L(!1),f(!1),h({front:!1,back:!1}),E(!1))},[a]);const{data:Q=[]}=D({queryKey:["orders"],queryFn:C,staleTime:6e5}),ee=Q.filter(e=>{const t=e.carIds&&e.carIds.includes(s.id),a="подтверждена"===e.status||"подтвержден"===e.status,r=e.startDate&&e.endDate;return t&&a&&r});function te(e){if(!e)return null;if(e.includes("-")){const[t,a,r]=e.split("-");return new Date(+t,+a-1,+r)}if(e.includes(".")){const[t,a,r]=e.split(".");return new Date(+r,+a-1,+t)}return null}const ae=[];return ee.forEach(e=>{const t=te(e.startDate),a=te(e.endDate);if(t&&a)for(let r=new Date(t.getFullYear(),t.getMonth(),t.getDate());r<=a;r.setDate(r.getDate()+1))ae.push(new Date(r.getFullYear(),r.getMonth(),r.getDate()))}),e.jsxs(e.Fragment,{children:[e.jsx(v,{open:a,onOpenChange:R?void 0:r,children:e.jsxs(b,{className:o?"fixed inset-0 w-full max-w-[400px] sm:max-w-[98vw] min-w-0 min-h-[100dvh] h-[100dvh] top-0 left-0 z-[3000] bg-background overflow-y-auto rounded-none p-0 pt-4 pb-[env(safe-area-inset-bottom,12px)] px-4 sm:px-2 box-border":"max-w-4xl max-h-[90vh] overflow-y-auto z-[3000] !top-1/2 !left-1/2 !translate-x-[-50%] !translate-y-[-50%] sm:max-w-lg md:max-w-2xl p-6 md:px-8 box-border",style:o?{zIndex:3e3,maxWidth:"100vw",minWidth:0}:{zIndex:3e3},children:[e.jsx("button",{onClick:R?void 0:r,className:"absolute top-3 right-3 z-[3001] text-3xl text-[#ffffff] hover:text-[#686868] transition md:top-4 md:right-4 bg-black/20 rounded-full p-1 "+(R?"opacity-50 cursor-not-allowed":""),"aria-label":n("reservation.cancel"),disabled:R,children:e.jsx(M,{size:24})}),e.jsxs(N,{children:[e.jsx(j,{className:"text-2xl font-bold",children:n("reservation.title")}),e.jsx(y,{className:"sr-only",children:n("reservation.dialogDescription","Форма бронирования автомобиля. Заполните все поля и отправьте заявку.")})]}),e.jsxs("div",{className:"w-full pb-4",children:[0===m&&e.jsx(T,{car:s,formData:c,setFormData:d,wizardData:g,setWizardData:B,currentStep:m,stepIndicator:H,disabledDays:ae,goNext:K,goBack:G,i18n:l}),1===m&&e.jsx($,{car:s,formData:c,wizardData:g,setWizardData:B,currentStep:m,stepIndicator:H,calculateDays:Y,totalPrice:V,discount:J,finalRentalCost:Z,goNext:K,goBack:G,i18n:l}),2===m&&e.jsx(F,{car:s,formData:c,setFormData:d,uploadedPhotos:u,setUploadedPhotos:h,privacyAccepted:x,setPrivacyAccepted:f,selectedCountryCode:z,setSelectedCountryCode:A,currentStep:m,stepIndicator:H,finalRentalCost:Z,isSubmitting:R,handleSubmit:async e=>{if(e.preventDefault(),R)return;L(!0);const t=e.target,a=new globalThis.FormData(t);try{await k({name:c.firstName+" "+c.lastName,phone:c.phone,email:c.email,car:[s.id],startDate:c.pickupDate,endDate:c.returnDate,comment:c.message,pickupTime:c.pickupTime,idnp:c.idnp,pickupType:c.pickupType,pickupAddress:c.pickupAddress,unlimitedMileage:c.unlimitedMileage,goldCard:c.goldCard,clubCard:c.clubCard,paymentMethod:c.paymentMethod,paymentOther:c.paymentOther,idPhotoFront:a.get("idPhotoFront"),idPhotoBack:a.get("idPhotoBack"),totalCost:Z,discountAmount:J,unlimitedMileageCost:g.unlimitedMileage?20*Y():0,deliveryCost:"address"===g.pickupType||"airport"===g.pickupType?20:0}),E(!0),L(!1)}catch(r){i({title:n("reservation.errorTitle"),description:n("reservation.errorDesc"),variant:"destructive"}),L(!1)}},goBack:G})]})]})}),e.jsx(O,{isOpen:P,onClose:()=>{E(!1),I(),r()},car:s})]})};if("undefined"!=typeof document){if(!document.getElementById("calendar-styles")){const e=document.createElement("style");e.id="calendar-styles",e.textContent='\n  .calendar-day-disabled-strike::after {\n    content: "";\n    position: absolute;\n    left: 15%;\n    top: 50%;\n    width: 70%;\n    height: 2px;\n    background: linear-gradient(90deg, #ff3333 60%, transparent 100%);\n    transform: rotate(-20deg);\n    pointer-events: none;\n    z-index: 2;\n  }\n  .calendar-day-disabled-strike::before {\n    content: "-";\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    transform: translate(-50%, -50%) scale(1.5);\n    color: #ff3333;\n    font-size: 1.2em;\n    font-weight: bold;\n    pointer-events: none;\n    z-index: 3;\n  }\n',document.head.appendChild(e)}}export{E as CarReservationModal,E as default};
