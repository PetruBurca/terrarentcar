# üöÄ –°–∏—Å—Ç–µ–º–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è Terra Rent Car

## üìä –û–±–∑–æ—Ä

–ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –∏ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å—é –¥–∞–Ω–Ω—ã—Ö.

## ‚ö° –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç**

- –í—Å–µ –∫—ç—à–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç –ø–æ—Å–ª–µ –ø–æ—Å–µ—â–µ–Ω–∏—è
- –í–∫–ª—é—á–∞–µ—Ç React Query, localStorage –∏ Service Worker –∫—ç—à–∏

### 2. **–°–±—Ä–æ—Å –ø—Ä–∏ –¥–≤–æ–π–Ω–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏**

- –î–≤–æ–π–Ω–æ–µ –Ω–∞–∂–∞—Ç–∏–µ F5 –∏–ª–∏ Ctrl+R –æ—á–∏—â–∞–µ—Ç –≤—Å–µ –∫—ç—à–∏
- –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

### 3. **–£–º–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—ç—à–µ–º**

- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–æ—Å–µ—â–µ–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
- –°–µ–ª–µ–∫—Ç–∏–≤–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∫—ç—à–∞

## üîß –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

### CacheManager

```typescript
<CacheManager
  autoClearTime={5 * 60 * 1000} // 5 –º–∏–Ω—É—Ç
  enableDoubleRefresh={true}
  showDebugInfo={process.env.NODE_ENV === "development"}
/>
```

### useCacheManager Hook

```typescript
const {
  clearAllCache, // –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –∫—ç—à–∏
  clearQueryCache, // –û—á–∏—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ React Query
  clearLocalStorage, // –û—á–∏—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ localStorage
  getTimeSinceLastVisit, // –í—Ä–µ–º—è —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–æ—Å–µ—â–µ–Ω–∏—è
  shouldClearCacheByTime, // –ù—É–∂–Ω–æ –ª–∏ –æ—á–∏—Å—Ç–∏—Ç—å –ø–æ –≤—Ä–µ–º–µ–Ω–∏
} = useCacheManager({
  autoClearTime: 5 * 60 * 1000,
  enableDoubleRefresh: true,
});
```

## üìà –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

### React Query

```typescript
{
  staleTime: 1000 * 60 * 3, // 3 –º–∏–Ω—É—Ç—ã - –¥–∞–Ω–Ω—ã–µ —Å—á–∏—Ç–∞—é—Ç—Å—è —Å–≤–µ–∂–∏–º–∏
  gcTime: 1000 * 60 * 5,    // 5 –º–∏–Ω—É—Ç - —É–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –∫—ç—à–∞
  refetchOnWindowFocus: false,
  refetchOnReconnect: true,
}
```

### Service Worker

```typescript
const CACHE_LIFETIME = 5 * 60 * 1000; // 5 –º–∏–Ω—É—Ç
const CACHE_NAME = "terra-rent-car-v2";
```

### LocalStorage

–û—á–∏—â–∞–µ–º—ã–µ –∫–ª—é—á–∏:

- `reservation-form`
- `search-dates`
- `reservation-step`
- `uploaded-photos`
- `privacy-accepted`
- `wizard-data`
- `selected-country-code`
- `active-image-index`
- `selected-car-id`

## üõ†Ô∏è –û—Ç–ª–∞–¥–∫–∞ (—Ç–æ–ª—å–∫–æ –≤ development)

–í —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
window.cacheManager.clearAll(); // –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –∫—ç—à–∏
window.cacheManager.clearQuery(); // –û—á–∏—Å—Ç–∏—Ç—å React Query
window.cacheManager.clearStorage(); // –û—á–∏—Å—Ç–∏—Ç—å localStorage
window.cacheManager.getTimeSinceLastVisit(); // –í—Ä–µ–º—è —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–æ—Å–µ—â–µ–Ω–∏—è
```

## üìä –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –≤–µ–¥–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏:

```
üßπ –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –∫—ç—à–µ–π...
‚úÖ React Query –∫—ç—à –æ—á–∏—â–µ–Ω
‚úÖ LocalStorage –æ—á–∏—â–µ–Ω
‚úÖ –ö—ç—à–∏ –æ—á–∏—â–µ–Ω—ã
üïê –ü—Ä–æ—à–ª–æ 7 –º–∏–Ω—É—Ç —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–æ—Å–µ—â–µ–Ω–∏—è, –æ—á–∏—â–∞–µ–º –∫—ç—à
```

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞** - –Ω–µ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –æ—á–∏—â–∞—Ç—å –∫—ç—à
2. **–ë—ã—Å—Ç—Ä—ã–π —Å–±—Ä–æ—Å** - –¥–≤–æ–π–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏
3. **–£–º–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** - —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –∫—ç—à–∞ –æ—á–∏—â–∞—é—Ç—Å—è –ø–æ-—Ä–∞–∑–Ω–æ–º—É
4. **–û—Ç–ª–∞–¥–∫–∞** - —É–¥–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
5. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏

## üîÑ –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –∫—ç—à–∞

1. **–ü–æ—Å–µ—â–µ–Ω–∏–µ —Å–∞–π—Ç–∞** ‚Üí –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–∞–π–º–µ—Ä–∞ –Ω–∞ 5 –º–∏–Ω—É—Ç
2. **5 –º–∏–Ω—É—Ç –ø—Ä–æ—à–ª–æ** ‚Üí –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –∫—ç—à–µ–π
3. **–î–≤–æ–π–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** ‚Üí –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –∫—ç—à–µ–π
4. **–ù–æ–≤–æ–µ –ø–æ—Å–µ—â–µ–Ω–∏–µ** ‚Üí –°–±—Ä–æ—Å —Ç–∞–π–º–µ—Ä–∞, –Ω–∞—á–∞–ª–æ –Ω–æ–≤–æ–≥–æ —Ü–∏–∫–ª–∞

## üö® –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

- –ö—ç—à –æ—á–∏—â–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø—Ä–æ—à–ª–æ –±–æ–ª—å—à–µ 5 –º–∏–Ω—É—Ç –ò –º–µ–Ω—å—à–µ 24 —á–∞—Å–æ–≤
- Service Worker –∫—ç—à –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –≤–µ—Ä—Å–∏–∏
- –í production —Ä–µ–∂–∏–º–µ –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã
- LocalStorage –æ—á–∏—â–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–ª—é—á–µ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ

```typescript
import { useCacheManager } from "@/hooks/use-cache-manager";

const MyComponent = () => {
  const { clearAllCache } = useCacheManager();

  const handleRefresh = () => {
    clearAllCache();
    window.location.reload();
  };

  return <button onClick={handleRefresh}>–û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>;
};
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–æ—Å–µ—â–µ–Ω–∏—è

```typescript
const { getTimeSinceLastVisit } = useCacheManager();
const timeSinceLastVisit = getTimeSinceLastVisit();
console.log(`–ü—Ä–æ—à–ª–æ ${Math.round(timeSinceLastVisit / 1000 / 60)} –º–∏–Ω—É—Ç`);
```
