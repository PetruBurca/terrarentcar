import{j as e}from"./ui-CnsppzKU.js";import{r as t,R as a}from"./vendor-CeUvtKp8.js";import{l as r,t as s,C as n,e as l,S as i,R as o,I as c,B as d,f as m,L as u,g as p,h,i as x,j as g,k as f,D as v,m as b,n as j,o as w,u as y,p as N,q as k,T as D,r as C,s as M}from"./index-DwAC_qg0.js";import{u as B}from"./query-Bv3DiFNv.js";import{u as S}from"./i18n-DOLuQ8P5.js";import{X as T}from"./utils-BgsNmh7z.js";function z({value:a,onChange:r,onClose:s}){const{t:n}=S(),[l,i]=t.useState(Number(a.split(":")[0])),[o,c]=t.useState(Number(a.split(":")[1])),d=Array.from({length:24},(e,t)=>t),m=Array.from({length:60},(e,t)=>t),u=t.useRef(null),p=t.useRef(null),[h,x]=t.useState(120),g=t.useRef(!1),f=t.useRef(!1),[v,b]=t.useState(0),[j,w]=t.useState(0);t.useEffect(()=>{if(u.current){const e=40,t=u.current.offsetHeight;x(t/2-e/2)}},[]),t.useEffect(()=>{if(!g.current&&u.current){const e=40*l;u.current.scrollTop=e,b(e),g.current=!0}if(!f.current&&p.current){const e=40*o;p.current.scrollTop=e,w(e),f.current=!0}},[]);const y=(e,t)=>{if(e.current){const a=40;e.current.scrollTo({top:t*a,behavior:"smooth"})}},N=e=>[...e,...e,...e],k=N(d),D=N(m),C=(e,t)=>{const a=Math.round(e/40),r=Math.abs(t-a);return 0===r?{color:"#ffffff",fontWeight:600,fontSize:"1.1em",transform:"scale(1.05)",opacity:1}:1===r?{color:"#d1d5db",fontWeight:500,fontSize:"1em",transform:"scale(1)",opacity:.8}:2===r?{color:"#9ca3af",fontWeight:400,fontSize:"0.95em",transform:"scale(0.95)",opacity:.4}:{color:"#6b7280",fontWeight:300,fontSize:"0.9em",transform:"scale(0.9)",opacity:.2}};return e.jsxs(e.Fragment,{children:[e.jsx("style",{children:"\n        .time-picker-scrollbar {\n          scrollbar-width: none;\n          -ms-overflow-style: none;\n          overflow-x: hidden;\n        }\n        .time-picker-scrollbar::-webkit-scrollbar {\n          display: none;\n        }\n        .time-picker-item {\n          transition: all 0.3s ease-out;\n          position: relative;\n          cursor: pointer;\n        }\n        .time-picker-item:hover {\n          color: #ffffff !important;\n          opacity: 1 !important;\n        }\n        .center-line {\n          position: absolute;\n          left: 0;\n          right: 0;\n          top: 50%;\n          transform: translateY(-50%);\n          height: 40px;\n          background: rgba(185, 0, 3, 0.15);\n          border: 1px solid rgba(185, 0, 3, 0.3);\n          border-radius: 8px;\n          pointer-events: none;\n          z-index: 5;\n        }\n      "}),e.jsx("div",{className:"relative w-full max-w-xs mx-auto flex flex-col items-center bg-[#232325] rounded-2xl p-4 shadow-xl z-10",children:e.jsxs("div",{className:"flex gap-4 relative h-48 w-full justify-center overflow-hidden",children:[e.jsx("div",{className:"center-line"}),e.jsxs("div",{ref:u,className:"flex-1 h-full overflow-y-auto overflow-x-hidden snap-y snap-mandatory time-picker-scrollbar relative",style:{minWidth:60,maxWidth:60},onScroll:()=>{if(u.current){const e=u.current.scrollTop;b(e);const t=Math.round(e/40)%24;if(t!==l){i(t);const e=`${t.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`;r(e)}}},children:[e.jsx("div",{style:{height:h}}),k.map((t,a)=>{const r=C(v,a);return e.jsx("div",{className:"h-10 flex items-center justify-center text-lg snap-center time-picker-item",style:r,onClick:()=>((e,t)=>{i(e),y(u,t)})(t,a),children:t.toString().padStart(2,"0")},`hour-${a}`)}),e.jsx("div",{style:{height:h}})]}),e.jsxs("div",{ref:p,className:"flex-1 h-full overflow-y-auto overflow-x-hidden snap-y snap-mandatory time-picker-scrollbar relative",style:{minWidth:60,maxWidth:60},onScroll:()=>{if(p.current){const e=p.current.scrollTop;w(e);const t=Math.round(e/40)%60;if(t!==o){c(t);const e=`${l.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`;r(e)}}},children:[e.jsx("div",{style:{height:h}}),D.map((t,a)=>{const r=C(j,a);return e.jsx("div",{className:"h-10 flex items-center justify-center text-lg snap-center time-picker-item",style:r,onClick:()=>((e,t)=>{c(e),y(p,t)})(t,a),children:t.toString().padStart(2,"0")},`minute-${a}`)}),e.jsx("div",{style:{height:h}})]})]})})]})}const A=({items:a,title:r,colorCenter:s,colorSide:n,valueSuffix:l=""})=>{const[i,o]=t.useState(5);t.useEffect(()=>{const e=()=>{o(window.innerWidth<=640?3:5)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const[c,d]=t.useState(0),[m,u]=t.useState(0),[p,h]=t.useState(!1),[x,g]=t.useState({x:0,y:0}),[f,v]=t.useState({x:0,y:0}),[b,j]=t.useState(0),[w,y]=t.useState(null),[N,k]=t.useState(!1),D=t.useRef(null);t.useRef();const C=120;a.length;const M=()=>{if(p){if(h(!1),u(0),"horizontal"===w){const e=c+m,t=Math.round(e/C)*C;k(!0),d(t),setTimeout(()=>k(!1),250)}y(null)}};return e.jsxs("div",{className:"w-full max-w-full md:max-w-lg mx-auto relative",children:[e.jsx("h3",{className:"text-xl font-bold text-center mb-4 text-white",children:r}),e.jsx("button",{onClick:()=>{N||(k(!0),d(e=>e-C),setTimeout(()=>k(!1),250))},disabled:N,className:"absolute left-0 z-20 p-2 bg-black/40 rounded-full text-[#B90003] hover:bg-[#A00002] hover:scale-110 active:scale-95 transition-all duration-200 disabled:opacity-50 shadow-lg hover:shadow-[#B90003]/30",style:{top:"50%",transform:"translateY(-50%)",marginTop:"12px"},children:"←"}),e.jsx("button",{onClick:()=>{N||(k(!0),d(e=>e+C),setTimeout(()=>k(!1),250))},disabled:N,className:"absolute right-0 z-20 p-2 bg-black/40 rounded-full text-[#B90003] hover:bg-[#A00002] hover:scale-110 active:scale-95 transition-all duration-200 disabled:opacity-50 shadow-lg hover:shadow-[#B90003]/30",style:{top:"50%",transform:"translateY(-50%)",marginTop:"12px"},children:"→"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-28 h-16 pointer-events-none z-5",style:{background:"radial-gradient(ellipse, rgba(250, 204, 21, 0.02) 40%, transparent 70%)"}}),e.jsx("div",{ref:D,className:"relative h-24 overflow-hidden cursor-grab active:cursor-grabbing",onTouchStart:e=>{const t=e.touches[0];h(!0),g({x:t.clientX,y:t.clientY}),v({x:t.clientX,y:t.clientY}),u(0),j(Date.now()),y(null),k(!1)},onTouchMove:e=>{if(!p)return;const t=e.touches[0],a=t.clientX-x.x,r=t.clientY-x.y;null===w&&(Math.abs(a)>5||Math.abs(r)>5)&&(Math.abs(a)>Math.abs(r)?y("horizontal"):y("vertical")),"horizontal"===w&&(e.preventDefault(),e.stopPropagation(),v({x:t.clientX,y:t.clientY}),u(-a))},onTouchEnd:e=>{if(p){if(e.preventDefault(),e.stopPropagation(),h(!1),u(0),"horizontal"===w){const e=c+m,t=Math.round(e/C)*C;k(!0),d(t),setTimeout(()=>k(!1),250)}else{const e=Math.round(c/C)*C;k(!0),d(e),setTimeout(()=>k(!1),250)}y(null)}},onMouseDown:e=>{e.preventDefault(),h(!0),g({x:e.clientX,y:e.clientY}),v({x:e.clientX,y:e.clientY}),u(0),j(Date.now()),y("horizontal"),k(!1)},onMouseMove:e=>{if(!p||"horizontal"!==w)return;const t=e.clientX-x.x;v({x:e.clientX,y:e.clientY}),u(-t)},onMouseUp:M,onMouseLeave:()=>{p&&M()},style:{userSelect:"none",WebkitUserSelect:"none",touchAction:"pan-x",WebkitTouchCallout:"none",overscrollBehavior:"contain",overscrollBehaviorX:"none",overscrollBehaviorY:"auto",pointerEvents:"auto"},children:(()=>{const t=[],r=Math.round(c/C),s=c+m,n=i+4;for(let i=-n;i<=n;i++){const o=r+i,m=(o%a.length+a.length)%a.length,u=a[m],h=o*C-s;if(Math.abs(h)>C*(n+1))continue;const x=Math.abs(h)/144,g=Math.max(0,Math.min(1,1-x)),f=.85+.3*g,v=.5+.5*g,b=15+6*g,j=g>.6,w=g>.3&&!j,y=j?.9*g:w?.8:.7,D=j?`rgba(185, 0, 3, ${y})`:`rgba(63, 63, 70, ${y})`,M=j?"#fff":w?"#838383":"#fff";t.push(e.jsxs("div",{className:`absolute flex flex-col items-center justify-center rounded-lg px-2 py-2 cursor-pointer select-none will-change-transform ${j?"hover:scale-105 active:scale-95":w?"hover:scale-110 active:scale-100 hover:shadow-[#B90003]/30 hover:ring-1 hover:ring-[#B90003]/50":"hover:scale-105 active:scale-95"} ${p?"":N?"transition-all duration-250 ease-out":"transition-all duration-150 ease-out hover:shadow-lg"}`,title:w?`Выбрать ${u.label}: ${u.value}${l}`:"",style:{left:`calc(50% + ${h}px)`,transform:`translateX(-50%) scale(${f})`,transformOrigin:"center center",opacity:v,backgroundColor:D,color:M,width:"110px",height:"80px",zIndex:Math.round(10*g)+10,boxShadow:j?"0 4px 12px rgba(185, 0, 3, 0.25)":"none",border:"none",position:"absolute",top:"50%",marginTop:"-40px",pointerEvents:"auto",backfaceVisibility:"hidden",perspective:"1000px",cursor:j?"default":"pointer"},onClick:e=>{if(e.preventDefault(),e.stopPropagation(),N)return;k(!0);const t=Math.round(c/C);if(o!==t){d(o*C)}setTimeout(()=>k(!1),250)},children:[e.jsx("div",{className:"text-xs mb-1 opacity-70",children:u.label}),e.jsxs("div",{className:"font-bold text-center",style:{fontSize:`${b}px`,fontWeight:j?700:500},children:[u.value,l?` ${l}`:""]})]},`${m}-${o}`))}return t})()}),e.jsx("div",{className:"flex justify-center gap-1 mt-3",children:a.map((t,r)=>e.jsx("button",{onClick:()=>{if(N)return;k(!0);const e=Math.round(c/C),t=(e%a.length+a.length)%a.length;let s=e;const n=(r-t+a.length)%a.length,l=(t-r+a.length)%a.length;s=n<=l?e+n:e-l,d(s*C),setTimeout(()=>k(!1),250)},disabled:N,className:"h-2 w-2 rounded-full transition-all duration-300 cursor-pointer hover:scale-125 active:scale-110 disabled:cursor-default "+((Math.round(c/C)%a.length+a.length)%a.length===r?"bg-[#B90003] scale-125 shadow-md shadow-[#B90003]/50 ring-2 ring-[#B90003]/30":"bg-gray-600 scale-100 opacity-70 hover:opacity-100 hover:bg-gray-500")},r))})]})},F=({car:m,formData:u,setFormData:p,wizardData:h,setWizardData:x,currentStep:g,stepIndicator:f,disabledDays:v,goNext:b,goBack:j,i18n:w})=>{const{t:y}=S(),[N,k]=a.useState(0),[D,C]=a.useState(!1),M=t.useRef(null),[B,T]=a.useState(0),[F,P]=a.useState(0),[R,L]=a.useState(!1),[$,q]=a.useState(0),[I,W]=a.useState(0),U=Array.isArray(m.images)?m.images:[],Y=e=>{const t="touches"in e?e.touches[0].clientX:e.clientX;T(t),P(t),q(0),W(N),L(!0)},X=e=>{if(!R)return;const t="touches"in e?e.touches[0].clientX:e.clientX;P(t);q(t-B)},E=()=>{if(!R)return;const e=B-F,t=e<-50;e>50&&N<U.length-1&&k(N+1),t&&N>0&&k(N-1),T(0),P(0),q(0),L(!1)},H=m.description||"",V=e=>e?`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}`:"",O=h.pickupDate||u.pickupDate,_=h.returnDate||u.returnDate,K=(()=>{const e=O&&""!==O.trim(),t=_&&""!==_.trim();if(!e&&!t)return;const a=e&&v.some(e=>e.getFullYear()===new Date(O).getFullYear()&&e.getMonth()===new Date(O).getMonth()&&e.getDate()===new Date(O).getDate()),r=t&&v.some(e=>e.getFullYear()===new Date(_).getFullYear()&&e.getMonth()===new Date(_).getMonth()&&e.getDate()===new Date(_).getDate());return a||r?void 0:{from:e?new Date(O):void 0,to:t?new Date(_):void 0}})(),G=O?new Date(O):_?new Date(_):new Date;return e.jsxs("div",{className:"flex flex-col items-center gap-1 pb-4 overflow-x-hidden",children:[e.jsxs("div",{className:"w-full flex flex-col items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-center mb-2 text-white",children:m.name}),H&&e.jsx("p",{className:"text-sm text-gray-300 text-center mb-4 max-w-md px-4",children:H}),e.jsxs("div",{className:"relative w-full max-w-lg mx-auto h-[250px] sm:h-[300px] md:h-[400px] flex items-center justify-center overflow-hidden "+(m.images[N]&&m.images[N]!==r?"bg-black rounded-lg":"bg-gradient-to-br from-muted/50 to-muted/30 rounded-lg"),children:[e.jsx("img",{src:m.images[N]||r,alt:m.name,className:"transition-all duration-500 "+(m.images[N]&&m.images[N]!==r?"w-full h-full object-cover":"w-auto h-auto max-w-[250px] max-h-[200px] sm:max-w-[300px] sm:max-h-[250px] md:max-w-[400px] md:max-h-[320px] object-contain p-4 sm:p-6 md:p-8 rounded-lg"),style:{objectPosition:"center center",minWidth:"100%",minHeight:"100%"},loading:"eager"}),m.images&&m.images.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:()=>k(e=>e>0?e-1:U.length-1),className:"absolute left-2 sm:left-4 top-1/2 -translate-y-1/2 bg-black/80 backdrop-blur-sm text-white rounded-full p-2 sm:p-4 hover:bg-[#B90003] hover:text-white transition-all duration-300 hover:scale-110 shadow-lg border border-white/20","aria-label":"Prev",children:e.jsx("svg",{className:"w-4 h-4 sm:w-6 sm:h-6",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})})}),e.jsx("button",{type:"button",onClick:()=>k(e=>e<U.length-1?e+1:0),className:"absolute right-2 sm:right-4 top-1/2 -translate-y-1/2 bg-black/80 backdrop-blur-sm text-white rounded-full p-2 sm:p-4 hover:bg-[#B90003] hover:text-white transition-all duration-300 hover:scale-110 shadow-lg border border-white/20","aria-label":"Next",children:e.jsx("svg",{className:"w-4 h-4 sm:w-6 sm:h-6",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})})})]})]}),m.images&&m.images.length>1&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"relative w-full max-w-[320px] sm:max-w-[400px] mx-auto px-2 sm:px-4 md:px-8",children:[e.jsx("div",{ref:M,className:"relative overflow-hidden w-[240px] sm:w-[280px] mx-auto cursor-grab active:cursor-grabbing",onTouchStart:Y,onTouchMove:X,onTouchEnd:E,onMouseDown:Y,onMouseMove:X,onMouseUp:E,onMouseLeave:E,children:e.jsx("div",{className:"flex gap-2 transition-transform duration-300 ease-in-out "+(R?"transition-none":""),style:{transform:`translateX(${56*-Math.max(0,Math.min(N-2,m.images.length-5))+(R?.3*$:0)}px)`},children:m.images.map((t,a)=>e.jsx("div",{className:`w-10 h-10 sm:w-12 sm:h-12 rounded-lg overflow-hidden cursor-pointer transition-all duration-200 bg-black flex-shrink-0 ${N===a?"ring-2 ring-[#B90003] scale-110":"hover:ring-1 hover:ring-gray-500"} ${R?"opacity-80":""}`,onClick:()=>!R&&k(a),children:e.jsx("img",{src:t,alt:`thumb-${a}`,className:"w-full h-full object-contain",loading:"lazy"})},a))})}),m.images.length>1&&e.jsxs(e.Fragment,{children:[N>0&&e.jsx("button",{type:"button",onClick:()=>k(Math.max(0,N-1)),className:"absolute left-0 top-1/2 -translate-y-1/2 bg-[#B90003] text-white rounded-full p-1 sm:p-2 hover:bg-[#A00002] transition-all duration-300 shadow-lg border-2 border-white hover:scale-110 z-10 backdrop-blur-sm","aria-label":"Previous thumbnail",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})})}),N<m.images.length-1&&e.jsx("button",{type:"button",onClick:()=>k(Math.min(m.images.length-1,N+1)),className:"absolute right-0 top-1/2 -translate-y-1/2 bg-[#B90003] text-white rounded-full p-1 sm:p-2 hover:bg-[#A00002] transition-all duration-300 shadow-lg border-2 border-white hover:scale-110 z-10 backdrop-blur-sm","aria-label":"Next thumbnail",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})})})]})]}),m.images.length>5&&e.jsx("div",{className:"flex justify-center mt-2 gap-1",children:Array.from({length:Math.min(5,m.images.length)}).map((t,a)=>{let r=2;N<2?r=N:N>=m.images.length-2&&(r=4-(m.images.length-1-N));const s=a===r;return e.jsx("div",{className:"w-2 h-2 rounded-full transition-all duration-200 "+(s?"bg-[#B90003]":"bg-gray-500")},a)})})]})]}),e.jsx(A,{items:[{label:y("reservation.pricePerDay"),value:m.price},{label:y("reservation.price2to10"),value:m.price2to10},{label:y("reservation.price11to20"),value:m.price11to20},{label:y("reservation.price21to29"),value:m.price21to29},{label:y("reservation.price30plus"),value:m.price30plus}],title:y("reservation.priceTitle"),colorCenter:"bg-[#B90003] text-white",colorSide:"bg-gray-800 text-white opacity-60",valueSuffix:"€"}),e.jsx(A,{items:[{label:y("reservation.transmission"),value:s("transmission",m.transmission,y)},{label:y("reservation.fuel"),value:s("fuel",m.fuelType||"",y)},{label:y("reservation.rating"),value:m.rating},{label:y("reservation.passengers"),value:m.seats},{label:y("reservation.year"),value:m.year}],title:y("reservation.featuresTitle"),colorCenter:"bg-[#B90003] text-white",colorSide:"bg-gray-800 text-white opacity-60"}),e.jsxs("div",{className:"w-full max-w-md mx-auto",children:[e.jsx("h3",{className:"text-xl font-bold text-center mb-2",children:y("reservation.calendarTitle")}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(n,{mode:"range",selected:K,defaultMonth:G,onSelect:e=>{const t=e=>!!e&&v.some(t=>t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate());if(t(null==e?void 0:e.from)||t(null==e?void 0:e.to))return l({title:y("reservation.disabledRangeTitle","Нельзя выбрать эти даты"),description:y("reservation.disabledRangeDesc","В выбранном диапазоне есть занятые дни. Пожалуйста, выберите другой период."),variant:"destructive"}),p(e=>({...e,pickupDate:"",returnDate:""})),void x(e=>({...e,pickupDate:"",returnDate:""}));if((null==e?void 0:e.from)&&(null==e?void 0:e.to))if(e.to<e.from){const t=V(e.to),a=V(e.from);p(e=>({...e,pickupDate:t,returnDate:a})),x(e=>({...e,pickupDate:t,returnDate:a}))}else{const t=V(e.from),a=V(e.to);p(e=>({...e,pickupDate:t,returnDate:a})),x(e=>({...e,pickupDate:t,returnDate:a}))}else if(null==e?void 0:e.from){const t=V(e.from);p(e=>({...e,pickupDate:t,returnDate:""})),x(e=>({...e,pickupDate:t,returnDate:""}))}else p(e=>({...e,pickupDate:"",returnDate:""})),x(e=>({...e,pickupDate:"",returnDate:""}))},disabled:v,fromDate:new Date,className:"rounded-xl bg-zinc-900/80 border border-zinc-700 shadow-lg p-2 text-white",classNames:{day_selected:"bg-[#B90003] text-white hover:bg-[#A00002]",day_range_middle:"bg-[#B90003]/30 text-white",day_range_end:"bg-[#A00002] text-white",day_today:"border-[#B90003] border-2",nav_button:"hover:bg-[#B90003]/20"},modifiersClassNames:{disabled:"calendar-day-disabled-strike"}},`${O}-${_}`),e.jsxs("div",{className:"mt-4 w-full",children:[e.jsx("h3",{className:"text-xl font-bold text-center mb-2",children:y("reservation.pickupTime")}),e.jsx(z,{value:u.pickupTime,onChange:e=>{p(t=>({...t,pickupTime:e})),x(t=>({...t,pickupTime:e}))},onClose:()=>{}})]})]})]}),e.jsxs("div",{className:"w-full max-w-sm sm:max-w-md mx-auto mb-2 px-2 sm:px-0",children:[e.jsx("h3",{className:"text-xl font-bold text-center mb-2",children:y("reservation.extraServices")}),e.jsxs("div",{className:"flex items-center justify-between bg-gray-700 rounded-lg px-4 py-3 mb-2",children:[e.jsx("span",{children:y("reservation.unlimitedMileage")}),e.jsx(i,{checked:!!h.unlimitedMileage,onCheckedChange:e=>x(t=>({...t,unlimitedMileage:!!e}))})]}),h.unlimitedMileage&&e.jsx("div",{className:"bg-[#B90003]/10 border border-[#B90003]/20 rounded-lg px-4 py-2 mb-2",children:e.jsx("p",{className:"text-[#B90003] text-sm text-center",children:y("reservation.unlimitedMileageDesc")})})]}),e.jsxs("div",{className:"w-full max-w-sm sm:max-w-md mx-auto mb-2 px-2 sm:px-0",children:[e.jsx("h3",{className:"text-xl font-bold text-center mb-2",children:y("reservation.pickupType")}),e.jsxs(o,{value:h.pickupType||"office",onValueChange:e=>x(t=>({...t,pickupType:e})),className:"flex flex-col gap-2 bg-gray-700 rounded-lg px-4 py-3 mb-2",children:[e.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[e.jsx("span",{children:y("reservation.pickupOffice")}),e.jsx(i,{checked:"office"===h.pickupType,onCheckedChange:e=>x(t=>({...t,pickupType:e?"office":"airport"}))})]}),e.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[e.jsx("span",{children:y("reservation.pickupAirport")}),e.jsx(i,{checked:"airport"===h.pickupType,onCheckedChange:e=>x(t=>({...t,pickupType:e?"airport":"office"}))})]}),e.jsx("div",{className:"border-t border-[#B90003] my-2"}),e.jsxs("label",{className:"flex flex-col gap-1 cursor-pointer",children:[e.jsx("span",{className:"text-center",children:y("reservation.pickupAddress")}),e.jsx(c,{type:"text",className:"bg-gray-800 rounded px-2 py-1 text-white",placeholder:y("reservation.enterAddress"),value:"address"===h.pickupType&&h.pickupAddress||"",onFocus:()=>x(e=>({...e,pickupType:"address"})),onChange:e=>x(t=>({...t,pickupType:"address",pickupAddress:e.target.value}))})]})]})]}),e.jsx("div",{className:"w-full flex justify-center mb-1",children:e.jsxs("span",{className:"text-sm font-semibold text-[#B90003] bg-black/30 rounded px-3 py-1",children:[y("reservation.step")," ",f]})}),e.jsx(d,{className:"w-full max-w-sm sm:max-w-md mx-auto bg-[#B90003] hover:bg-[#A00002] text-white text-base sm:text-lg font-bold py-2 sm:py-3 rounded-xl",onClick:b,disabled:!u.pickupDate||!u.returnDate,children:y("reservation.next")}),e.jsx(d,{className:"w-full max-w-sm sm:max-w-md mx-auto mt-2 bg-black text-[#B90003] border-[#B90003] border-2 text-base sm:text-lg font-bold py-2 sm:py-3 rounded-xl",variant:"outline",onClick:j,children:y("reservation.back")})]})};function P(e,t,a){const r="string"==typeof e?new Date(e):e,s=function(e){switch(e){case"en":return"en-US";case"ro":return"ro-RO";default:return"ru-RU"}}(t);return r.toLocaleDateString(s,{day:"2-digit",month:"long",...a})}const R=({car:t,formData:a,wizardData:r,setWizardData:s,currentStep:n,stepIndicator:l,calculateDays:o,totalPrice:c,discount:m,finalRentalCost:u,goNext:p,goBack:h,i18n:x})=>{const{t:g}=S();return e.jsxs("div",{className:"w-full max-w-md sm:max-w-full mx-auto pb-4",children:[e.jsx("div",{className:"text-2xl font-bold mb-4 text-white text-center",children:g("reservation.confirmTitle")}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-lg font-bold text-[#B90003] mb-1",children:g("reservation.periodTitle")}),e.jsx("div",{className:"bg-zinc-900 rounded-xl px-4 py-3 flex flex-col gap-1 border border-[#B90003]",children:a.pickupDate&&a.returnDate?e.jsx("div",{className:"text-white text-base font-semibold text-center",children:(()=>{const t=(r=a.pickupDate,s=a.returnDate,n=x.language,{start:P(r,n,l),end:P(s,n,l)});var r,s,n,l;return e.jsxs(e.Fragment,{children:[t.start,e.jsx("span",{className:"mx-2 text-[#B90003] font-bold",children:"—"}),t.end,e.jsx("span",{className:"ml-2 text-[#fffffff2] font-bold",children:a.pickupTime})]})})()}):e.jsx("span",{className:"text-zinc-400",children:g("reservation.periodNotSelected")})})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-lg font-bold text-[#B90003] mb-1",children:g("reservation.geoTitle")}),e.jsx("div",{className:"bg-zinc-900 rounded-xl px-4 py-3 text-base text-white border border-[#B90003]",children:"office"!==r.pickupType&&r.pickupType?"airport"===r.pickupType?g("reservation.airportAddress"):r.pickupAddress||g("reservation.enterAddress"):g("reservation.officeAddress")})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-lg font-bold mb-2 text-[#B90003]",children:g("reservation.rulesTitle")}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 bg-zinc-900 rounded-xl p-4 border border-[#B90003]",children:[e.jsxs("div",{className:"flex items-center gap-3 text-white",children:[e.jsx("img",{src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20width='800'%20height='800'%20fill='%23fff'%20viewBox='0%200%20313.725%20313.725'%3e%3cpath%20d='M235.469%2068.574c-4.679%205.328-6.204%2013.161-2.186%2019.269%203.079%204.679%208.408%207.246%2010.905%2012.398%203.438%207.099-.361%2016.396-8.444%2017.923-1.551.294-.145-1.525.14-2.021%201-1.741%201.881-3.605%202.271-5.587.76-3.855-1.115-8.062-3.232-11.215-.819-1.221-1.753-2.328-2.674-3.473-2.601-3.256-4.655-7.004-5.12-11.202-.447-4.053.669-8.114%202.933-11.486a21.3%2021.3%200%200%201%203.327-3.866c.47-.43.955-.848%201.47-1.223.355-.258%201.005.055.61.483M208.689%20113.292c1.737%203.672%203.355%207.585%203.49%2011.699.139%204.244-1.389%208.376-3.278%2012.109-.835%201.649-1.764%203.244-2.729%204.82-.538.879-.402%201.746.84%201.564%203.266-.475%206.501-2.09%209.134-4.025a23.54%2023.54%200%200%200%209.557-20.242c-.447-8.277-5.15-14.85-10.929-20.399-2.333-2.241-4.917-4.198-7.19-6.507-5.913-6.001-9.999-13.627-9.448-22.244.462-7.244%203.879-14.682%208.623-20.135.418-.467.045-1.237-.589-1.186-.277.022-.522.248-.731.405a36%2036%200%200%200-2.602%202.174%2040.2%2040.2%200%200%200-5.223%205.805c-3.303%204.471-5.636%209.686-6.455%2015.205-1.655%2011.151%203.277%2021.555%2010.257%2029.941%202.854%203.431%205.348%206.95%207.273%2011.016'/%3e%3cpath%20d='M156.862%200C70.368%200%200%2070.368%200%20156.862s70.368%20156.862%20156.862%20156.862%20156.862-70.368%20156.862-156.862S243.356%200%20156.862%200M290%20156.862c0%2032.443-11.671%2062.209-31.027%2085.333l-51.03-51.028h10.869a7.087%207.087%200%200%200%207.086-7.086v-23.615a7.087%207.087%200%200%200-7.086-7.086H196.19v26.034l-10.271-10.27V153.38h-15.764L71.526%2054.755c23.124-19.358%2052.891-31.03%2085.336-31.03C230.274%2023.725%20290%2083.45%20290%20156.862m-266.275%200c0-32.443%2011.671-62.209%2031.026-85.332l81.851%2081.85h-64.74a7.087%207.087%200%200%200-7.086%207.086v23.615a7.087%207.087%200%200%200%207.086%207.086h102.529l67.806%2067.804C219.073%20278.328%20189.308%20290%20156.862%20290%2083.45%20290%2023.725%20230.274%2023.725%20156.862'/%3e%3c/svg%3e",alt:"Не курить",className:"w-7 h-7"}),e.jsx("span",{children:g("reservation.ruleNoSmoke")})]}),e.jsxs("div",{className:"flex items-center gap-3 text-white",children:[e.jsx("img",{src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20width='800'%20height='800'%20fill='%23fff'%20stroke='%23fff'%20stroke-width='14.229'%20viewBox='-14.72%20-14.72%20520.11%20520.11'%3e%3cpath%20d='M245.333%200C110.059%200%200%20110.059%200%20245.333s110.059%20245.333%20245.333%20245.333%20245.333-110.059%20245.333-245.333S380.608%200%20245.333%200zm0%20469.333c-123.52%200-224-100.48-224-224%200-57.92%2022.293-110.613%2058.496-150.421L176.917%20192h-59.584c-5.888%200-10.667%204.779-10.667%2010.667s4.779%2010.667%2010.667%2010.667h32V352c0%205.888%204.779%2010.667%2010.667%2010.667s10.667-4.779%2010.667-10.667v-61.12c14.763%203.264%2039.488%207.787%2064%207.787%2021.184%200%2034.219-2.859%2042.091-6.827l21.909%2021.909V352c0%205.888%204.779%2010.667%2010.667%2010.667S320%20357.888%20320%20352v-16.917l75.755%2075.755c-39.808%2036.202-92.502%2058.495-150.422%2058.495zm165.504-73.578-93.952-93.952L94.933%2079.851c39.808-36.203%2092.501-58.496%20150.421-58.496%20123.499-.021%20223.979%20100.459%20223.979%20223.979%200%2057.919-22.293%20110.613-58.496%20150.421z'/%3e%3cpath%20d='m389.483%20172.181-48.149-28.885v-25.963c0-4.949-3.413-9.259-8.213-10.389-4.779-1.152-9.771%201.173-11.989%205.611l-30.869%2061.76c-5.227%2010.453-15.851%2017.173-27.733%2017.515a10.7%2010.7%200%200%200-9.6%206.72%2010.66%2010.66%200%200%200%202.368%2011.477l47.979%2048a10.67%2010.67%200%200%200%207.552%203.115c1.003%200%202.005-.128%202.987-.427a10.66%2010.66%200%200%200%207.424-7.957c1.173-5.333%202.816-9.28%205.163-12.416l18.859-25.131%2024.704%208.235c5.632%201.899%2011.627-1.152%2013.483-6.741l10.667-32a10.68%2010.68%200%200%200-4.633-12.524z'/%3e%3c/svg%3e",alt:"No pets",className:"w-7 h-7"}),e.jsx("span",{children:g("reservation.ruleNoPets")})]}),e.jsxs("div",{className:"flex items-center gap-3 text-white",children:[e.jsx("img",{src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20width='800'%20height='800'%20fill='%23fff'%20viewBox='0%200%20179.006%20179.006'%3e%3cpath%20d='M69.246%2097.982a5.9%205.9%200%200%201-5.901-5.907c0-3.27%205.901-13.61%205.901-13.61s5.901%2010.347%205.901%2013.61a5.9%205.9%200%200%201-5.901%205.907M64.8%2073.894h-6.766v36.076H46.297v5.549h6.826v5.102H0v-5.102h6.832V58.392h39.471v46.47h6.623V71.346l.03-2.56H67.3l3.962%205.09-4.028%203.139zm-27.25-6.659H15.574v16.403H37.55zm72.783%2011.617c.668.871%201.283%201.82%201.784%202.846a16.2%2016.2%200%200%201%201.122%203.168l36.464-21.32zm-17.089.114c-5.812%203.031-8.073%2010.209-5.036%2016.027s10.215%208.079%2016.021%205.048c5.824-3.037%208.085-10.203%205.054-16.033-3.031-5.818-10.209-8.074-16.039-5.042m11.618-63.028h-9.314v24.464h9.314zm-9.309%20147.131h9.314v-24.47h-9.314zm58.989-78.226v9.32h24.464v-9.32zm-23.611-37.436%203.294%203.294%2017.298-17.298-3.3-3.294zm0%2084.192%2017.298%2017.298%203.294-3.294-17.292-17.298zm-56.888%2020.747H86v-4.212H74.043v-5.197h12.894v-4.332H68.929v24.464h18.575v-4.35H74.043zm.567-111.944V30.055h10.716v-4.206H74.61v-5.567h12.304v-4.344H69.508v24.464h5.102'%20style='fill:%23fff'/%3e%3c/svg%3e",alt:"Fuel return",className:"w-7 h-7"}),e.jsx("span",{children:g("reservation.ruleFuel")})]}),e.jsxs("div",{className:"flex items-center gap-3 text-white",children:[e.jsx("img",{src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20width='800'%20height='800'%20fill='%23fff'%20viewBox='0%200%20100%20100'%3e%3cpath%20d='M50%2019C25.1%2019%204.9%2038.5%204%2063.4%204%2064.8%205.2%2066%206.6%2066c1.2%200%202.2-.8%202.6-2%204-14.2%2017-24%2031.8-24%206.9%200%2013.5%202.1%2019.1%206.1l-17.6%2017c-.5%200-1-.1-1.5-.1-5%200-9%204-9%209s4%209%209%209%209-4%209-9c0-.5-.1-1-.1-1.5l14-21.3c4.2%204.1%207.3%209.2%208.9%2014.8.3%201.2%201.4%202%202.6%202h18c.7%200%201.4-.3%201.9-.8s.8-1.2.7-1.9C95%2038.5%2074.8%2019%2050%2019m17.9%205.8L55.4%2041.1c-4.2-1.9-8.7-3-13.4-3.1V21.7c2.6-.5%205.2-.7%208-.7%206.4%200%2012.4%201.4%2017.9%203.8m-40%2015.8-4.8-10.5c4.9-3.8%2010.6-6.5%2016.9-7.9V38c-4.2.1-8.3%201-12.1%202.6M7.3%2063.5c-.1.3-.4.5-.7.5s-.6-.3-.6-.6c.2-6.1%201.7-11.9%204.1-17.1l4.9%203.3c-3.5%203.9-6.2%208.6-7.7%2013.9m9.1-15.4L11%2044.5c2.6-5%206.2-9.5%2010.5-13.1l4.5%2010c-3.5%201.6-6.8%203.9-9.6%206.7M41%2079c-3.9%200-7-3.1-7-7s3.1-7%207-7%207%203.1%207%207-3.1%207-7%207m3.7-15.2%2019.6-18.9-1.4%202.1c-.1.1-.1.2-.1.2L49.1%2068.1c-.9-1.9-2.5-3.5-4.4-4.3m20.2-16.3%205.9-9c.3-.4.2-1-.2-1.3s-1-.3-1.3%200l-7.7%207.4c-1.4-1-2.8-1.9-4.3-2.7l12.5-16.3c7.1%203.6%2013.1%209%2017.4%2015.6L67.7%2050l-.1.1c-.9-.9-1.8-1.7-2.7-2.6m28.9%2016.3c-.1.1-.3.2-.5.2h-18c-.3%200-.5-.2-.6-.5-1.2-4.3-3.2-8.2-5.9-11.7L88.2%2043c3.4%206%205.5%2012.9%205.8%2020.3-.1.3-.2.4-.2.5'/%3e%3c/svg%3e",alt:"Speed limit",className:"w-7 h-7"}),e.jsx("span",{children:g("reservation.ruleSpeed")})]}),e.jsxs("div",{className:"flex items-center gap-3 text-white",children:[e.jsx("img",{src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='800'%20height='800'%20fill='%23fff'%20viewBox='0%200%2024%2024'%3e%3cpath%20fill='%23fff'%20fill-rule='nonzero'%20d='M13.5%204a8.5%208.5%200%201%201-4.822%2015.5H1.752a.75.75%200%200%201-.102-1.493L1.752%2018l5.268.001a8.5%208.5%200%200%201-1.022-1.5l-2.25-.001a.75.75%200%200%201-.103-1.493L3.747%2015l1.627.001A8.5%208.5%200%200%201%205%2012.5c0-2.098.76-4.018%202.02-5.5H2.75a.75.75%200%200%201-.102-1.493L2.75%205.5h5.927A8.46%208.46%200%200%201%2013.5%204m0%201.5a7%207%200%201%200%200%2014%207%207%200%200%200%200-14m.003%201.502a5.501%205.501%200%201%201%200%2011.003%205.501%205.501%200%200%201%200-11.003m1.151%207.714c-.345.18-.738.282-1.154.282-.412%200-.8-.1-1.143-.276l-1.096%201.096c.64.433%201.411.687%202.242.687.834%200%201.608-.255%202.249-.691zm-5.152-2.213c0%20.836.256%201.613.695%202.255l1.093-1.092A2.5%202.5%200%200%201%2011%2012.5c0-.417.103-.81.283-1.155l-1.09-1.09a4%204%200%200%200-.691%202.25m7.316-2.242-1.095%201.095c.176.342.276.731.276%201.143%200%20.417-.102.81-.282%201.156l1.097%201.097c.436-.641.69-1.415.69-2.249%200-.83-.253-1.603-.686-2.242M13.5%2011.5a1%201%200%201%200%200%201.998%201%201%200%200%200%200-1.998m.003-2.998c-.834%200-1.608.255-2.25.691l1.09%201.09c.346-.18.74-.283%201.157-.283.421%200%20.818.104%201.166.288l1.092-1.091a4%204%200%200%200-2.255-.695'/%3e%3c/svg%3e",alt:"No aggressive driving",className:"w-7 h-7"}),e.jsx("span",{children:g("reservation.ruleNoAggressive")})]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-xl font-bold text-center mb-2 text-[#B90003]",children:g("reservation.clientCardTitle")}),e.jsxs("div",{className:"flex flex-col gap-2 bg-zinc-900 rounded-xl p-4 border border-[#B90003]",children:[e.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[e.jsx("span",{children:g("reservation.goldCard")}),e.jsx(i,{checked:r.goldCard,onCheckedChange:e=>s(t=>({...t,goldCard:e,clubCard:!e&&t.clubCard}))})]}),e.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[e.jsx("span",{children:g("reservation.clubCard")}),e.jsx(i,{checked:r.clubCard,onCheckedChange:e=>s(t=>({...t,clubCard:e,goldCard:!e&&t.goldCard}))})]})]})]}),e.jsxs("div",{className:"mb-0",children:[e.jsx("div",{className:"text-lg font-bold text-[#B90003] mb-2",children:g("reservation.costTitle")}),e.jsxs("div",{className:"bg-zinc-900 rounded-xl p-4 flex flex-col gap-2 text-white border border-[#B90003]",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:g("reservation.duration")})," ",e.jsxs("span",{children:[o()," ",g("reservation.days")]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:g("reservation.wash")})," ",e.jsx("span",{children:"20 €"})]}),r.unlimitedMileage&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:g("reservation.unlimitedMileageCost")})," ",e.jsxs("span",{children:[20*o()," €"]})]}),("address"===r.pickupType||"airport"===r.pickupType)&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:g("reservation.delivery")})," ",e.jsx("span",{children:"20 €"})]}),e.jsxs("div",{className:"flex justify-between font-bold text-lg",children:[e.jsx("span",{children:g("reservation.rentCost")})," ",e.jsxs("span",{children:[c-m," €"]})]}),e.jsx("div",{className:"border-t border-[#B90003]/30 my-2"}),e.jsxs("div",{className:"flex justify-between font-bold text-xl text-[#B90003]",children:[e.jsx("span",{children:g("reservation.totalAmount")})," ",e.jsxs("span",{children:[u," €"]})]})]})]}),e.jsx("div",{className:"w-full flex justify-center mb-2 mt-2",children:e.jsxs("span",{className:"text-sm font-semibold text-[#B90003] bg-black/30 rounded px-3 py-1",children:[g("reservation.step")," ",l]})}),e.jsx(d,{className:"w-full bg-[#B90003] hover:bg-[#A00002] text-white text-lg font-bold py-3 rounded-xl",onClick:p,children:g("reservation.next")}),e.jsx(d,{className:"w-full mt-2 bg-black text-[#B90003] border-[#B90003] border-2 text-lg font-bold py-3 rounded-xl",variant:"outline",onClick:h,children:g("reservation.back")})]})},L=({name:t,accept:a="image/*",required:r=!1,onChange:s,className:n,children:l})=>e.jsxs("div",{className:m("relative",n),children:[e.jsx("input",{type:"file",name:t,accept:a,required:r,onChange:s,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10"}),e.jsx("div",{className:"pointer-events-none",children:l})]}),$=e=>{if(!e)return"";const t=e.replace(/\D/g,"");return 0===t.length?"":1===t.length?t:t.length<=3?`0(${t.slice(1)}`:t.length<=9?`0(${t.slice(1,3)})${t.slice(3)}`:`0(${t.slice(1,3)})${t.slice(3,9)}`},q=({car:t,formData:a,setFormData:r,uploadedPhotos:s,setUploadedPhotos:n,passportFiles:l,setPassportFiles:m,passportUrls:v,setPassportUrls:b,privacyAccepted:j,setPrivacyAccepted:w,selectedCountryCode:y,setSelectedCountryCode:N,currentStep:k,stepIndicator:D,finalRentalCost:C,isSubmitting:M,handleSubmit:B,goBack:T})=>{var z;const{t:A}=S(),F=i,P=e=>{r(t=>({...t,[e.target.name]:e.target.value}))},R=[{code:"+373",name:"Moldova",flag:"🇲🇩"},{code:"+1",name:"USA/Canada",flag:"🇺🇸"},{code:"+7",name:"Russia",flag:"🇷🇺"},{code:"+40",name:"Romania",flag:"🇷🇴"},{code:"+380",name:"Ukraine",flag:"🇺🇦"},{code:"+49",name:"Germany",flag:"🇩🇪"},{code:"+33",name:"France",flag:"🇫🇷"},{code:"+39",name:"Italy",flag:"🇮🇹"},{code:"+34",name:"Spain",flag:"🇪🇸"},{code:"+44",name:"UK",flag:"🇬🇧"},{code:"+48",name:"Poland",flag:"🇵🇱"},{code:"+31",name:"Netherlands",flag:"🇳🇱"},{code:"+41",name:"Switzerland",flag:"🇨🇭"},{code:"+43",name:"Austria",flag:"🇦🇹"},{code:"+32",name:"Belgium",flag:"🇧🇪"},{code:"+420",name:"Czech Republic",flag:"🇨🇿"},{code:"+36",name:"Hungary",flag:"🇭🇺"},{code:"+90",name:"Turkey",flag:"🇹🇷"},{code:"+972",name:"Israel",flag:"🇮🇱"},{code:"+86",name:"China",flag:"🇨🇳"},{code:"+81",name:"Japan",flag:"🇯🇵"},{code:"+82",name:"South Korea",flag:"🇰🇷"},{code:"+91",name:"India",flag:"🇮🇳"},{code:"+61",name:"Australia",flag:"🇦🇺"},{code:"+64",name:"New Zealand",flag:"🇳🇿"}];return e.jsxs("form",{className:"w-full max-w-md sm:max-w-full mx-auto flex flex-col gap-1 pb-4",onSubmit:B,encType:"multipart/form-data",children:[e.jsx("div",{className:"text-2xl font-bold mb-4 text-white text-center",children:A("reservation.step3Title")}),e.jsxs("div",{className:"flex justify-between items-center border-b border-[#B90003] pb-2 mb-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-[#B90003]",children:A("reservation.total")}),e.jsx("div",{className:"text-sm text-gray-300",children:A("reservation.totalCost")})]}),e.jsxs("div",{className:"text-2xl font-bold text-white",children:[C," €"]})]}),e.jsxs("div",{className:"w-full max-w-md sm:max-w-full mx-auto mb-2",children:[e.jsx("h3",{className:"text-xl font-bold text-center mb-2",children:A("reservation.paymentMethod")}),e.jsxs(o,{value:a.paymentMethod||"cash",onValueChange:e=>{r(t=>({...t,paymentMethod:e}))},className:"flex flex-col gap-2 bg-gray-700 rounded-lg px-4 py-3 mb-2",children:[e.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[e.jsx("span",{children:A("reservation.cash")}),e.jsx(F,{checked:"cash"===a.paymentMethod,onCheckedChange:e=>{r(t=>({...t,paymentMethod:e?"cash":"card"}))}})]}),e.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[e.jsx("span",{children:A("reservation.card")}),e.jsx(F,{checked:"card"===a.paymentMethod,onCheckedChange:e=>{r(t=>({...t,paymentMethod:e?"card":"cash"}))}})]}),e.jsx("div",{className:"border-t border-[#B90003] my-2"}),e.jsxs("label",{className:"flex flex-col gap-1 cursor-pointer",children:[e.jsx("span",{className:"text-center",children:A("reservation.other")}),e.jsx(c,{type:"text",className:"bg-gray-800 rounded px-2 py-1 text-white",placeholder:A("reservation.other"),value:"other"===a.paymentMethod&&a.paymentMessage||"",onFocus:()=>r(e=>({...e,paymentMethod:"other"})),onChange:e=>r(t=>({...t,paymentMethod:"other",paymentMessage:e.target.value}))})]})]})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"firstName",className:"text-[#B90003] font-bold",children:A("reservation.firstName")}),e.jsx(c,{id:"firstName",name:"firstName",placeholder:A("reservation.firstName"),className:"bg-zinc-800 text-white border-none mt-1",value:a.firstName,onChange:P,required:!0})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"lastName",className:"text-[#B90003] font-bold",children:A("reservation.lastName")}),e.jsx(c,{id:"lastName",name:"lastName",placeholder:A("reservation.lastName"),className:"bg-zinc-800 text-white border-none mt-1",value:a.lastName,onChange:P,required:!0})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"email",className:"text-[#B90003] font-bold",children:A("reservation.email")}),e.jsx(c,{id:"email",name:"email",type:"email",placeholder:A("reservation.email"),className:"bg-zinc-800 text-white border-none mt-1",value:a.email,onChange:P,required:!0})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"idnp",className:"text-[#B90003] font-bold",children:A("reservation.idnp")}),e.jsx(c,{id:"idnp",name:"idnp",placeholder:"1234567890123",className:"bg-zinc-800 text-white border-none mt-1",value:a.idnp||"",onChange:e=>{const t=e.target.value.replace(/\D/g,"").slice(0,13);r(e=>({...e,idnp:t}))},maxLength:13,pattern:"[0-9]{13}",required:!0})]}),e.jsxs("div",{children:[e.jsx(u,{className:"text-[#B90003] font-bold",children:A("reservation.idPhotos")}),e.jsxs("div",{className:"flex gap-4 mt-2",children:[e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsxs(L,{name:"idPhotoFront",accept:"image/*",required:!0,onChange:e=>{if(e.target.files&&e.target.files[0]){const t=e.target.files[0];m(e=>({...e,front:t})),n(e=>({...e,front:!0}));const a=URL.createObjectURL(t);b(e=>({...e,front:a}))}},className:"flex flex-col items-center justify-center w-28 h-28 bg-zinc-900 border-2 border-dashed rounded-lg cursor-pointer hover:bg-zinc-800 transition group "+(s.front?"border-green-400":"border-[#ffffff]"),children:[s.front?e.jsxs("span",{className:"flex flex-col items-center justify-center z-0",children:[e.jsx("svg",{width:"36",height:"36",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",className:"text-green-400 mb-1",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),e.jsx("span",{className:"text-xs text-green-400",children:A("reservation.uploaded")})]}):e.jsxs("span",{className:"flex flex-col items-center justify-center z-0",children:[e.jsx("svg",{width:"36",height:"36",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",className:"text-gray-400 mb-1",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),e.jsx("span",{className:"text-xs text-gray-400",children:A("reservation.upload")})]}),v.front?e.jsx("img",{src:v.front,alt:"Preview загруженного фото",className:"absolute bottom-1 left-1 w-16 h-12 object-cover rounded shadow border border-gray-700 bg-black"}):e.jsx("img",{src:"/terrarentcar/assets/front-uO_TmE2q.png",alt:A("reservation.frontExample"),className:"absolute bottom-1 left-1 w-16 h-12 object-cover rounded shadow border border-gray-700 bg-black"})]}),e.jsx("span",{className:"text-xs text-gray-400 mt-1",children:A("reservation.frontExample")})]}),e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsxs(L,{name:"idPhotoBack",accept:"image/*",required:!0,onChange:e=>{if(e.target.files&&e.target.files[0]){const t=e.target.files[0];m(e=>({...e,back:t})),n(e=>({...e,back:!0}));const a=URL.createObjectURL(t);b(e=>({...e,back:a}))}},className:"flex flex-col items-center justify-center w-28 h-28 bg-zinc-900 border-2 border-dashed rounded-lg cursor-pointer hover:bg-zinc-800 transition group "+(s.back?"border-green-400":"border-[#ffffff]"),children:[s.back?e.jsxs("span",{className:"flex flex-col items-center justify-center z-0",children:[e.jsx("svg",{width:"36",height:"36",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",className:"text-green-400 mb-1",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),e.jsx("span",{className:"text-xs text-green-400",children:A("reservation.uploaded")})]}):e.jsxs("span",{className:"flex flex-col items-center justify-center z-0",children:[e.jsx("svg",{width:"36",height:"36",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",className:"text-gray-400 mb-1",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),e.jsx("span",{className:"text-xs text-gray-400",children:A("reservation.upload")})]}),v.back?e.jsx("img",{src:v.back,alt:"Preview загруженного фото",className:"absolute bottom-1 left-1 w-16 h-12 object-cover rounded shadow border border-gray-700 bg-black"}):e.jsx("img",{src:"/terrarentcar/assets/back-CVoMtcNb.png",alt:A("reservation.backExample"),className:"absolute bottom-1 left-1 w-16 h-12 object-cover rounded shadow border border-gray-700 bg-black"})]}),e.jsx("span",{className:"text-xs text-gray-400 mt-1",children:A("reservation.backExample")})]})]})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"phone",className:"text-[#B90003] font-bold",children:A("reservation.phone")}),e.jsxs("div",{className:"flex flex-col gap-2 mt-1",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2",children:[e.jsxs(p,{value:y,onValueChange:N,children:[e.jsx(h,{className:"w-full sm:w-40 bg-zinc-800 text-white border-none hover:bg-zinc-700",children:e.jsx(x,{children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:null==(z=R.find(e=>e.code===y))?void 0:z.flag}),e.jsx("span",{children:y})]})})}),e.jsx(g,{className:"bg-zinc-800 border-zinc-700 z-[3001] max-h-60",children:R.map(t=>e.jsx(f,{value:t.code,className:"text-white hover:bg-zinc-700 focus:bg-zinc-700 cursor-pointer",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:t.flag}),e.jsx("span",{children:t.code}),e.jsx("span",{className:"text-gray-400 text-sm",children:t.name})]})},t.code))})]}),e.jsx(c,{id:"phone",name:"phone",type:"tel",placeholder:"0(XX)XXXXXX",className:"bg-zinc-800 text-white border-none flex-1 w-full "+(9===a.phone.replace(/\D/g,"").length?"border-green-500 border-2":a.phone.replace(/\D/g,"").length>0?"border-yellow-500 border-2":""),value:$(a.phone.replace(new RegExp(`^\\${y}`),"")),onChange:e=>{const t=e.target.value.replace(/\D/g,"").slice(0,9);r(e=>({...e,phone:y+t}))},maxLength:13,required:!0})]}),e.jsx("div",{className:"text-xs text-gray-400",children:(()=>{const t=a.phone.replace(/\D/g,"").replace(y.replace(/\D/g,""),"").length;return 9===t?e.jsx("span",{className:"text-green-400",children:A("reservation.phoneValid")}):t>0?e.jsx("span",{className:"text-yellow-400",children:A("reservation.phoneIncomplete",{count:9-t})}):e.jsx("span",{className:"text-gray-400",children:A("reservation.phoneFormat")})})()})]})]}),e.jsxs("div",{className:"flex items-start gap-2 mt-2",children:[e.jsx(F,{id:"privacy",checked:j,onCheckedChange:e=>{w(!!e)},required:!0,className:"mt-1"}),e.jsxs("label",{htmlFor:"privacy",className:"text-white text-sm select-none",children:[A("reservation.privacyPolicy")," ",e.jsx("a",{href:"/privacy-policy.pdf",target:"_blank",rel:"noopener noreferrer",className:"text-[#B90003] underline ml-1",children:A("reservation.privacyPolicyLink")}),"."]}),!j&&e.jsx("div",{className:"text-red-400 text-xs mt-1",children:A("reservation.privacyRequired","Необходимо согласие для отправки заявки")})]}),e.jsx("div",{className:"w-full flex justify-center mb-2 mt-2",children:e.jsxs("span",{className:"text-sm font-semibold text-[#B90003] bg-black/30 rounded px-3 py-1",children:[A("reservation.step")," ",D]})}),e.jsx(d,{className:"w-full bg-[#B90003] hover:bg-[#A00002] disabled:bg-gray-400 disabled:cursor-not-allowed text-white text-lg font-bold py-3 rounded-xl",type:"submit",disabled:M,children:M?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-black border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:A("reservation.submitting")})]}):A("reservation.book")}),e.jsx(d,{className:"w-full mt-2 bg-black text-[#B90003] border-[#B90003] border-2 text-lg font-bold py-3 rounded-xl disabled:opacity-50 disabled:cursor-not-allowed",variant:"outline",onClick:T,disabled:M,children:A("reservation.back")})]})},I=({isOpen:t,onClose:a,car:r})=>{const{t:s}=S();return e.jsx(v,{open:t,onOpenChange:()=>{},children:e.jsxs(b,{className:"max-w-md mx-auto bg-gradient-to-br from-zinc-900 to-black border-2 border-[#B90003] shadow-2xl shadow-[#B90003]/20",style:{zIndex:4e3},children:[e.jsx(j,{className:"sr-only",children:s("reservation.successTitle","Заявка отправлена!")}),e.jsx(w,{className:"sr-only",children:s("reservation.successDescription","Ваша заявка на аренду автомобиля была успешно отправлена. Мы свяжемся с вами в ближайшее время.")}),e.jsxs("div",{className:"text-center p-6",children:[e.jsx("div",{className:"mx-auto mb-6 w-20 h-20 bg-gradient-to-br from-[#B90003] to-[#A00002] rounded-full flex items-center justify-center shadow-lg shadow-[#B90003]/30 animate-pulse",children:e.jsx("svg",{className:"w-10 h-10 text-black",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M5 13l4 4L19 7"})})}),e.jsxs("h2",{className:"text-3xl font-bold text-white mb-4",children:["🚗 ",s("reservation.successTitle","Заявка отправлена!")]}),e.jsxs("div",{className:"bg-zinc-800/50 rounded-xl p-4 mb-4 border border-[#B90003]/30",children:[e.jsx("p",{className:"text-white mb-2 text-base leading-relaxed",children:s("reservation.successMessage","Ваша заявка на аренду")}),e.jsx("div",{className:"text-2xl font-bold text-[#B90003] mb-2",children:r.name}),e.jsx("p",{className:"text-white text-base",children:s("reservation.successMessageEnd","успешно отправлена!")})]}),e.jsx("div",{className:"bg-[#B90003]/10 rounded-lg p-3 mb-6 border border-[#B90003]/20",children:e.jsxs("p",{className:"text-[#B90003] text-sm leading-relaxed",children:["📞"," ",s("reservation.contactSoon","Мы свяжемся с вами в ближайшее время для подтверждения бронирования.")]})}),e.jsxs(d,{onClick:()=>{console.log("🎉 Заявка успешно отправлена!"),a(),setTimeout(()=>{window.location.reload()},1e3)},className:"w-full bg-[#B90003] hover:bg-[#A00002] text-white font-bold text-lg py-4 rounded-xl shadow-lg shadow-[#B90003]/30 transform transition hover:scale-105 glow-effect",children:["✓ ",s("reservation.okButton","Понятно, спасибо!")]}),e.jsx("div",{className:"absolute top-4 left-4 w-3 h-3 bg-[#B90003]/30 rounded-full animate-ping"}),e.jsx("div",{className:"absolute top-6 right-6 w-2 h-2 bg-[#B90003]/50 rounded-full animate-pulse"}),e.jsx("div",{className:"absolute bottom-8 left-6 w-2 h-2 bg-[#B90003]/40 rounded-full animate-bounce"})]})]})})};const W=["main","summary","personal"],U=({isOpen:a,onClose:r,car:s})=>{const{t:n,i18n:i}=S(),o=y("(max-width: 767px)"),{formData:c,setFormData:d,currentStep:m,setCurrentStep:u,uploadedPhotos:p,setUploadedPhotos:h,passportFiles:x,setPassportFiles:g,passportUrls:f,setPassportUrls:z,privacyAccepted:A,setPrivacyAccepted:P,wizardData:L,setWizardData:$,selectedCountryCode:U,setSelectedCountryCode:Y}=function(){const[e,a]=t.useState({firstName:"",lastName:"",email:"",phone:"",pickupDate:"",returnDate:"",pickupTime:"10:00",returnTime:"",message:"",pickupType:"office",idnp:"",pickupAddress:"",unlimitedMileage:!1,goldCard:!1,clubCard:!1,paymentMethod:"cash",paymentOther:"",paymentMessage:""}),[r,s]=t.useState(0),[n,l]=t.useState({front:!1,back:!1}),[i,o]=t.useState({front:null,back:null}),[c,d]=t.useState({front:null,back:null}),[m,u]=t.useState(!1),[p,h]=t.useState("+373"),[x,g]=t.useState(0),[f,v]=t.useState({pickupDate:"",returnDate:"",pickupTime:"10:00",pickupType:"office",pickupAddress:"",unlimitedMileage:!1,goldCard:!1,clubCard:!1});return{formData:e,setFormData:a,currentStep:r,setCurrentStep:s,uploadedPhotos:n,setUploadedPhotos:l,passportFiles:i,setPassportFiles:o,passportUrls:c,setPassportUrls:d,privacyAccepted:m,setPrivacyAccepted:u,wizardData:f,setWizardData:v,selectedCountryCode:p,setSelectedCountryCode:h,activeImageIndex:x,setActiveImageIndex:g}}(s.id),[X,E]=t.useState(!1),[H,V]=t.useState(!1),O=`${m+1}/${W.length}`,_=()=>{if(c.pickupDate&&c.returnDate){const e=new Date(c.pickupDate),t=new Date(c.returnDate);if(isNaN(e.getTime())||isNaN(t.getTime()))return 1;if(t<=e)return 1;const a=Math.abs(t.getTime()-e.getTime());return Math.ceil(a/864e5)}return 1},K=_();var G;const J=((G=K)>=30?s.price30plus:G>=21?s.price21to29:G>=11?s.price11to20:G>=2?s.price2to10:s.price)*K,Z=(Q=J,L.goldCard?.25*Q:L.clubCard?.1*Q:0);var Q;const ee=J-Z+((L.unlimitedMileage?20*_():0)+("address"===L.pickupType||"airport"===L.pickupType?20:0))+20,te=()=>{(e=>{var t;switch(e){case 0:{if(!c.pickupDate)return l({title:n("validation.error","Ошибка валидации"),description:n("validation.pickupDateRequired","Выберите дату выдачи"),variant:"destructive"}),!1;if(!c.returnDate)return l({title:n("validation.error","Ошибка валидации"),description:n("validation.returnDateRequired","Выберите дату возврата"),variant:"destructive"}),!1;if(!c.pickupTime)return l({title:n("validation.error","Ошибка валидации"),description:n("validation.pickupTimeRequired","Выберите время выдачи"),variant:"destructive"}),!1;const e=new Date(c.pickupDate);return new Date(c.returnDate)<=e?(l({title:n("validation.error","Ошибка валидации"),description:n("validation.invalidDateRange","Дата возврата должна быть позже даты выдачи"),variant:"destructive"}),!1):!("address"===L.pickupType&&!(null==(t=L.pickupAddress)?void 0:t.trim())&&(l({title:n("validation.error","Ошибка валидации"),description:n("validation.addressRequired","Введите адрес доставки"),variant:"destructive"}),1))}case 1:default:return!0;case 2:return c.firstName.trim()?c.lastName.trim()?c.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(c.email)?c.phone.trim()?9!==c.phone.replace(/\D/g,"").replace(U.replace(/\D/g,""),"").length?(l({title:n("validation.error","Ошибка валидации"),description:n("validation.phoneInvalid","Номер телефона должен содержать ровно 9 цифр (0 + код оператора + номер)"),variant:"destructive"}),!1):c.idnp.trim()?13!==c.idnp.replace(/\D/g,"").length?(l({title:n("validation.error","Ошибка валидации"),description:n("validation.idnpInvalid","IDNP должен содержать ровно 13 цифр"),variant:"destructive"}),!1):p.front?p.back?!!A||(l({title:n("validation.error","Ошибка валидации"),description:n("validation.privacyRequired","Необходимо согласие на обработку персональных данных"),variant:"destructive"}),!1):(l({title:n("validation.error","Ошибка валидации"),description:n("validation.backPhotoRequired","Загрузите фото обратной стороны документа"),variant:"destructive"}),!1):(l({title:n("validation.error","Ошибка валидации"),description:n("validation.frontPhotoRequired","Загрузите фото лицевой стороны документа"),variant:"destructive"}),!1):(l({title:n("validation.error","Ошибка валидации"),description:n("validation.idnpRequired","Введите IDNP"),variant:"destructive"}),!1):(l({title:n("validation.error","Ошибка валидации"),description:n("validation.phoneRequired","Введите номер телефона"),variant:"destructive"}),!1):(l({title:n("validation.error","Ошибка валидации"),description:n("validation.emailInvalid","Введите корректный email"),variant:"destructive"}),!1):(l({title:n("validation.error","Ошибка валидации"),description:n("validation.emailRequired","Введите email"),variant:"destructive"}),!1):(l({title:n("validation.error","Ошибка валидации"),description:n("validation.lastNameRequired","Введите фамилию"),variant:"destructive"}),!1):(l({title:n("validation.error","Ошибка валидации"),description:n("validation.firstNameRequired","Введите имя"),variant:"destructive"}),!1)}})(m)&&(d(e=>({...e,pickupDate:L.pickupDate||"",returnDate:L.returnDate||"",pickupTime:L.pickupTime||"10:00",pickupType:L.pickupType||"office",pickupAddress:L.pickupAddress||"",unlimitedMileage:L.unlimitedMileage||!1,goldCard:L.goldCard||!1,clubCard:L.clubCard||!1})),u(e=>{const t=Math.min(e+1,W.length-1);return 1===t&&setTimeout(()=>{const e=document.querySelector('.DialogContent, .dialog-content, [role="dialog"]');e?e.scrollTo({top:0,behavior:"smooth"}):window.scrollTo({top:0,behavior:"smooth"})},50),2===t&&setTimeout(()=>{const e=document.querySelector('.DialogContent, .dialog-content, [role="dialog"]');e?e.scrollTo({top:0,behavior:"smooth"}):window.scrollTo({top:0,behavior:"smooth"})},50),t}))},ae=()=>u(e=>Math.max(e-1,0));t.useEffect(()=>{a||(u(0),E(!1),P(!1),h({front:!1,back:!1}),V(!1))},[a,u,P,h]);const{data:re=[]}=B({queryKey:["orders",i.language],queryFn:M,staleTime:0}),se=re.filter(e=>{const t=e.carId===s.id,a="confirmed"===e.status,r=e.rentFrom&&e.rentTo;return t&&a&&r});function ne(e){try{if(!e)return null;if(e.includes("-")){const[t,a,r]=e.split("-");return new Date(+t,+a-1,+r)}if(e.includes(".")){const[t,a,r]=e.split(".");return new Date(+r,+a-1,+t)}return null}catch(t){return console.error("❌ Ошибка в parseDate:",t,"для строки:",e),null}}const le=[];try{if(s.status&&"на обслуживании"===s.status.toLowerCase()){const e=new Date;for(let t=0;t<365;t++){const a=new Date(e);a.setDate(e.getDate()+t),le.push(new Date(a.getFullYear(),a.getMonth(),a.getDate()))}}else se.forEach(e=>{try{const t=e.rentFrom.toDate(),a=e.rentTo.toDate();if(!t||!a)return;for(let e=new Date(t.getFullYear(),t.getMonth(),t.getDate());e<=a;e.setDate(e.getDate()+1))le.push(new Date(e.getFullYear(),e.getMonth(),e.getDate()))}catch(t){console.error("❌ Ошибка при обработке заказа:",t,e)}})}catch(ie){console.error("❌ Ошибка при генерации disabledDays:",ie)}try{if((!s.status||"на обслуживании"!==s.status.toLowerCase())&&s.blockFromDate&&s.blockToDate){const e=ne(s.blockFromDate),t=ne(s.blockToDate);if(e&&t)for(let a=new Date(e.getFullYear(),e.getMonth(),e.getDate());a<=t;a.setDate(a.getDate()+1)){const e=new Date(a.getFullYear(),a.getMonth(),a.getDate());le.some(t=>t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate())||le.push(e)}}}catch(ie){console.error("❌ Ошибка при обработке блокировки администратора:",ie)}return e.jsxs(e.Fragment,{children:[e.jsx(v,{open:a,onOpenChange:X?void 0:r,children:e.jsxs(b,{className:o?"fixed inset-0 w-full max-w-[400px] sm:max-w-[98vw] min-w-0 min-h-[100dvh] h-[100dvh] top-0 left-0 z-[3000] bg-background overflow-y-auto rounded-none p-0 pt-4 pb-[env(safe-area-inset-bottom,12px)] px-4 sm:px-2 box-border":"max-w-4xl max-h-[90vh] overflow-y-auto z-[3000] !top-1/2 !left-1/2 !translate-x-[-50%] !translate-y-[-50%] sm:max-w-lg md:max-w-2xl p-6 md:px-8 box-border",style:o?{zIndex:3e3,maxWidth:"100vw",minWidth:0}:{zIndex:3e3},children:[e.jsx("button",{onClick:X?void 0:r,className:"absolute top-3 right-3 z-[3001] text-3xl text-[#ffffff] hover:text-[#686868] transition md:top-4 md:right-4 bg-black/20 rounded-full p-1 "+(X?"opacity-50 cursor-not-allowed":""),"aria-label":n("reservation.cancel"),disabled:X,children:e.jsx(T,{size:24})}),e.jsxs(N,{children:[e.jsx(j,{className:"text-2xl font-bold",children:n("reservation.title")}),e.jsx(w,{className:"sr-only",children:n("reservation.dialogDescription","Форма бронирования автомобиля. Заполните все поля и отправьте заявку.")})]}),e.jsxs("div",{className:"w-full pb-4",children:[0===m&&e.jsx(F,{car:s,formData:c,setFormData:d,wizardData:L,setWizardData:$,currentStep:m,stepIndicator:O,disabledDays:le,goNext:te,goBack:ae,i18n:i}),1===m&&e.jsx(R,{car:s,formData:c,wizardData:L,setWizardData:$,currentStep:m,stepIndicator:O,calculateDays:_,totalPrice:J,discount:Z,finalRentalCost:ee,goNext:te,goBack:ae,i18n:i}),2===m&&e.jsx(q,{car:s,formData:c,setFormData:d,uploadedPhotos:p,setUploadedPhotos:h,passportFiles:x,setPassportFiles:g,passportUrls:f,setPassportUrls:z,privacyAccepted:A,setPrivacyAccepted:P,selectedCountryCode:U,setSelectedCountryCode:Y,currentStep:m,stepIndicator:O,finalRentalCost:ee,isSubmitting:X,handleSubmit:async e=>{if(e.preventDefault(),X)return;if(!(c.firstName&&c.lastName&&c.email&&c.phone))return void l({title:"Неполная форма",description:"Пожалуйста, заполните все обязательные поля.",variant:"destructive"});if(c.phone.replace(/\D/g,"").length<9)return void l({title:"Неверный номер телефона",description:"Пожалуйста, введите корректный номер телефона.",variant:"destructive"});if(!c.idnp||13!==c.idnp.length)return void l({title:"Неверный IDNP",description:"IDNP должен содержать 13 цифр.",variant:"destructive"});if(!A)return void l({title:"Согласие обязательно",description:"Необходимо согласиться с политикой конфиденциальности.",variant:"destructive"});E(!0);const t=e.target;new globalThis.FormData(t);try{const e=await(async()=>{var e,t;console.log("🔄 Начинаем загрузку фото паспорта:",x);const a=[];x.front?(console.log("📤 Загружаем лицевую сторону:",x.front.name),a.push(C(x.front,"passport-front").then(e=>(console.log("✅ Лицевая сторона загружена:",e),{type:"front",url:e})).catch(e=>(console.error("❌ Ошибка загрузки лицевой стороны:",e),{type:"front",url:null})))):(console.log("⚠️ Лицевая сторона не выбрана"),a.push(Promise.resolve({type:"front",url:null}))),x.back?(console.log("📤 Загружаем обратную сторону:",x.back.name),a.push(C(x.back,"passport-back").then(e=>(console.log("✅ Обратная сторона загружена:",e),{type:"back",url:e})).catch(e=>(console.error("❌ Ошибка загрузки обратной стороны:",e),{type:"back",url:null})))):(console.log("⚠️ Обратная сторона не выбрана"),a.push(Promise.resolve({type:"back",url:null})));const r=await Promise.all(a);console.log("📋 Результаты загрузки:",r);const s=(null==(e=r.find(e=>"front"===e.type))?void 0:e.url)||"https://example.com/passport-front.jpg",n=(null==(t=r.find(e=>"back"===e.type))?void 0:t.url)||"https://example.com/passport-back.jpg";return console.log("🔗 Финальные URL:",{front:s,back:n}),{front:s,back:n}})();await k({carId:s.id,carName:s.name,carNumber:s.carNumber,customerName:c.firstName+" "+c.lastName,customerEmail:c.email,customerPhone:c.phone,customerPassport:c.idnp,rentFrom:D.fromDate(new Date(c.pickupDate)),rentTo:D.fromDate(new Date(c.returnDate)),totalDays:_(),totalPrice:ee,status:"pending",documents:{front:e.front,back:e.back},pickupTime:c.pickupTime,paymentMethod:c.paymentMethod,paymentMessage:c.paymentMessage||"",pickupType:c.pickupType,deliveryType:"address"===c.pickupType?"delivery":"pickup",deliveryAddress:c.pickupAddress,unlimitedMileage:c.unlimitedMileage,clubCard:c.clubCard,goldCard:c.goldCard,doubleKmAmount:c.doubleKmAmount||0,discountAmount:c.discountAmount||0,deliveryAmount:c.deliveryAmount||0,servedBy:c.servedBy||""}),V(!0),E(!1)}catch(a){if(console.error("Ошибка отправки заявки:",a),o){const e=a instanceof Error?a.message:String(a);e.includes("network")||e.includes("fetch")?l({title:"Проблема с сетью",description:"Проверьте подключение к интернету и попробуйте снова.",variant:"destructive"}):e.includes("storage")||e.includes("cache")?l({title:"Проблема с данными",description:"Попробуйте очистить кэш браузера и повторить.",variant:"destructive"}):l({title:"Ошибка отправки",description:"Попробуйте еще раз или свяжитесь с нами по телефону.",variant:"destructive"})}else l({title:"Ошибка отправки",description:"Произошла ошибка при отправке заявки. Попробуйте еще раз.",variant:"destructive"});E(!1)}},goBack:ae})]})]})}),e.jsx(I,{isOpen:H,onClose:()=>{V(!1),r()},car:s})]})};if("undefined"!=typeof document){if(!document.getElementById("calendar-styles")){const e=document.createElement("style");e.id="calendar-styles",e.textContent='\n  .calendar-day-disabled-strike::after {\n    content: "";\n    position: absolute;\n    left: 15%;\n    top: 50%;\n    width: 70%;\n    height: 2px;\n    background: linear-gradient(90deg, #ff3333 60%, transparent 100%);\n    transform: rotate(-20deg);\n    pointer-events: none;\n    z-index: 2;\n  }\n  .calendar-day-disabled-strike::before {\n    content: "-";\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    transform: translate(-50%, -50%) scale(1.5);\n    color: #ff3333;\n    font-size: 1.2em;\n    font-weight: bold;\n    pointer-events: none;\n    z-index: 3;\n  }\n',document.head.appendChild(e)}}export{U as CarReservationModal,U as default};
